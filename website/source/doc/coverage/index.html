<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Build</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.10.1/application.js' type='text/javascript'></script>    
    <link href='./assets/0.10.1/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.10.1/favicon_red.png" />
    <link rel="icon" type="image/png" href="./assets/0.10.1/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.10.1/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2017-08-06T13:12:04+02:00">2017-08-06T13:12:04+02:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="red">40.94%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         1.6
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>1</b> files in total.
    <b>1998</b> relevant lines. 
    <span class="green"><b>818</b> lines covered</span> and
    <span class="red"><b>1180</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#a6e1d922cafcf6728622d638adc8ccdd20c9d317" class="src_link" title="fizzy.rb">fizzy.rb</a></td>
        <td class="red strong">40.94 %</td>
        <td>5375</td>
        <td>1998</td>
        <td>818</td>
        <td>1180</td>
        <td>1.6</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.14.1 
        and simplecov-html v0.10.1<br/>
        using Cucumber Features
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="a6e1d922cafcf6728622d638adc8ccdd20c9d317">
  <div class="header">
    <h3>fizzy.rb</h3>
    <h4><span class="red">40.94 %</span> covered</h4>
    <div>
      <b>1998</b> relevant lines. 
      <span class="green"><b>818</b> lines covered</span> and
      <span class="red"><b>1180</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby">#!/usr/bin/env ruby</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># File header ─────────────────────────────────────────────────────────────────┐</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#                                                                              │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># File informations:                                                           │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"># - Name:    fizzy                                                             │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"># - Summary: The hassle free configuration manager                             │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"># - Authors:                                                                   │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#   - Alessandro Molari &lt;molari.alessandro@gmail.com&gt; (alem0lars)              │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"># - Special thanks:                                                            │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#   - Luca Molari &lt;molari.luca@gmail.com&gt; (lmolr)                              │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#   - Giacomo Mantani &lt;giacomo.mantani@gmail.com&gt; (jake)                       │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#                                                                              │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"># Project informations:                                                        │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#   - Homepage:        https://github.com/alem0lars/fizzy                      │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#   - Getting started: see README.md in the project root folder                │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">#                                                                              │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"># License: Apache v2.0 (see below)                                             │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">#                                                                              │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────────────────────────────────┤</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">#                                                                              │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"># Licensed to the Apache Software Foundation (ASF) under one more contributor  │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"># license agreements.  See the NOTICE file distributed with this work for      │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"># additional information regarding copyright ownership. The ASF licenses this  │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"># file to you under the Apache License, Version 2.0 (the &quot;License&quot;); you may   │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"># not use this file except in compliance with the License.                     │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"># You may obtain a copy of the License at                                      │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">#                                                                              │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">#   http://www.apache.org/licenses/LICENSE-2.0                                 │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">#                                                                              │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"># Unless required by applicable law or agreed to in writing, software          │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT    │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"># WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.             │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"># See the License for the specific language governing permissions and          │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"># limitations under the License.                                               │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">#                                                                              │</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────────────────────────────────┘</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"># ────────────────────────────────────────────────────────────────── Requires ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"># Core modules.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;English&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;fileutils&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;find&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;forwardable&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;json&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;net/http&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;optparse&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;optparse/date&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;optparse/time&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;ostruct&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;pathname&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;securerandom&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;singleton&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;shellwords&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;strscan&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;uri&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;yaml&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">begin</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  require &quot;readline&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">rescue LoadError</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">  puts(&quot;\e[33m☞ The library `readline` is not available. Falling back..&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"># Lazy-load `io/console` since it is gem-ified as of `2.3`.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;io/console&quot; if RUBY_VERSION &gt; &quot;1.9.2&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"># Load external dependencies.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">%w(thor).each do |gem_name|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">  begin</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">    require gem_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  rescue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    puts(&quot;\e[31m☠ The gem `#{gem_name}` is not installed. &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">        &quot;To install run: `gem install #{gem_name}`. Aborting.\e[0m&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">    exit(-1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"># Top-level namespace.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────── Ansi colors ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::ANSIColors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">  # Proxy method to `Fizzy::ANSIColors.colorize`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">  def colorize(*args, **kwargs)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="92">
          <span class="hits">2</span>
          
          <code class="ruby">    Fizzy::ANSIColors.colorize(*args, **kwargs)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">  class &lt;&lt; self</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">    def default_open_tag_regexp</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="97">
          <span class="hits">3</span>
          
          <code class="ruby">      /(\{(?&lt;color_spec&gt;[lrgybmcwLRGYBMCW]+)\{)/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">    def default_close_tag_regexp</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="101">
          <span class="hits">3</span>
          
          <code class="ruby">      /(\}\})/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">    def colorize(str, open_tag_regexp: nil, close_tag_regexp: nil)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="105">
          <span class="hits">3</span>
          
          <code class="ruby">      str = str.to_s</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="106">
          <span class="hits">3</span>
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="107">
          <span class="hits">3</span>
          
          <code class="ruby">        open_tag_regexp = default_open_tag_regexp if open_tag_regexp.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="108">
          <span class="hits">3</span>
          
          <code class="ruby">        close_tag_regexp = default_close_tag_regexp if close_tag_regexp.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="110">
          <span class="hits">3</span>
          
          <code class="ruby">        tree = TreeBuilder.new(open_tag_regexp, close_tag_regexp).build(str)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="112">
          <span class="hits">3</span>
          
          <code class="ruby">        colorized_str = str.dup</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="113">
          <span class="hits">3</span>
          
          <code class="ruby">        escapes_size = 0</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="114">
          <span class="hits">3</span>
          
          <code class="ruby">        tree.visit do |node|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="115">
          <span class="hits">6</span>
          
          <code class="ruby">          if node.is_a?(StartTagNode)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="116">
          <span class="hits">3</span>
          
          <code class="ruby">            color_escape = Fizzy::ANSIColors.spec_to_color(node.color_spec)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="117">
          <span class="hits">3</span>
          
          <code class="ruby">          elsif node.is_a?(EndTagNode)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="118">
          <span class="hits">3</span>
          
          <code class="ruby">            color_escape = Fizzy::ANSIColors.spec_to_color(node.parent.color_spec)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="120">
          <span class="hits">6</span>
          
          <code class="ruby">          colorized_str.insert(escapes_size + node.end_idx, color_escape)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="121">
          <span class="hits">6</span>
          
          <code class="ruby">          escapes_size += color_escape.length</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="123">
          <span class="hits">3</span>
          
          <code class="ruby">        colorized_str.gsub!(open_tag_regexp, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="124">
          <span class="hits">3</span>
          
          <code class="ruby">        colorized_str.gsub!(close_tag_regexp, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="125">
          <span class="hits">3</span>
          
          <code class="ruby">        colorized_str</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">      rescue StandardError =&gt; error</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">        # TODO find a way to use function `Fizzy::IO#error`.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">        puts(&quot;Invalid string to be colorized `#{str}`: #{error}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">        exit(-1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">    # Convert a color specification to an ansi color escape.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">    # * Upcase is for background colors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    # * Downcase is for foreground colors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="138">
          <span class="hits">1</span>
          
          <code class="ruby">    def spec_to_color(color_spec)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="139">
          <span class="hits">6</span>
          
          <code class="ruby">      names = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">        l: :black,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">        r: :red,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">        g: :green,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">        y: :yellow,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">        b: :blue,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">        m: :magenta,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">        c: :cyan,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">        w: :white</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="150">
          <span class="hits">6</span>
          
          <code class="ruby">      if color_spec.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">        &quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="153">
          <span class="hits">6</span>
          
          <code class="ruby">        color_spec = color_spec.to_s</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="154">
          <span class="hits">6</span>
          
          <code class="ruby">        if color_spec == &quot;CLEAR&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="155">
          <span class="hits">6</span>
          
          <code class="ruby">          Fizzy::ANSIColors.clear_colors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">          color_spec.chars.collect do |char|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="158">
          
          
          <code class="ruby">            color_name = names[char.downcase.to_sym]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">              if char == char.upcase # background color</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">                Fizzy::ANSIColors.bg_colors[color_name]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">              else # foreground color</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">                Fizzy::ANSIColors.fg_colors[color_name]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">          end.join</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="171">
          <span class="hits">1</span>
          
          <code class="ruby">  class TreeBuilder</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="172">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(open_tag_regexp, close_tag_regexp)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="173">
          <span class="hits">3</span>
          
          <code class="ruby">      @open_tag_regexp = open_tag_regexp</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="174">
          <span class="hits">3</span>
          
          <code class="ruby">      @close_tag_regexp = close_tag_regexp</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="177">
          <span class="hits">1</span>
          
          <code class="ruby">    def build(str)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="178">
          <span class="hits">3</span>
          
          <code class="ruby">      start_tag_nodes = str.to_enum(:scan, @open_tag_regexp).map do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="179">
          
          
          <code class="ruby">        m = Regexp.last_match</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="180">
          
          
          <code class="ruby">        StartTagNode.new(m.begin(0), m.end(0), m[0].length, m[:color_spec])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="183">
          <span class="hits">3</span>
          
          <code class="ruby">      end_tag_nodes = str.to_enum(:scan, @close_tag_regexp).map do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">        m = Regexp.last_match</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="185">
          
          
          <code class="ruby">        EndTagNode.new(m.begin(0), m.end(0), m[0].length)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="188">
          <span class="hits">3</span>
          
          <code class="ruby">      tag_nodes = (start_tag_nodes + end_tag_nodes).sort</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="190">
          <span class="hits">3</span>
          
          <code class="ruby">      root_node = StartTagNode.new(0, 0, 0, :CLEAR)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="192">
          <span class="hits">3</span>
          
          <code class="ruby">      parent_node = root_node</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="193">
          <span class="hits">3</span>
          
          <code class="ruby">      previous_node = root_node</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="194">
          <span class="hits">3</span>
          
          <code class="ruby">      tag_nodes.each do |current_node|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="195">
          
          
          <code class="ruby">        if previous_node.is_a?(StartTagNode) &amp;&amp; current_node.is_a?(StartTagNode)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="196">
          
          
          <code class="ruby">          parent_node = previous_node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="198">
          
          
          <code class="ruby">        if previous_node.is_a?(EndTagNode) &amp;&amp; current_node.is_a?(EndTagNode)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">          parent_node = parent_node.parent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="201">
          
          
          <code class="ruby">        current_node.parent = parent_node</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">        parent_node.children.push(current_node)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">        previous_node = current_node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">      # Add the end tag for the root node.</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="207">
          <span class="hits">3</span>
          
          <code class="ruby">      final_node = EndTagNode.new(str.length, str.length, 0)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="208">
          <span class="hits">3</span>
          
          <code class="ruby">      final_node.parent = root_node</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="209">
          <span class="hits">3</span>
          
          <code class="ruby">      root_node.children.push(final_node)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="211">
          <span class="hits">3</span>
          
          <code class="ruby">      return root_node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="215">
          <span class="hits">1</span>
          
          <code class="ruby">  class Node</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="216">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_accessor :parent, :children</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="217">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :start_idx, :end_idx, :size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="219">
          <span class="hits">1</span>
          
          <code class="ruby">    include Comparable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(start_idx, end_idx, size)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="222">
          <span class="hits">6</span>
          
          <code class="ruby">      @parent = nil</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="223">
          <span class="hits">6</span>
          
          <code class="ruby">      @children = []</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="224">
          <span class="hits">6</span>
          
          <code class="ruby">      @start_idx = start_idx</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="225">
          <span class="hits">6</span>
          
          <code class="ruby">      @end_idx = end_idx</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="226">
          <span class="hits">6</span>
          
          <code class="ruby">      @size = size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="229">
          <span class="hits">1</span>
          
          <code class="ruby">    def &lt;=&gt;(another)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="230">
          
          
          <code class="ruby">      self.start_idx &lt;=&gt; another.start_idx</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="233">
          <span class="hits">1</span>
          
          <code class="ruby">    def visit(&amp;block)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="234">
          <span class="hits">6</span>
          
          <code class="ruby">      yield(self)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="235">
          <span class="hits">9</span>
          
          <code class="ruby">      children.each {|c| c.visit(&amp;block)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="238">
          <span class="hits">1</span>
          
          <code class="ruby">    def to_pretty_str(indent_lvl=0, include_children: true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="239">
          
          
          <code class="ruby">      &quot;#{&quot;\t&quot; * indent_lvl}#{self.class.name}(#{to_fields_str(indent_lvl, include_children)})&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="242">
          <span class="hits">1</span>
          
          <code class="ruby">    def to_fields_str(indent_lvl, include_children)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="243">
          
          
          <code class="ruby">      indent_str = &quot;#{&quot;\t&quot; * indent_lvl}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="244">
          
          
          <code class="ruby">      if children.empty? || !include_children</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">        children_str = &quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="247">
          
          
          <code class="ruby">        children_str = &quot;children=&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="248">
          
          
          <code class="ruby">        children_str = &quot;\n#{indent_str}[\n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="249">
          
          
          <code class="ruby">        children_str += children.map do |c|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="250">
          
          
          <code class="ruby">          c.to_pretty_str(indent_lvl + 1, include_children: include_children)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">        end.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="252">
          
          
          <code class="ruby">        children_str += &quot;\n#{indent_str}]&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="254">
          
          
          <code class="ruby">      &quot;start_idx=`#{start_idx}` end_idx=`#{end_idx}` size=`#{size}`#{children_str}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="256">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :to_fields_str</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="259">
          <span class="hits">1</span>
          
          <code class="ruby">  class StartTagNode &lt; Node</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="260">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :color_spec</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="262">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(start_idx, end_idx, size, color_spec)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="263">
          <span class="hits">3</span>
          
          <code class="ruby">      super(start_idx, end_idx, size)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="264">
          <span class="hits">3</span>
          
          <code class="ruby">      @color_spec = color_spec</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="267">
          <span class="hits">1</span>
          
          <code class="ruby">    def to_fields_str(indent_lvl, include_children)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">      &quot;color_spec=`#{color_spec}` #{super}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="270">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :to_fields_str</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="273">
          <span class="hits">1</span>
          
          <code class="ruby">  class EndTagNode &lt; Node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">  # ─────────────────────────────────────────────────────── Colors definition ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="278">
          <span class="hits">1</span>
          
          <code class="ruby">  class &lt;&lt; self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">    # Definition of ANSI foreground colors.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="282">
          <span class="hits">1</span>
          
          <code class="ruby">    def fg_colors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">      {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">        black: &quot;\e[30m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">        red: &quot;\e[31m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">        green: &quot;\e[32m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">        yellow: &quot;\e[33m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby">        blue: &quot;\e[34m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">        magenta: &quot;\e[35m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">        cyan: &quot;\e[36m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby">        white: &quot;\e[37m&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="292">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby">    # Definition of ANSI background colors.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="297">
          <span class="hits">1</span>
          
          <code class="ruby">    def bg_colors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">      {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">        black: &quot;\e[40m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">        red: &quot;\e[41m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">        green: &quot;\e[42m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">        yellow: &quot;\e[43m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">        blue: &quot;\e[44m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">        magenta: &quot;\e[45m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby">        cyan: &quot;\e[46m&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby">        white: &quot;\e[47m&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="310">
          <span class="hits">1</span>
          
          <code class="ruby">    def clear_colors</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="311">
          <span class="hits">6</span>
          
          <code class="ruby">      &quot;\e[0m&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="318">
          
          
          <code class="ruby"># TEST</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby"># TODO move to the specs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="320">
          
          
          <code class="ruby"># ###################</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby"># input = &quot;{b{gogo{r{the quick {g{brown fox {y{jumps over}} the {m{lazy}} dog}} the {c{quick}} brown fox jumps}}}} over the {g{lazy}} dog&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby"># actual = Fizzy::ANSIColors.colorize(input)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby"># expected = &quot;\e[0m\e[34mgogo\e[31mthe quick \e[32mbrown fox \e[33mjumps over\e[32m the \e[35mlazy\e[32m dog\e[31m the \e[36mquick\e[31m brown fox jumps\e[34m\e[0m over the \e[32mlazy\e[0m dog\e[0m&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby"># puts actual == expected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby"># ###################</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby"># input = {Ml{ ? }}Do you want to commit them all?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby"># expected_tree =</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">#     Fizzy::ANSIColors::StartTagNode(color_spec=`CLEAR` start_idx=`0` end_idx=`0` size=`0`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby">#     [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">#             Fizzy::ANSIColors::StartTagNode(color_spec=`Ml` start_idx=`0` end_idx=`4` size=`4`)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby">#             Fizzy::ANSIColors::EndTagNode(start_idx=`7` end_idx=`9` size=`2`)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="333">
          
          
          <code class="ruby">#             Fizzy::ANSIColors::EndTagNode(start_idx=`41` end_idx=`41` size=`0`)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">#     ])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby"># ────────────────────────────────────────────────────────────── String ← Ext ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby"># Extensions for class `String`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="341">
          <span class="hits">1</span>
          
          <code class="ruby">class String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="342">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::ANSIColors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="344">
          
          
          <code class="ruby">  # ───────────────────────────────────────────────────────────────── Escapes ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="345">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="346">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">  # Escapes the underlying object so that it can be safely used in a Bourne</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby">  # shell commandline.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="349">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="350">
          <span class="hits">1</span>
          
          <code class="ruby">  def shell_escape</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="351">
          
          
          <code class="ruby">    Shellwords.shellescape(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="353">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby">  # ────────────────────────────────────────────────────────────── Formatting ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="356">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby">  # Turn the underlying string to a title.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="359">
          <span class="hits">1</span>
          
          <code class="ruby">  def titleize!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="360">
          
          
          <code class="ruby">    replace(split(/[_-]/).each(&amp;:capitalize!).join(&quot;&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby">  # Turn the underlying string to camel-case.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="366">
          <span class="hits">1</span>
          
          <code class="ruby">  def camelize!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="367">
          
          
          <code class="ruby">    titleize!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="368">
          
          
          <code class="ruby">    replace(self[0, 1].downcase + self[1..-1])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby">  # Turn a camelized string into lowercase, separated with underscores.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="374">
          <span class="hits">1</span>
          
          <code class="ruby">  def underscorize!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="375">
          
          
          <code class="ruby">    replace(tr(&quot;-&quot;, &quot;_&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="377">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="378">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby">  # Turn a camelized string into lowercase, separated with dashes.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="380">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="381">
          <span class="hits">1</span>
          
          <code class="ruby">  def dasherize!</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="382">
          <span class="hits">55</span>
          
          <code class="ruby">    replace(tr(&quot;_&quot;, &quot;-&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="384">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="385">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="386">
          
          
          <code class="ruby">  # Create a new string as a titleized version of the underlying string.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="387">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="388">
          <span class="hits">1</span>
          
          <code class="ruby">  def titleize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="389">
          
          
          <code class="ruby">    dup.tap(&amp;:titleize!)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="392">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby">  # Create a new string as a camelized version of the underlying string.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="395">
          <span class="hits">1</span>
          
          <code class="ruby">  def camelize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="396">
          
          
          <code class="ruby">    dup.tap(&amp;:camelize!)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="398">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="399">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="400">
          
          
          <code class="ruby">  # Create a new string as a underscorized version of the underlying string.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="401">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="402">
          <span class="hits">1</span>
          
          <code class="ruby">  def underscorize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="403">
          
          
          <code class="ruby">    dup.tap(&amp;:underscorize!)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="404">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby">  # Create a new string as a dasherized version of the underlying string.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="408">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="409">
          <span class="hits">1</span>
          
          <code class="ruby">  def dasherize</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="410">
          <span class="hits">55</span>
          
          <code class="ruby">    dup.tap(&amp;:dasherize!)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="411">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="412">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="413">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">  # Example environment variables contained inside the path.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="416">
          <span class="hits">1</span>
          
          <code class="ruby">  def expand_variables</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="417">
          <span class="hits">1</span>
          
          <code class="ruby">    vars_regexp = /\$([a-zA-Z_]+[a-zA-Z0-9_]*)|\$\{(.+)\}/</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="418">
          <span class="hits">1</span>
          
          <code class="ruby">    gsub(vars_regexp) { ENV[Regexp.last_match(1) || Regexp.last_match(2)] }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="419">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="420">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="421">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="422">
          
          
          <code class="ruby"># ────────────────────────────────────────────────────────────── Symbol ← Ext ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="423">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="424">
          <span class="hits">1</span>
          
          <code class="ruby">class Symbol</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="425">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="426">
          
          
          <code class="ruby">  # Escapes the underlying object so that it can be safely used in a Bourne</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="427">
          
          
          <code class="ruby">  # shell commandline.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="428">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="429">
          <span class="hits">1</span>
          
          <code class="ruby">  def shell_escape</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="430">
          
          
          <code class="ruby">    self.to_s.shell_escape.to_sym</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="431">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="432">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="433">
          
          
          <code class="ruby">  # Create a new symbol as a titleized version of the underlying symbol.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="434">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="435">
          <span class="hits">1</span>
          
          <code class="ruby">  def titleize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="436">
          
          
          <code class="ruby">    self.to_s.titleize.to_sym</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="437">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="439">
          
          
          <code class="ruby">  # Create a new symbol as a camelized version of the underlying symbol.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="440">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="441">
          <span class="hits">1</span>
          
          <code class="ruby">  def camelize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="442">
          
          
          <code class="ruby">    self.to_s.camelize.to_sym</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="443">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="444">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="445">
          
          
          <code class="ruby">  # Create a new symbol as a underscorized version of the underlying symbol.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="446">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="447">
          <span class="hits">1</span>
          
          <code class="ruby">  def underscorize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="448">
          
          
          <code class="ruby">    self.to_s.underscorize.to_sym</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="449">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="450">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="451">
          
          
          <code class="ruby">  # Create a new symbol as a dasherized version of the underlying symbol.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="452">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="453">
          <span class="hits">1</span>
          
          <code class="ruby">  def dasherize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="454">
          
          
          <code class="ruby">    self.to_s.dasherize.to_sym</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="455">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="456">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="457">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="458">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="459">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────────────── Hash ← Ext ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="460">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="461">
          <span class="hits">1</span>
          
          <code class="ruby">class Hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="462">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="463">
          
          
          <code class="ruby">  # Extract `n` sample key/value pairs from the underlying `Hash`.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="464">
          <span class="hits">1</span>
          
          <code class="ruby">  def sample(n=1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="465">
          
          
          <code class="ruby">    Hash[self.to_a.sample(n)]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="466">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="468">
          
          
          <code class="ruby">  # Define magic merge strategy:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="469">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="470">
          
          
          <code class="ruby">  # 1. Merge hashes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="471">
          
          
          <code class="ruby">  # 2. Concatenate arrays</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="473">
          <span class="hits">1</span>
          
          <code class="ruby">  def magic_merge_strategy</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="474">
          
          
          <code class="ruby">    proc do |key, v1, v2|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="475">
          
          
          <code class="ruby">      if Hash === v1 &amp;&amp; Hash === v2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="476">
          
          
          <code class="ruby">        v1.merge(v2, &amp;magic_merge_strategy)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="477">
          
          
          <code class="ruby">      elsif Array === v1 &amp;&amp; Array === v2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="478">
          
          
          <code class="ruby">        (SortedSet.new(v1) + SortedSet.new(v2)).to_a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="479">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="480">
          
          
          <code class="ruby">        v2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="481">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="482">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="483">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="484">
          <span class="hits">1</span>
          
          <code class="ruby">  private :magic_merge_strategy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="486">
          
          
          <code class="ruby">  # Perform recursive merge with some magic, replacing current hash.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="487">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="488">
          <span class="hits">1</span>
          
          <code class="ruby">  def magic_merge!(second)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="489">
          
          
          <code class="ruby">    self.merge!(second, &amp;magic_merge_strategy)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="491">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="492">
          
          
          <code class="ruby">  # Perform recursive merge with some magic, creating a new hash.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="493">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="494">
          <span class="hits">1</span>
          
          <code class="ruby">  def magic_merge(second)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="495">
          
          
          <code class="ruby">    self.merge(second, &amp;magic_merge_strategy)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="496">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="497">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="498">
          
          
          <code class="ruby">  # Define merge strategy.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="499">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="500">
          
          
          <code class="ruby">  # 1. Merge hashes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="501">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="502">
          <span class="hits">1</span>
          
          <code class="ruby">  def deep_merge_strategy</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="503">
          <span class="hits">23</span>
          
          <code class="ruby">    proc do |key, v1, v2|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="504">
          <span class="hits">4</span>
          
          <code class="ruby">      if Hash === v1 &amp;&amp; Hash === v2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="505">
          
          
          <code class="ruby">        v1.merge(v2, &amp;deep_merge_strategy)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="506">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="507">
          <span class="hits">4</span>
          
          <code class="ruby">        v2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="508">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="509">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="510">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="511">
          <span class="hits">1</span>
          
          <code class="ruby">  private :deep_merge_strategy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="512">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="513">
          
          
          <code class="ruby">  # Perform recursive merge, replacing current hash.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="514">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="515">
          <span class="hits">1</span>
          
          <code class="ruby">  def deep_merge!(second)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="516">
          <span class="hits">4</span>
          
          <code class="ruby">    self.merge!(second, &amp;deep_merge_strategy)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="517">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="518">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="519">
          
          
          <code class="ruby">  # Perform recursive merge, creating a new hash.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="520">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="521">
          <span class="hits">1</span>
          
          <code class="ruby">  def deep_merge(second)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="522">
          <span class="hits">19</span>
          
          <code class="ruby">    self.merge(second, &amp;deep_merge_strategy)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="523">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="524">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="525">
          <span class="hits">1</span>
          
          <code class="ruby">  def fqkeys(prefix=&quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="526">
          
          
          <code class="ruby">    self.inject([]) do |acc, (k, v)|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="527">
          
          
          <code class="ruby">      prefix_new = prefix.empty? ? k.to_s : &quot;#{prefix}.#{k}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="528">
          
          
          <code class="ruby">      acc + (v.is_a?(Hash) ? v.fqkeys(prefix_new) : [prefix_new])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="529">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="530">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="531">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="532">
          <span class="hits">1</span>
          
          <code class="ruby">  def slice(*keys)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="533">
          
          
          <code class="ruby">    self.select{|k, _| keys.include?(k)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="534">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="535">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="536">
          
          
          <code class="ruby">  # ────────────────────────────────────────────────────────────────────────────</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="537">
          
          
          <code class="ruby">  # ☞ Convert keys</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="538">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="539">
          
          
          <code class="ruby">  # Return a new `Hash` with all keys converted to `String`s.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="540">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="541">
          <span class="hits">1</span>
          
          <code class="ruby">  def deep_stringify_keys</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="542">
          
          
          <code class="ruby">    deep_transform_keys{ |key| key.to_s }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="543">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="544">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="545">
          
          
          <code class="ruby">  # Destructively convert all keys to `String`s.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="546">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="547">
          <span class="hits">1</span>
          
          <code class="ruby">  def deep_stringify_keys!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="548">
          
          
          <code class="ruby">    deep_transform_keys!{ |key| key.to_s }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="549">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="550">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="551">
          
          
          <code class="ruby">  # Return a new `Hash` with all keys converted to `Symbol`s, as long as they</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="552">
          
          
          <code class="ruby">  # respond to `to_sym`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="553">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="554">
          <span class="hits">1</span>
          
          <code class="ruby">  def deep_symbolize_keys</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="555">
          
          
          <code class="ruby">    deep_transform_keys{ |key| key.to_sym rescue key }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="556">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="557">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="558">
          
          
          <code class="ruby">  # Destructively convert all keys to `Symbol`s, as long as they respond to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="559">
          
          
          <code class="ruby">  # `to_sym`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="560">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="561">
          <span class="hits">1</span>
          
          <code class="ruby">  def deep_symbolize_keys!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="562">
          
          
          <code class="ruby">    deep_transform_keys!{ |key| key.to_sym rescue key }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="563">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="564">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="565">
          
          
          <code class="ruby">  # Return a new `Hash` with all keys converted by the block operation.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="566">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="567">
          <span class="hits">1</span>
          
          <code class="ruby">  def deep_transform_keys(&amp;block)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="568">
          
          
          <code class="ruby">    deep_transform_keys_in_object(self, &amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="569">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="570">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="571">
          
          
          <code class="ruby">  # Destructively convert all keys by using the block operation.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="572">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="573">
          <span class="hits">1</span>
          
          <code class="ruby">  def deep_transform_keys!(&amp;block)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="574">
          
          
          <code class="ruby">    deep_transform_keys_in_object!(self, &amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="575">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="576">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="577">
          <span class="hits">1</span>
          
          <code class="ruby">  def deep_transform_keys_in_object(object, &amp;block)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="578">
          
          
          <code class="ruby">    case object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="579">
          
          
          <code class="ruby">    when Hash</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="580">
          
          
          <code class="ruby">      object.each_with_object({}) do |(key, value), result|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="581">
          
          
          <code class="ruby">        result[yield(key)] = deep_transform_keys_in_object(value, &amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="582">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="583">
          
          
          <code class="ruby">    when Array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="584">
          
          
          <code class="ruby">      object.map {|e| deep_transform_keys_in_object(e, &amp;block)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="585">
          
          
          <code class="ruby">    else object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="586">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="587">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="588">
          <span class="hits">1</span>
          
          <code class="ruby">  private :deep_transform_keys_in_object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="589">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="590">
          <span class="hits">1</span>
          
          <code class="ruby">  def deep_transform_keys_in_object!(object, &amp;block)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="591">
          
          
          <code class="ruby">    case object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="592">
          
          
          <code class="ruby">    when Hash</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="593">
          
          
          <code class="ruby">      object.keys.each do |key|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="594">
          
          
          <code class="ruby">        value = object.delete(key)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="595">
          
          
          <code class="ruby">        object[yield(key)] = deep_transform_keys_in_object!(value, &amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="596">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="597">
          
          
          <code class="ruby">      object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="598">
          
          
          <code class="ruby">    when Array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="599">
          
          
          <code class="ruby">      object.map! {|e| deep_transform_keys_in_object!(e, &amp;block)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="600">
          
          
          <code class="ruby">    else object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="601">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="602">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="603">
          <span class="hits">1</span>
          
          <code class="ruby">  private :deep_transform_keys_in_object!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="604">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="605">
          
          
          <code class="ruby">  # ────────────────────────────────────────────────────────────────────────────</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="606">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="607">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="608">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="609">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────────── Pathname ← Ext ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="610">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="611">
          
          
          <code class="ruby"># Extensions for class `Pathname`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="612">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="613">
          <span class="hits">1</span>
          
          <code class="ruby">class Pathname</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="614">
          
          
          <code class="ruby">  # Escapes the string representation of the underlying object,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="615">
          
          
          <code class="ruby">  # so that it can be safely used in a Bourne shell commandline.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="616">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="617">
          <span class="hits">1</span>
          
          <code class="ruby">  def shell_escape</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="618">
          
          
          <code class="ruby">    Shellwords.shellescape(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="619">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="620">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="621">
          
          
          <code class="ruby">  # Example environment variables contained inside the path.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="622">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="623">
          <span class="hits">1</span>
          
          <code class="ruby">  def expand_variables</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="624">
          <span class="hits">1</span>
          
          <code class="ruby">    Pathname.new(to_s.expand_variables)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="625">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="626">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="627">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="628">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────────────── Thor ← Ext ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="629">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="630">
          <span class="hits">1</span>
          
          <code class="ruby">class Thor</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="631">
          <span class="hits">1</span>
          
          <code class="ruby">  module Actions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="632">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="633">
          
          
          <code class="ruby">    # Monkey-patch to retrieve the template currently processed.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="634">
          <span class="hits">1</span>
          
          <code class="ruby">    old_template = instance_method(:template)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="635">
          <span class="hits">1</span>
          
          <code class="ruby">    remove_method :template</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="636">
          <span class="hits">1</span>
          
          <code class="ruby">    define_method :template, -&gt;(source, *args, &amp;blk) do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="637">
          
          
          <code class="ruby">      $fizzy_cur_template = source</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="638">
          
          
          <code class="ruby">      old_template.bind(self).(source, *args, &amp;blk)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="639">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="640">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="641">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="642">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="643">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="644">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────────────── Configuration ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="645">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="646">
          <span class="hits">1</span>
          
          <code class="ruby">Fizzy::CFG = OpenStruct.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="647">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="648">
          
          
          <code class="ruby"># Fizzy version.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="649">
          <span class="hits">1</span>
          
          <code class="ruby">Fizzy::CFG.version = &quot;2.3.2&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="650">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="651">
          
          
          <code class="ruby"># URL for reporting fizzy issues.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="652">
          <span class="hits">1</span>
          
          <code class="ruby">Fizzy::CFG.issues_url = &quot;https://github.com/alem0lars/fizzy/issues&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="653">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="654">
          
          
          <code class="ruby"># Default editor.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="655">
          <span class="hits">1</span>
          
          <code class="ruby">Fizzy::CFG.editor = ENV[&quot;EDITOR&quot;] || &quot;vim&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="656">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="657">
          
          
          <code class="ruby"># Debug mode.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="658">
          <span class="hits">1</span>
          
          <code class="ruby">Fizzy::CFG.debug = ENV[&quot;FIZZY_DEBUG&quot;] =~ /^(?:true|yes)$/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="659">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="660">
          
          
          <code class="ruby"># The operating-system which fizzy is running on.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="661">
          <span class="hits">1</span>
          
          <code class="ruby">Fizzy::CFG.os = case RUBY_PLATFORM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="662">
          
          
          <code class="ruby">                  when /darwin/ then :osx</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="663">
          <span class="hits">1</span>
          
          <code class="ruby">                  when /linux/  then :linux</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="664">
          
          
          <code class="ruby">                  else               :windows</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="665">
          
          
          <code class="ruby">                end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="666">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="667">
          
          
          <code class="ruby"># Remote URL for fizzy static files (must end with a slash).</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="668">
          <span class="hits">1</span>
          
          <code class="ruby">Fizzy::CFG.static_files_base_url =</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="669">
          
          
          <code class="ruby">  URI(&quot;https://raw.githubusercontent.com/alem0lars/fizzy/master/&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="670">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="671">
          
          
          <code class="ruby"># Default fizzy root directory (holding all of the fizzy stuff).</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="672">
          <span class="hits">1</span>
          
          <code class="ruby">Fizzy::CFG.default_fizzy_dir = Pathname.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="673">
          
          
          <code class="ruby">  ENV[&quot;FIZZY_DIR&quot;] ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="674">
          
          
          <code class="ruby">  case Fizzy::CFG.os</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="675">
          <span class="hits">1</span>
          
          <code class="ruby">    when :linux   then &quot;/usr/share/fizzy&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="676">
          
          
          <code class="ruby">    when :osx     then &quot;~/Library/Application Support/fizzy&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="677">
          
          
          <code class="ruby">    when :windows then &quot;~/fizzy&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="678">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="679">
          
          
          <code class="ruby">).expand_variables.expand_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="680">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="681">
          
          
          <code class="ruby"># Default meta file name.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="682">
          <span class="hits">1</span>
          
          <code class="ruby">Fizzy::CFG.default_meta_name = &quot;meta.yml&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="683">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="684">
          
          
          <code class="ruby"># Variables inheritance.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="685">
          <span class="hits">1</span>
          
          <code class="ruby">Fizzy::CFG.vars = OpenStruct.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="686">
          
          
          <code class="ruby">  yaml_regexp: /^#\s*=&gt;\s*inherits\s*(:\s+)?(?&lt;parents&gt;.+)\s*&lt;=\s*#\s*/,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="687">
          
          
          <code class="ruby">  json_regexp: /^\/\*\s*=&gt;\s*inherits\s*(:\s+)?(?&lt;parents&gt;.+)\s*&lt;=\s*\*\/\s*/,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="688">
          
          
          <code class="ruby">  parent_dummy_regexp: /none|nothing/i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="689">
          
          
          <code class="ruby">)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="690">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="691">
          <span class="hits">1</span>
          
          <code class="ruby">Fizzy::CFG.instantiate_exclude_pattern = /\.git|README/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="692">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="693">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────────────── Log ← Io ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="694">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="695">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::IO</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="696">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::ANSIColors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="697">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="698">
          
          
          <code class="ruby">  # Display a debug message (with caller info).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="699">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="700">
          <span class="hits">1</span>
          
          <code class="ruby">  def debug(msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="701">
          
          
          <code class="ruby">    return unless Fizzy::CFG.debug</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="702">
          
          
          <code class="ruby">    caller_info = caller</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="703">
          
          
          <code class="ruby">                  .map { |c| c[/`.*&#39;/][1..-2].split(&quot; &quot;).first }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="704">
          
          
          <code class="ruby">                  .uniq[0..2]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="705">
          
          
          <code class="ruby">                  .join(&quot; → &quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="706">
          
          
          <code class="ruby">    tell(&quot;{m{⚫}}{b{&lt;}}{c{#{caller_info}}}{b{&gt;}}{w{: #{msg}}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="707">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="708">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="709">
          
          
          <code class="ruby">  # Display an informative message (`msg`) to the user.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="710">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="711">
          
          
          <code class="ruby">  # The `prefix` argument should contain some text displayed before the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="712">
          
          
          <code class="ruby">  # message, typically to show the context which the message belongs to.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="713">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="714">
          <span class="hits">1</span>
          
          <code class="ruby">  def info(prefix, msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="715">
          
          
          <code class="ruby">    tell(&quot;{b{☞ }}{c{#{prefix}}}{w{ #{msg}}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="716">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="717">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="718">
          
          
          <code class="ruby">  # Display an informative message (`msg`) to the user.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="719">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="720">
          
          
          <code class="ruby">  # If `ask_continue` is `true`, the user can interactively choose to stop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="721">
          
          
          <code class="ruby">  # the program or exit (with exit status `-1`).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="722">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="723">
          <span class="hits">1</span>
          
          <code class="ruby">  def warning(msg, ask_continue: true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="724">
          
          
          <code class="ruby">    tell(&quot;{y{☞ #{msg}}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="725">
          
          
          <code class="ruby">    exit(-1) if ask_continue &amp;&amp; !ask(&quot;continue&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="726">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="727">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="728">
          
          
          <code class="ruby">  # Display an error message (`msg`) to the user. Before returning, the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="729">
          
          
          <code class="ruby">  # program will exit (with exit status `-1`).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="730">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="731">
          <span class="hits">1</span>
          
          <code class="ruby">  def error(msg, exc: -1, silent: false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="732">
          
          
          <code class="ruby">    tell(&quot;{r{☠ #{msg}}}&quot;) unless silent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="733">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="734">
          
          
          <code class="ruby">    if exc.is_a? Integer</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="735">
          
          
          <code class="ruby">      exit(exc)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="736">
          
          
          <code class="ruby">    elsif !exc.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="737">
          
          
          <code class="ruby">      raise exc if msg.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="738">
          
          
          <code class="ruby">      raise exc, msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="739">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="740">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="741">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="742">
          
          
          <code class="ruby">  # Tell something to the user.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="743">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="744">
          <span class="hits">1</span>
          
          <code class="ruby">  def tell(*args, newline: true, **kwargs)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="745">
          <span class="hits">2</span>
          
          <code class="ruby">    if args.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="746">
          
          
          <code class="ruby">      puts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="747">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="748">
          <span class="hits">2</span>
          
          <code class="ruby">      colorized_str = colorize(*args, **kwargs)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="749">
          <span class="hits">2</span>
          
          <code class="ruby">      if newline</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="750">
          <span class="hits">2</span>
          
          <code class="ruby">        $stdout.puts(colorized_str)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="751">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="752">
          
          
          <code class="ruby">        $stdout.print(colorized_str)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="753">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="754">
          <span class="hits">2</span>
          
          <code class="ruby">      $stdout.flush</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="755">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="756">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="757">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="758">
          
          
          <code class="ruby">  # ────────────────────────────────────────────────────────────────────────────</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="759">
          
          
          <code class="ruby">  # ☞ Well-known messages</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="760">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="761">
          
          
          <code class="ruby">  # Get colorized success symbol.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="762">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="763">
          <span class="hits">1</span>
          
          <code class="ruby">  def ✔</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="764">
          
          
          <code class="ruby">    &quot;{g{✔}}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="765">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="766">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="767">
          
          
          <code class="ruby">  # Get colorized error symbol.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="768">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="769">
          <span class="hits">1</span>
          
          <code class="ruby">  def ✘</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="770">
          
          
          <code class="ruby">    &quot;{r{✘}}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="771">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="772">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="773">
          
          
          <code class="ruby">  # ────────────────────────────────────────────────────────────────────────────</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="774">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="775">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="776">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────── Line editor ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="777">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="778">
          
          
          <code class="ruby"># TODO move to separate files..</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="779">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="780">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="781">
          <span class="hits">1</span>
          
          <code class="ruby">  module LineEditor</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="782">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.enabled</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="783">
          
          
          <code class="ruby">      if Readline.available?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="784">
          
          
          <code class="ruby">        Readline</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="785">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="786">
          
          
          <code class="ruby">        Basic</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="787">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="788">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="789">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="790">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="791">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="792">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::LineEditor</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="793">
          <span class="hits">1</span>
          
          <code class="ruby">  class Basic</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="794">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :prompt, :options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="795">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="796">
          <span class="hits">1</span>
          
          <code class="ruby">    include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="797">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="798">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.available?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="799">
          
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="800">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="801">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="802">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(prompt, options={})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="803">
          
          
          <code class="ruby">      @prompt = prompt</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="804">
          
          
          <code class="ruby">      @options = options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="805">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="806">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="807">
          <span class="hits">1</span>
          
          <code class="ruby">    def readline</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="808">
          
          
          <code class="ruby">      tell(prompt, newline: false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="809">
          
          
          <code class="ruby">      get_input</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="810">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="811">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="812">
          <span class="hits">1</span>
          
          <code class="ruby">    private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="813">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="814">
          <span class="hits">1</span>
          
          <code class="ruby">    def get_input</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="815">
          
          
          <code class="ruby">      if echo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="816">
          
          
          <code class="ruby">        $stdin.gets</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="817">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="818">
          
          
          <code class="ruby">        $stdin.noecho(&amp;:gets)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="819">
          
          
          <code class="ruby">      end.chomp</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="820">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="821">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="822">
          <span class="hits">1</span>
          
          <code class="ruby">    def echo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="823">
          
          
          <code class="ruby">      options.fetch(:echo, true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="824">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="825">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="826">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="827">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="828">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::LineEditor</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="829">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="830">
          
          
          <code class="ruby">  # Available options:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="831">
          
          
          <code class="ruby">  # - add_to_history</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="832">
          
          
          <code class="ruby">  # - limited_to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="833">
          
          
          <code class="ruby">  # - path</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="834">
          <span class="hits">1</span>
          
          <code class="ruby">  class Readline &lt; Basic</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="835">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="836">
          <span class="hits">1</span>
          
          <code class="ruby">    include Fizzy::ANSIColors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="837">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="838">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.available?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="839">
          
          
          <code class="ruby">      Object.const_defined?(:Readline)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="840">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="841">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="842">
          <span class="hits">1</span>
          
          <code class="ruby">    def readline</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="843">
          
          
          <code class="ruby">      if echo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="844">
          
          
          <code class="ruby">        ::Readline.completion_append_character = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="845">
          
          
          <code class="ruby">        # Ruby 1.8.7 does not allow Readline.completion_proc= to receive nil.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="846">
          
          
          <code class="ruby">        if complete = completion_proc</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="847">
          
          
          <code class="ruby">          ::Readline.completion_proc = complete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="848">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="849">
          
          
          <code class="ruby">        ::Readline.readline(colorize(prompt), add_to_history?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="850">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="851">
          
          
          <code class="ruby">        super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="852">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="853">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="854">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="855">
          <span class="hits">1</span>
          
          <code class="ruby">    def add_to_history?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="856">
          
          
          <code class="ruby">      options.fetch(:add_to_history, true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="857">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="858">
          <span class="hits">1</span>
          
          <code class="ruby">    private :add_to_history?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="859">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="860">
          <span class="hits">1</span>
          
          <code class="ruby">    def completion_proc</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="861">
          
          
          <code class="ruby">      if use_path_completion?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="862">
          
          
          <code class="ruby">        proc { |text| PathCompletion.new(text).matches }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="863">
          
          
          <code class="ruby">      elsif completion_options.any?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="864">
          
          
          <code class="ruby">        proc do |text|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="865">
          
          
          <code class="ruby">          completion_options.select { |option| option.to_s.start_with?(text) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="866">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="867">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="868">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="869">
          <span class="hits">1</span>
          
          <code class="ruby">    private :completion_proc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="870">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="871">
          <span class="hits">1</span>
          
          <code class="ruby">    def completion_options</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="872">
          
          
          <code class="ruby">      options.fetch(:limited_to, [])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="873">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="874">
          <span class="hits">1</span>
          
          <code class="ruby">    private :completion_options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="875">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="876">
          <span class="hits">1</span>
          
          <code class="ruby">    def use_path_completion?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="877">
          
          
          <code class="ruby">      options.fetch(:path, false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="878">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="879">
          <span class="hits">1</span>
          
          <code class="ruby">    private :use_path_completion?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="880">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="881">
          <span class="hits">1</span>
          
          <code class="ruby">    class PathCompletion</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="882">
          <span class="hits">1</span>
          
          <code class="ruby">      attr_reader :text</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="883">
          <span class="hits">1</span>
          
          <code class="ruby">      private :text</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="884">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="885">
          <span class="hits">1</span>
          
          <code class="ruby">      def initialize(text)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="886">
          
          
          <code class="ruby">        @text = text</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="887">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="888">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="889">
          <span class="hits">1</span>
          
          <code class="ruby">      def matches</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="890">
          
          
          <code class="ruby">        relative_matches</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="891">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="892">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="893">
          <span class="hits">1</span>
          
          <code class="ruby">      def relative_matches</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="894">
          
          
          <code class="ruby">        absolute_matches.map { |path| path.sub(base_path, &quot;&quot;) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="895">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="896">
          <span class="hits">1</span>
          
          <code class="ruby">      private :relative_matches</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="897">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="898">
          <span class="hits">1</span>
          
          <code class="ruby">      def absolute_matches</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="899">
          
          
          <code class="ruby">        Dir[glob_pattern].map do |path|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="900">
          
          
          <code class="ruby">          if File.directory?(path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="901">
          
          
          <code class="ruby">            &quot;#{path}/&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="902">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="903">
          
          
          <code class="ruby">            path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="904">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="905">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="906">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="907">
          <span class="hits">1</span>
          
          <code class="ruby">      private :absolute_matches</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="908">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="909">
          <span class="hits">1</span>
          
          <code class="ruby">      def glob_pattern</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="910">
          
          
          <code class="ruby">        &quot;#{base_path}#{text}*&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="911">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="912">
          <span class="hits">1</span>
          
          <code class="ruby">      private :glob_pattern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="913">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="914">
          <span class="hits">1</span>
          
          <code class="ruby">      def base_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="915">
          
          
          <code class="ruby">        &quot;#{Dir.pwd}/&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="916">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="917">
          <span class="hits">1</span>
          
          <code class="ruby">      private :base_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="918">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="919">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="920">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="921">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="922">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────────────── Ask ← Io ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="923">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="924">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="925">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="926">
          
          
          <code class="ruby">  # Ask a question to the user.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="927">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="928">
          
          
          <code class="ruby">  # The message is made by the `question` string, with some additions (like</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="929">
          
          
          <code class="ruby">  # `?` sign if not already present).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="930">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="931">
          
          
          <code class="ruby">  # The available ask types are:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="932">
          
          
          <code class="ruby">  # - `:bool`: Boolean ask, the user can respond with `yes` or `no` (or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="933">
          
          
          <code class="ruby">  #            alternatives, see regexes below). A boolean value is returned.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="934">
          
          
          <code class="ruby">  # - `:string`: Normal ask, the user is prompt for a question and if the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="935">
          
          
          <code class="ruby">  #              answer isn&#39;t empty is returned.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="936">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="937">
          <span class="hits">1</span>
          
          <code class="ruby">  def ask(question, type: :bool)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="938">
          
          
          <code class="ruby">    question = question.gsub(/[?]*/, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="939">
          
          
          <code class="ruby">    question.strip!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="940">
          
          
          <code class="ruby">    question &lt;&lt; &quot;? &quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="941">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="942">
          
          
          <code class="ruby">    options = case type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="943">
          
          
          <code class="ruby">              when :bool</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="944">
          
          
          <code class="ruby">                { limited_to: %i(yes no) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="945">
          
          
          <code class="ruby">              when :path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="946">
          
          
          <code class="ruby">                { path: true }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="947">
          
          
          <code class="ruby">              when :string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="948">
          
          
          <code class="ruby">                {}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="949">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="950">
          
          
          <code class="ruby">                error(&quot;Unhandled question type: `{m{#{type}}}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="951">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="952">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="953">
          
          
          <code class="ruby">    line_editor = Fizzy::LineEditor.enabled.new(&quot;{Ml{ ? }}#{question}&quot;, options)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="954">
          
          
          <code class="ruby">    answer = line_editor.readline</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="955">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="956">
          
          
          <code class="ruby">    case type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="957">
          
          
          <code class="ruby">    when :bool</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="958">
          
          
          <code class="ruby">      if answer =~ /(y|ye|yes|yeah|ofc)$/i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="959">
          
          
          <code class="ruby">        true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="960">
          
          
          <code class="ruby">      elsif answer =~ /(n|no|fuck|fuck\s+you|fuck\s+off)$/i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="961">
          
          
          <code class="ruby">        false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="962">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="963">
          
          
          <code class="ruby">        tell(&quot;{y{Answer misunderstood}}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="964">
          
          
          <code class="ruby">        ask(question, type: type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="965">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="966">
          
          
          <code class="ruby">    when :string, :path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="967">
          
          
          <code class="ruby">      if answer.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="968">
          
          
          <code class="ruby">        warning(&quot;Empty answer&quot;, ask_continue: false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="969">
          
          
          <code class="ruby">        ask(question, type: type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="970">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="971">
          
          
          <code class="ruby">        answer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="972">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="973">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="974">
          
          
          <code class="ruby">      error(&quot;Unhandled question type: `{m{#{type}}}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="975">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="976">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="977">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="978">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="979">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="980">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────────────── Caller ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="981">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="982">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::Caller</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="983">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="984">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.info(depth=1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="985">
          
          
          <code class="ruby">    parse_caller(caller(depth + 2).first)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="986">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="987">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="988">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.method_name(depth=1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="989">
          
          
          <code class="ruby">    parse_caller(caller(depth + 2).first)[:method]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="990">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="991">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="992">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.parse_caller(at)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="993">
          
          
          <code class="ruby">    if /^(.+?):(\d+)(?::in `(.*)&#39;)?/ =~ at</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="994">
          
          
          <code class="ruby">      file   = Regexp.last_match[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="995">
          
          
          <code class="ruby">      line   = Regexp.last_match[2].to_i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="996">
          
          
          <code class="ruby">      method = Regexp.last_match[3]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="997">
          
          
          <code class="ruby">      {file: file, line: line, method: method}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="998">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="999">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1000">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1001">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1002">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1003">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────────────────── Must ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1004">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1005">
          <span class="hits">1</span>
          
          <code class="ruby">class Object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1006">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1007">
          <span class="hits">1</span>
          
          <code class="ruby">  def must(name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1008">
          
          
          <code class="ruby">           value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1009">
          
          
          <code class="ruby">           be: nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1010">
          
          
          <code class="ruby">           ge: nil, gt: nil, le: nil, lt: nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1011">
          
          
          <code class="ruby">           msg: nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1012">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1013">
          
          
          <code class="ruby">    def err(msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1014">
          
          
          <code class="ruby">      error msg, exc: ArgumentError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1015">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1016">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1017">
          
          
          <code class="ruby">    if !be.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1018">
          
          
          <code class="ruby">      # 1: type condition.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1019">
          
          
          <code class="ruby">      if be.is_a?(Class)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1020">
          
          
          <code class="ruby">        unless value.is_a?(be)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1021">
          
          
          <code class="ruby">          err &quot;Invalid `#{name}` (value=`#{value}`): must be a `#{be}`&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1022">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1023">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1024">
          
          
          <code class="ruby">      if be.is_a?(Array) &amp;&amp; be.all? { |b| b.is_a?(Class) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1025">
          
          
          <code class="ruby">        unless be.any? { |b| value.is_a?(b) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1026">
          
          
          <code class="ruby">          err &quot;Invalid `#{name}` (value=`#{value}`): must be any of `#{be}`&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1027">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1028">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1029">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1030">
          
          
          <code class="ruby">      # 2: not-`nil` condition.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1031">
          
          
          <code class="ruby">      err &quot;Invalid `#{name}`: must be not nil&quot; if be == :not_nil &amp;&amp; value.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1032">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1033">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1034">
          
          
          <code class="ruby">    # 3.1: greater-or-equal-than condition.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1035">
          
          
          <code class="ruby">    if !ge.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1036">
          
          
          <code class="ruby">      must name, value, be: Number</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1037">
          
          
          <code class="ruby">      must :ge,  ge,    be: Number</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1038">
          
          
          <code class="ruby">      unless value &gt;= ge</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1039">
          
          
          <code class="ruby">        err &quot;Invalid `#{name}`: `#{value}` must be greater or equal than `#{ge}`&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1040">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1041">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1042">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1043">
          
          
          <code class="ruby">    # 3.2: greater-than condition.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1044">
          
          
          <code class="ruby">    if !gt.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1045">
          
          
          <code class="ruby">      must name, value, be: Number</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1046">
          
          
          <code class="ruby">      must :gt,  gt,    be: Number</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1047">
          
          
          <code class="ruby">      unless value &gt; gt</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1048">
          
          
          <code class="ruby">        err &quot;Invalid `#{name}`: `#{value}` must be greater than `#{gt}`&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1049">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1050">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1051">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1052">
          
          
          <code class="ruby">    # 3.3: lesser-or-equal-than condition.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1053">
          
          
          <code class="ruby">    if !le.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1054">
          
          
          <code class="ruby">      must name, value, be: Number</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1055">
          
          
          <code class="ruby">      must :le,  le,    be: Number</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1056">
          
          
          <code class="ruby">      unless value &lt;= le</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1057">
          
          
          <code class="ruby">        err &quot;Invalid `#{name}`: `#{value}` must be lesser or equal than `#{le}`&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1058">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1059">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1060">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1061">
          
          
          <code class="ruby">    # 3.4: lesser-than condition.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1062">
          
          
          <code class="ruby">    if !lt.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1063">
          
          
          <code class="ruby">      must name, value, be: Number</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1064">
          
          
          <code class="ruby">      must :lt,  lt,    be: Number</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1065">
          
          
          <code class="ruby">      unless value &lt; lt</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1066">
          
          
          <code class="ruby">        err &quot;Invalid `#{name}`: `#{value}` must be lesser than `#{lt}`&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1067">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1068">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1069">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1070">
          
          
          <code class="ruby">    # 3: ad-hoc condition.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1071">
          
          
          <code class="ruby">    if block_given?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1072">
          
          
          <code class="ruby">      result = yield(name, value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1073">
          
          
          <code class="ruby">      if result.is_a?(Array)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1074">
          
          
          <code class="ruby">        err &quot;Invalid `#{name}`: #{result[1]}&quot; unless result[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1075">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1076">
          
          
          <code class="ruby">        err &quot;Invalid `#{name}`: wrong value `#{value}`&quot; unless result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1077">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1078">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1079">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1080">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1081">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1082">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1083">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────── Abstract method ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1084">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1085">
          
          
          <code class="ruby"># Exception raised when an abstract method is called.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1086">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1087">
          <span class="hits">1</span>
          
          <code class="ruby">class AbstractMethodCalled &lt; StandardError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1088">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1089">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1090">
          <span class="hits">1</span>
          
          <code class="ruby">class Module</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1091">
          
          
          <code class="ruby">  # Define one or more abstract methods with given names in a class or module.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1092">
          
          
          <code class="ruby">  # When called, the abstract method will raise an `AbstractMethodCalled`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1093">
          
          
          <code class="ruby">  # exception with a helpful message.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1094">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1095">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1096">
          
          
          <code class="ruby">  #   class AbstractClass</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1097">
          
          
          <code class="ruby">  #     abstract_method :foo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1098">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1099">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1100">
          
          
          <code class="ruby">  #   class ConcreteClass &lt; AbstractClass</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1101">
          
          
          <code class="ruby">  #     def foo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1102">
          
          
          <code class="ruby">  #       42</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1103">
          
          
          <code class="ruby">  #     end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1104">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1105">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1106">
          
          
          <code class="ruby">  #   AbstractClass.new.foo # raises AbstractMethodCalled</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1107">
          
          
          <code class="ruby">  #   ConcreteClass.new.foo # =&gt; 42</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1108">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1109">
          
          
          <code class="ruby">  # @param [Array&lt;Symbol&gt;] names the names of defined abstract methods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1110">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1111">
          <span class="hits">1</span>
          
          <code class="ruby">  def abstract_method(*names)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="1112">
          <span class="hits">4</span>
          
          <code class="ruby">    definitor = self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="1114">
          <span class="hits">4</span>
          
          <code class="ruby">    names.each do |name|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="1115">
          <span class="hits">4</span>
          
          <code class="ruby">      define_method name do |*args|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1116">
          
          
          <code class="ruby">        raise AbstractMethodCalled,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1117">
          
          
          <code class="ruby">              &quot;Called unimplemented abstract method #{self.class}##{name} &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1118">
          
          
          <code class="ruby">              &quot;(defined in #{definitor.class.name.downcase} #{definitor}).&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1119">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1120">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1121">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1122">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1124">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────────── Typesystem ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1126">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::TypeSystem</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1128">
          
          
          <code class="ruby">  # Check/convert type of the provided `value`,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1129">
          
          
          <code class="ruby">  # according to the argument `type`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1130">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1131">
          
          
          <code class="ruby">  # The argument `name` is a logical name to be used for the value,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1132">
          
          
          <code class="ruby">  # used when logging messages. It can be anything.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1133">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1134">
          
          
          <code class="ruby">  # If `strict` is `true`, then no type convertion/normalization is done;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1135">
          
          
          <code class="ruby">  # otherwise, try to guess the correct type.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1136">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1137">
          <span class="hits">1</span>
          
          <code class="ruby">  def typize(name, value, type: nil, strict: false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1138">
          
          
          <code class="ruby">    if type.nil? || (type.to_s.end_with?(&quot;?&quot;) &amp;&amp; value.nil?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1139">
          
          
          <code class="ruby">      value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1140">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1141">
          
          
          <code class="ruby">      case type.to_s.gsub(/\?$/, &quot;&quot;).to_sym</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1142">
          
          
          <code class="ruby">        when :string, :str</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1143">
          
          
          <code class="ruby">          strict ? _ensure_type!(name, value, String) : value.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1144">
          
          
          <code class="ruby">        when :symbol, :sym</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1145">
          
          
          <code class="ruby">          strict ? _ensure_type!(name, value, Symbol) : value.to_s.to_sym</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1146">
          
          
          <code class="ruby">        when :integer, :int</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1147">
          
          
          <code class="ruby">          strict ? _ensure_type!(name, value, Integer) : Integer(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1148">
          
          
          <code class="ruby">        when :boolean, :bool</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1149">
          
          
          <code class="ruby">          if strict</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1150">
          
          
          <code class="ruby">            _ensure_type!(name, value, TrueClass, FalseClass)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1151">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1152">
          
          
          <code class="ruby">            if value.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1153">
          
          
          <code class="ruby">              nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1154">
          
          
          <code class="ruby">            elsif value.is_a?(TrueClass) || value.to_s == &quot;true&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1155">
          
          
          <code class="ruby">              true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1156">
          
          
          <code class="ruby">            elsif value.is_a?(FalseClass) || value.to_s == &quot;false&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1157">
          
          
          <code class="ruby">              false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1158">
          
          
          <code class="ruby">            else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1159">
          
          
          <code class="ruby">              error(&quot;Invalid `#{value}` for value `#{name}`: &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1160">
          
          
          <code class="ruby">                    &quot;it can&#39;t be converted to a boolean.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1161">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1162">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1163">
          
          
          <code class="ruby">        when :path, :pth then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1164">
          
          
          <code class="ruby">          if strict &amp;&amp; !File.exist?(value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1165">
          
          
          <code class="ruby">            error(&quot;Invalid `#{name}`: `#{value}` doesn&#39;t exist&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1166">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1167">
          
          
          <code class="ruby">            Pathname.new(value).expand_variables.expand_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1168">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1169">
          
          
          <code class="ruby">        when :file then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1170">
          
          
          <code class="ruby">          if strict &amp;&amp; !File.file?(value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1171">
          
          
          <code class="ruby">            error(&quot;Invalid `#{name}`: `#{value}` isn&#39;t a file&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1172">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1173">
          
          
          <code class="ruby">            Pathname.new(value).expand_variables.expand_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1174">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1175">
          
          
          <code class="ruby">        when :directory, :dir then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1176">
          
          
          <code class="ruby">          if strict &amp;&amp; !File.directory?(value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1177">
          
          
          <code class="ruby">            error(&quot;Invalid `#{name}`: `#{value}` isn&#39;t a directory&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1178">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1179">
          
          
          <code class="ruby">            Pathname.new(value).expand_variables.expand_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1180">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1181">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1182">
          
          
          <code class="ruby">          error(&quot;Unhandled type `#{type}`. If you need support for a new &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1183">
          
          
          <code class="ruby">                &quot;type, open an issue at `#{Fizzy::CFG.issues_url}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1184">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1185">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1186">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1187">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1188">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1190">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────────────────── Tree ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1191">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1192">
          
          
          <code class="ruby"># Namespace for fizzy&#39;s tree data structure implementation.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1193">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Tree</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1194">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1196">
          
          
          <code class="ruby"># ────────────────────────────────────────────── Hash converter ← tree ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1197">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1198">
          
          
          <code class="ruby"># Provides utility methods for converting between {Fizzy::Tree::Node} and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1199">
          
          
          <code class="ruby"># ruby&#39;s native `Hash`.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1200">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Tree::HashConverter</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1201">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.included(base)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1202">
          
          
          <code class="ruby">    # @!group Hash convertion</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1203">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1204">
          <span class="hits">1</span>
          
          <code class="ruby">    base.extend(ClassMethods)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1205">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1206">
          
          
          <code class="ruby">    # Instantiate and insert child nodes from data in a ruby `Hash`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1207">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1208">
          
          
          <code class="ruby">    # This method will instantiate a node instance for each top-level key of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1209">
          
          
          <code class="ruby">    # the input hash, to be inserted as children of the receiver instance.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1210">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1211">
          
          
          <code class="ruby">    # Nested hashes are expected and further child nodes will be created</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1212">
          
          
          <code class="ruby">    # and added accordingly.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1213">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1214">
          
          
          <code class="ruby">    # If a hash key is a single value that value will be used as the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1215">
          
          
          <code class="ruby">    # name for the node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1216">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1217">
          
          
          <code class="ruby">    # If a hash key is an `Array`, both node name and content will be</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1218">
          
          
          <code class="ruby">    # populated.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1219">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1220">
          
          
          <code class="ruby">    # A leaf element of the tree should be represented as a hash key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1221">
          
          
          <code class="ruby">    # with corresponding value `nil` or `{}`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1222">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1223">
          
          
          <code class="ruby">    # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1224">
          
          
          <code class="ruby">    #   root = Fizzy::Tree::Node.new(:A, &quot;Root content!&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1225">
          
          
          <code class="ruby">    #   root.add_from_hash({:B =&gt; {:D =&gt; {}}, [:C, &quot;C content!&quot;] =&gt; {}})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1226">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1227">
          
          
          <code class="ruby">    # @param [Hash] children The hash of child subtrees.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1228">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1229">
          
          
          <code class="ruby">    # @return [Array] Array of child nodes added.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1230">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1231">
          
          
          <code class="ruby">    # @raise [ArgumentError] If a non-`Hash` is passed.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1232">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1233">
          
          
          <code class="ruby">    # @see ClassMethods#from_hash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1234">
          <span class="hits">1</span>
          
          <code class="ruby">    def add_from_hash(children)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1235">
          
          
          <code class="ruby">      must &quot;children&quot;, children, be: Hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1236">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1237">
          
          
          <code class="ruby">      child_nodes = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1238">
          
          
          <code class="ruby">      children.each do |child, grandchildren|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1239">
          
          
          <code class="ruby">        child_node = self.class.from_hash({child =&gt; grandchildren})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1240">
          
          
          <code class="ruby">        child_nodes &lt;&lt; child_node</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1241">
          
          
          <code class="ruby">        self &lt;&lt; child_node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1242">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1243">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1244">
          
          
          <code class="ruby">      child_nodes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1245">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1246">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1247">
          
          
          <code class="ruby">    # Convert a node and its subtree into a ruby `Hash`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1248">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1249">
          
          
          <code class="ruby">    # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1250">
          
          
          <code class="ruby">    #   root  = Fizzy::Tree::Node.new(:root, &quot;root content&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1251">
          
          
          <code class="ruby">    #   root &lt;&lt; Fizzy::Tree::Node.new(:child1, &quot;child1 content&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1252">
          
          
          <code class="ruby">    #   root &lt;&lt; Fizzy::Tree::Node.new(:child2, &quot;child2 content&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1253">
          
          
          <code class="ruby">    #   root.to_h # =&gt; { [:root, &quot;root content&quot;] =&gt;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1254">
          
          
          <code class="ruby">    #                      { [:child1, &quot;child1 content&quot;] =&gt; {},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1255">
          
          
          <code class="ruby">    #                        [:child2, &quot;child2 content&quot;] =&gt; {} } }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1256">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1257">
          
          
          <code class="ruby">    # @return [Hash] `Hash` representation of the tree.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1258">
          <span class="hits">1</span>
          
          <code class="ruby">    def to_h</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1259">
          
          
          <code class="ruby">      key = has_content? ? [name, content] : name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1260">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1261">
          
          
          <code class="ruby">      children_hash = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1262">
          
          
          <code class="ruby">      children do |child|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1263">
          
          
          <code class="ruby">        children_hash.merge! child.to_h</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1264">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1265">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1266">
          
          
          <code class="ruby">      { key =&gt; children_hash }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1267">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1268">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1269">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1270">
          
          
          <code class="ruby">  # Methods in {Fizzy::Tree::HashConverter::ClassMethods} will be added as</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1271">
          
          
          <code class="ruby">  # class methods on any class mixing in the {Fizzy::Tree::HashConverter}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1272">
          
          
          <code class="ruby">  # module.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1273">
          <span class="hits">1</span>
          
          <code class="ruby">  module ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1274">
          
          
          <code class="ruby">    # Factory method builds a {Fizzy::Tree::Node} from a `Hash`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1275">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1276">
          
          
          <code class="ruby">    # This method will interpret each key of your `Hash` as a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1277">
          
          
          <code class="ruby">    # {Fizzy::Tree::Node}.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1278">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1279">
          
          
          <code class="ruby">    # Nested hashes are expected and child nodes will be added accordingly.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1280">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1281">
          
          
          <code class="ruby">    # If a hash key is a single value that value will be used as the name for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1282">
          
          
          <code class="ruby">    # the node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1283">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1284">
          
          
          <code class="ruby">    # If a hash key is an Array, both node name and content will be</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1285">
          
          
          <code class="ruby">    # populated.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1286">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1287">
          
          
          <code class="ruby">    # A leaf element of the tree should be represented as a hash key with</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1288">
          
          
          <code class="ruby">    # corresponding value `nil` or `{}`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1289">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1290">
          
          
          <code class="ruby">    # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1291">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1292">
          
          
          <code class="ruby">    #   TreeNode.from_hash({:A =&gt; {:B =&gt; {}, :C =&gt; {:D =&gt; {}, :E =&gt; {}}}})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1293">
          
          
          <code class="ruby">    #   # ^- would be parsed into the following tree structure:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1294">
          
          
          <code class="ruby">    #   #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1295">
          
          
          <code class="ruby">    #   #    A</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1296">
          
          
          <code class="ruby">    #   #   / \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1297">
          
          
          <code class="ruby">    #   #  B   C</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1298">
          
          
          <code class="ruby">    #   #     / \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1299">
          
          
          <code class="ruby">    #   #    D   E</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1300">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1301">
          
          
          <code class="ruby">    #   # The same tree would result from this `nil`-terminated `Hash`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1302">
          
          
          <code class="ruby">    #   {:A =&gt; {:B =&gt; nil, :C =&gt; {:D =&gt; nil, :E =&gt; nil}}}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1303">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1304">
          
          
          <code class="ruby">    #   # A tree with equivalent structure but with content present for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1305">
          
          
          <code class="ruby">    #   # nodes A and D could be built from a hash like this:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1306">
          
          
          <code class="ruby">    #   {[:A, &quot;A content&quot;] =&gt; {:B =&gt; {},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1307">
          
          
          <code class="ruby">    #                          :C =&gt; { [:D, &quot;D content&quot;] =&gt; {},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1308">
          
          
          <code class="ruby">    #                                   :E =&gt; {}  }}}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1309">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1310">
          
          
          <code class="ruby">    # @param [Hash] hash Hash to build tree from.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1311">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1312">
          
          
          <code class="ruby">    # @return [Fizzy::Tree::Node] The node representing the root of your tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1313">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1314">
          
          
          <code class="ruby">    # @raise [ArgumentError] This exception is raised if a non-`Hash` is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1315">
          
          
          <code class="ruby">    #                        passed.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1316">
          
          
          <code class="ruby">    # @raise [ArgumentError] This exception is raised if the hash has multiple</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1317">
          
          
          <code class="ruby">    #                        top-level elements.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1318">
          
          
          <code class="ruby">    # @raise [ArgumentError] This exception is raised if `hash` contains</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1319">
          
          
          <code class="ruby">    #                        values that are not `Hash`es or `nil`s.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1320">
          <span class="hits">1</span>
          
          <code class="ruby">    def from_hash(hash)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1321">
          
          
          <code class="ruby">      must &quot;hash&quot;,      hash,      be: Hash</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1322">
          
          
          <code class="ruby">      must &quot;hash size&quot;, hash.size, eq: 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1323">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1324">
          
          
          <code class="ruby">      root, children = hash.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1325">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1326">
          
          
          <code class="ruby">      must &quot;hash children&quot;, children, be: [Hash, NilClass]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1328">
          
          
          <code class="ruby">      node = self.new(*root)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1329">
          
          
          <code class="ruby">      node.add_from_hash(children) unless children.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1330">
          
          
          <code class="ruby">      node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1331">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1332">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1333">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1334">
          
          
          <code class="ruby">  # @!endgroup</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1335">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1336">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1337">
          
          
          <code class="ruby"># ─────────────────────────────────────────────── Merge handler ← tree ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1338">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1339">
          
          
          <code class="ruby"># Provides utility methods to merge two {Fizzy::Tree::Node} based trees.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1340">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Tree::MergeHandler</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1341">
          
          
          <code class="ruby">  # @!group Merging Trees</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1342">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1343">
          
          
          <code class="ruby">  # Merge two trees that share the same root node and returns *a new tree*.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1344">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1345">
          
          
          <code class="ruby">  # The new tree contains the contents of the merge between `other_tree` and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1346">
          
          
          <code class="ruby">  # `self`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1347">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1348">
          
          
          <code class="ruby">  # Duplicate nodes (coming from `other_tree`) will **NOT** be overwritten in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1349">
          
          
          <code class="ruby">  # `self`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1350">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1351">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] other_tree The other tree to merge with.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1352">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1353">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The resulting tree following the merge.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1354">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1355">
          
          
          <code class="ruby">  # @raise [TypeError] This exception is raised if `other_tree` is not a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1356">
          
          
          <code class="ruby">  #                    {Fizzy::Tree::Node}.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1357">
          
          
          <code class="ruby">  # @raise [ArgumentError] This exception is raised if `other_tree` does not</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1358">
          
          
          <code class="ruby">  #                        have the same root node as self.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1359">
          <span class="hits">1</span>
          
          <code class="ruby">  def merge(other_tree)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1360">
          
          
          <code class="ruby">    check_merge_prerequisites(other_tree)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1361">
          
          
          <code class="ruby">    new_tree = merge_trees(self.root.dup, other_tree.root)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1362">
          
          
          <code class="ruby">    return new_tree</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1363">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1364">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1365">
          
          
          <code class="ruby">  # Merge in another tree (that shares the same root node) into this tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1366">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1367">
          
          
          <code class="ruby">  # Duplicate nodes (coming from `other_tree`) will **NOT** be overwritten in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1368">
          
          
          <code class="ruby">  # `self`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1369">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1370">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] other_tree The other tree to merge with.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1371">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1372">
          
          
          <code class="ruby">  # @raise [TypeError] This exception is raised if `other_tree` is not a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1373">
          
          
          <code class="ruby">  #                    {Fizzy::Tree::Node}.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1374">
          
          
          <code class="ruby">  # @raise [ArgumentError] This exception is raised if `other_tree` does not</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1375">
          
          
          <code class="ruby">  #                        have the same root node as self.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1376">
          <span class="hits">1</span>
          
          <code class="ruby">  def merge!(other_tree)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1377">
          
          
          <code class="ruby">    check_merge_prerequisites( other_tree )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1378">
          
          
          <code class="ruby">    merge_trees( self.root, other_tree.root )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1379">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1380">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1381">
          
          
          <code class="ruby">  # @!visibility protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1382">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1383">
          
          
          <code class="ruby">  # Utility function to check that the conditions for a tree merge are met.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1384">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1385">
          
          
          <code class="ruby">  # @see #merge</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1386">
          
          
          <code class="ruby">  # @see #merge!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1387">
          <span class="hits">1</span>
          
          <code class="ruby">  def check_merge_prerequisites(other_tree)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1388">
          
          
          <code class="ruby">    unless other_tree.is_a?(Fizzy::Tree::Node)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1389">
          
          
          <code class="ruby">      raise TypeError,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1390">
          
          
          <code class="ruby">        &#39;You can only merge in another instance of Fizzy::Tree::Node&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1391">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1392">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1393">
          
          
          <code class="ruby">    unless self.root.name == other_tree.root.name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1394">
          
          
          <code class="ruby">      raise ArgumentError,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1395">
          
          
          <code class="ruby">        &#39;Unable to merge trees as they do not share the same root&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1396">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1397">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1398">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :check_merge_prerequisites</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1399">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1400">
          
          
          <code class="ruby">  # @!visibility protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1401">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1402">
          
          
          <code class="ruby">  # Utility function to recursivley merge two subtrees.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1403">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1404">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] tree1 The target tree to merge into.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1405">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] tree2 The donor tree (that will be merged</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1406">
          
          
          <code class="ruby">  #                                  into target).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1407">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1408">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The merged tree.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1409">
          <span class="hits">1</span>
          
          <code class="ruby">  def merge_trees(tree1, tree2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1410">
          
          
          <code class="ruby">    names1 = tree1.has_children? ? tree1.children.map { |c| c.name } : []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1411">
          
          
          <code class="ruby">    names2 = tree2.has_children? ? tree2.children.map { |c| c.name } : []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1412">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1413">
          
          
          <code class="ruby">    names_to_merge = names2 - names1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1414">
          
          
          <code class="ruby">    names_to_merge.each do |name|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1415">
          
          
          <code class="ruby">      tree1 &lt;&lt; tree2[name].detached_subtree_copy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1416">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1417">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1418">
          
          
          <code class="ruby">    tree1.children.each do |child|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1419">
          
          
          <code class="ruby">      merge_trees( child, tree2[child.name] ) unless tree2[child.name].nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1420">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1421">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1422">
          
          
          <code class="ruby">    return tree1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1423">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1424">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :merge_trees</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1425">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1426">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1427">
          
          
          <code class="ruby"># ───────────────────────────────────────────── Metrics methods ← tree ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1428">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1429">
          
          
          <code class="ruby"># Provides utility functions to measure various tree metrics.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1430">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Tree::MetricsHandler</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1431">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.included(base)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1432">
          
          
          <code class="ruby">    # @!group Metrics and Measures</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1433">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1434">
          
          
          <code class="ruby">    # @!attribute [r] size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1435">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1436">
          
          
          <code class="ruby">    # Total number of nodes in this (sub)tree, including this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1437">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1438">
          
          
          <code class="ruby">    # Size of the tree is defined as:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1439">
          
          
          <code class="ruby">    # *total number nodes in the subtree including this node.*</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1440">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1441">
          
          
          <code class="ruby">    # @return [Integer] Total number of nodes in this (sub)tree.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1442">
          <span class="hits">1</span>
          
          <code class="ruby">    def size</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1443">
          
          
          <code class="ruby">      inject(0) { |sum, node| sum + 1 if node }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1444">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1445">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1446">
          
          
          <code class="ruby">    # @!attribute [r] node_height</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1447">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1448">
          
          
          <code class="ruby">    # Height of the (sub)tree from this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1449">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1450">
          
          
          <code class="ruby">    # Height of a node is defined as:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1451">
          
          
          <code class="ruby">    # *length of the longest downward path to a leaf from the node.*</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1452">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1453">
          
          
          <code class="ruby">    # - Height from a root node is height of the entire tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1454">
          
          
          <code class="ruby">    # - The height of a leaf node is zero.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1455">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1456">
          
          
          <code class="ruby">    # @return [Integer] Height of the node.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1457">
          <span class="hits">1</span>
          
          <code class="ruby">    def node_height</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1458">
          
          
          <code class="ruby">      return 0 if is_leaf?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1459">
          
          
          <code class="ruby">      1 + @children.collect { |child| child.node_height }.max</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1460">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1461">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1462">
          
          
          <code class="ruby">    # @!attribute [r] node_depth</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1463">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1464">
          
          
          <code class="ruby">    # Depth of this node in its tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1465">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1466">
          
          
          <code class="ruby">    # Depth of a node is defined as:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1467">
          
          
          <code class="ruby">    # *length of the node&#39;s path to its root (depth of a root node is zero).*</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1468">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1469">
          
          
          <code class="ruby">    # {#level} is an alias for this method.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1470">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1471">
          
          
          <code class="ruby">    # @return [Integer] Depth of this node.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1472">
          <span class="hits">1</span>
          
          <code class="ruby">    def node_depth</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1473">
          
          
          <code class="ruby">      return 0 if is_root?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1474">
          
          
          <code class="ruby">      1 + parent.node_depth</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1475">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1476">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1477">
          
          
          <code class="ruby">    # @!attribute [r] level</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1478">
          
          
          <code class="ruby">    # Alias for {#node_depth}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1479">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1480">
          
          
          <code class="ruby">    # @see #node_depth</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1481">
          <span class="hits">1</span>
          
          <code class="ruby">    def level</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1482">
          
          
          <code class="ruby">      node_depth</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1483">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1484">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1485">
          
          
          <code class="ruby">    # @!attribute [r] breadth</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1486">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1487">
          
          
          <code class="ruby">    # Breadth of the tree at this node&#39;s level.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1488">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1489">
          
          
          <code class="ruby">    # A single node without siblings has a breadth of 1.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1490">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1491">
          
          
          <code class="ruby">    # Breadth is defined to be:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1492">
          
          
          <code class="ruby">    # *number of sibling nodes to this node + 1 (this node itself),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1493">
          
          
          <code class="ruby">    # i.e., the number of children the parent of this node has.*</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1494">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1495">
          
          
          <code class="ruby">    # @return [Integer] breadth of the node&#39;s level.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1496">
          <span class="hits">1</span>
          
          <code class="ruby">    def breadth</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1497">
          
          
          <code class="ruby">      is_root? ? 1 : parent.children.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1498">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1499">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1500">
          
          
          <code class="ruby">    # @!attribute [r] in_degree</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1501">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1502">
          
          
          <code class="ruby">    # The incoming edge-count of this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1503">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1504">
          
          
          <code class="ruby">    # In-degree is defined as:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1505">
          
          
          <code class="ruby">    # *number of edges arriving at the node (0 for root, 1 for all other</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1506">
          
          
          <code class="ruby">    # nodes).*</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1507">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1508">
          
          
          <code class="ruby">    # - `in_degree == 0` for a root or orphaned node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1509">
          
          
          <code class="ruby">    # - `in_degree == 1` for a node which has a parent.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1510">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1511">
          
          
          <code class="ruby">    # @return [Integer] The in-degree of this node.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1512">
          <span class="hits">1</span>
          
          <code class="ruby">    def in_degree</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1513">
          
          
          <code class="ruby">      is_root? ? 0 : 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1514">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1515">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1516">
          
          
          <code class="ruby">    # @!attribute [r] out_degree</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1517">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1518">
          
          
          <code class="ruby">    # The outgoing edge-count of this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1519">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1520">
          
          
          <code class="ruby">    # Out-degree is defined as:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1521">
          
          
          <code class="ruby">    # *number of edges leaving the node (zero for leafs).*</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1522">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1523">
          
          
          <code class="ruby">    # @return [Integer] The out-degree of this node.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1524">
          <span class="hits">1</span>
          
          <code class="ruby">    def out_degree</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1525">
          
          
          <code class="ruby">      is_leaf? ? 0 : children.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1526">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1527">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1528">
          
          
          <code class="ruby">    # @!endgroup</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1529">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1530">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1531">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1532">
          
          
          <code class="ruby"># ──────────────────────────────────────────────── Path methods ← tree ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1533">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1534">
          
          
          <code class="ruby"># Provides utility methods for path extraction.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1535">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Tree::PathHandler</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1536">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.included(base)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1537">
          
          
          <code class="ruby">    # @!group Node Path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1538">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1539">
          
          
          <code class="ruby">    # Returns the path of this node from the root as a string, with the node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1540">
          
          
          <code class="ruby">    # names separated using the specified separator. The path is listed left</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1541">
          
          
          <code class="ruby">    # to right from the root node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1542">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1543">
          
          
          <code class="ruby">    # @param separator The optional separator to use. The default separator is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1544">
          
          
          <code class="ruby">    #                  `&quot;=&gt;&quot;`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1545">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1546">
          
          
          <code class="ruby">    # @return [String] The node path with names separated using the specified</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1547">
          
          
          <code class="ruby">    #                  separator.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1548">
          <span class="hits">1</span>
          
          <code class="ruby">    def path_as_string(separator = &quot;=&gt;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1549">
          
          
          <code class="ruby">      path_as_array().join(separator)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1550">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1551">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1552">
          
          
          <code class="ruby">    # Returns the node-names from this node to the root as an array. The first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1553">
          
          
          <code class="ruby">    # element is the root node name, and the last element is this node&#39;s name.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1554">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1555">
          
          
          <code class="ruby">    # @return [Array] The array containing the node names for the path to this</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1556">
          
          
          <code class="ruby">    # node</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1557">
          <span class="hits">1</span>
          
          <code class="ruby">    def path_as_array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1558">
          
          
          <code class="ruby">      get_path_name_array().reverse</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1559">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1560">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1561">
          
          
          <code class="ruby">    # @!visibility protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1562">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1563">
          
          
          <code class="ruby">    # Returns the path names in an array. The first element is the name of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1564">
          
          
          <code class="ruby">    # this node, and the last element is the root node name.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1565">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1566">
          
          
          <code class="ruby">    # @return [Array] An array of the node names for the path from this node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1567">
          
          
          <code class="ruby">    #                 to its root.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1568">
          <span class="hits">1</span>
          
          <code class="ruby">    def get_path_name_array(current_array_path = [])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1569">
          
          
          <code class="ruby">      path_array = current_array_path + [name]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1570">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1571">
          
          
          <code class="ruby">      if !parent              # If detached node or root node.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1572">
          
          
          <code class="ruby">        return path_array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1573">
          
          
          <code class="ruby">      else                    # Else recurse to parent node.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1574">
          
          
          <code class="ruby">        path_array = parent.get_path_name_array(path_array)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1575">
          
          
          <code class="ruby">        return path_array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1576">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1577">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1578">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :get_path_name_array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1579">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1580">
          
          
          <code class="ruby">    # @!endgroup</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1581">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1582">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1583">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1584">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────── Node ← Tree ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1585">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1586">
          
          
          <code class="ruby"># ## Fizzy::Tree::Node Class Description</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1587">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1588">
          
          
          <code class="ruby"># This class models the nodes for an *N-ary* tree data structure. The</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1589">
          
          
          <code class="ruby"># nodes are *named*, and have a place-holder for the node data (i.e.,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1590">
          
          
          <code class="ruby"># *content* of the node).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1591">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1592">
          
          
          <code class="ruby"># @note The node names are required to be *unique* amongst the sibling/peer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1593">
          
          
          <code class="ruby">#       nodes because the node&#39;s name is implicitly used as *ID* within the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1594">
          
          
          <code class="ruby">#       data structure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1595">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1596">
          
          
          <code class="ruby"># The node&#39;s *content* is *not* required to be unique across</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1597">
          
          
          <code class="ruby"># different nodes in the tree, and can be `nil` as well.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1598">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1599">
          
          
          <code class="ruby"># The class provides various methods to navigate the tree, traverse</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1600">
          
          
          <code class="ruby"># the structure, modify contents of the node, change position of the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1601">
          
          
          <code class="ruby"># node in the tree, and to make structural changes to the tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1602">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1603">
          
          
          <code class="ruby"># A node can have any number of *child* nodes attached to it and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1604">
          
          
          <code class="ruby"># hence can be used to create N-ary trees. Access to the child</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1605">
          
          
          <code class="ruby"># nodes can be made *in order* (with the conventional left to right</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1606">
          
          
          <code class="ruby"># access), or *randomly*.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1607">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1608">
          
          
          <code class="ruby"># The node also provides direct access to its *parent* node as well</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1609">
          
          
          <code class="ruby"># as other superior parents in the path to root of the tree.  In</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1610">
          
          
          <code class="ruby"># addition, a node can also access its *sibling* nodes, if present.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1611">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1612">
          
          
          <code class="ruby"># Note that while this implementation does not *explicitly* support</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1613">
          
          
          <code class="ruby"># directed graphs, the class itself makes no restrictions on</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1614">
          
          
          <code class="ruby"># associating a node&#39;s *content* with multiple nodes in the tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1615">
          
          
          <code class="ruby"># However, having duplicate nodes within the structure is likely to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1616">
          
          
          <code class="ruby"># cause unpredictable behavior.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1617">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1618">
          
          
          <code class="ruby"># @example Basic usage</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1619">
          
          
          <code class="ruby">#   # Load the library</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1620">
          
          
          <code class="ruby">#   require &quot;tree&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1621">
          
          
          <code class="ruby">#   # .. Create root node first. Every node has a name and a optional content.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1622">
          
          
          <code class="ruby">#   root_node = Fizzy::Tree::Node.new(&quot;ROOT&quot;, &quot;Root Content&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1623">
          
          
          <code class="ruby">#   root_node.print_tree</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1624">
          
          
          <code class="ruby">#   # .. Now insert the child nodes. You can &quot;chain&quot; the child insertions for a given path to any depth.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1625">
          
          
          <code class="ruby">#   root_node &lt;&lt; Fizzy::Tree::Node.new(&quot;CHILD1&quot;, &quot;Child1 Content&quot;) &lt;&lt; Fizzy::Tree::Node.new(&quot;GRANDCHILD1&quot;, &quot;GrandChild1 Content&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1626">
          
          
          <code class="ruby">#   root_node &lt;&lt; Fizzy::Tree::Node.new(&quot;CHILD2&quot;, &quot;Child2 Content&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1627">
          
          
          <code class="ruby">#   # .. Lets print the representation to stdout. This is primarily used for debugging purposes.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1628">
          
          
          <code class="ruby">#   root_node.print_tree</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1629">
          
          
          <code class="ruby">#   # .. Lets directly access children and grandchildren of the root.  The can be &quot;chained&quot; for a given path to any depth.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1630">
          
          
          <code class="ruby">#   child1       = root_node[&quot;CHILD1&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1631">
          
          
          <code class="ruby">#   grand_child1 = root_node[&quot;CHILD1&quot;][&quot;GRANDCHILD1&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1632">
          
          
          <code class="ruby">#   # .. Now lets retrieve siblings of the current node as an array.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1633">
          
          
          <code class="ruby">#   siblings_of_child1 = child1.siblings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1634">
          
          
          <code class="ruby">#   # .. Lets retrieve immediate children of the root node as an array.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1635">
          
          
          <code class="ruby">#   children_of_root = root_node.children</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1636">
          
          
          <code class="ruby">#   # .. Retrieve the parent of a node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1637">
          
          
          <code class="ruby">#   parent = child1.parent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1638">
          
          
          <code class="ruby">#   # .. This is a depth-first and L-to-R pre-ordered traversal.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1639">
          
          
          <code class="ruby">#   root_node.each { |node| node.content.reverse }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1640">
          
          
          <code class="ruby">#   # .. Lets remove a child node from the root node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1641">
          
          
          <code class="ruby">#   root_node.remove!(child1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1642">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1643">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::Tree::Node</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1644">
          <span class="hits">1</span>
          
          <code class="ruby">  include Enumerable</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1645">
          <span class="hits">1</span>
          
          <code class="ruby">  include Comparable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1646">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1647">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1648">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Tree::MetricsHandler</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1649">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Tree::PathHandler</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1650">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Tree::MergeHandler</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1651">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Tree::HashConverter</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1652">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1653">
          
          
          <code class="ruby">  # @!group Core Attributes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1654">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1655">
          
          
          <code class="ruby">  # @!attribute [r] name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1656">
          
          
          <code class="ruby">  # Name of this node. Expected to be unique within the tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1657">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1658">
          
          
          <code class="ruby">  # @note The name attribute really functions as an *ID* within the tree</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1659">
          
          
          <code class="ruby">  # structure, and hence the uniqueness constraint is required.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1660">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1661">
          
          
          <code class="ruby">  # If you want to change the name, you probably want to call {#rename}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1662">
          
          
          <code class="ruby">  # instead.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1663">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1664">
          
          
          <code class="ruby">  # @see content</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1665">
          
          
          <code class="ruby">  # @see rename</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1666">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1667">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1668">
          
          
          <code class="ruby">  # @!attribute [rw] content</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1669">
          
          
          <code class="ruby">  # Content of this node. Can be `nil`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1670">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1671">
          
          
          <code class="ruby">  # @note There is no uniqueness constraint related to this attribute.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1672">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1673">
          
          
          <code class="ruby">  # @see name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1674">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :content</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1675">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1676">
          
          
          <code class="ruby">  # @!attribute [r] parent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1677">
          
          
          <code class="ruby">  # Parent of this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1678">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1679">
          
          
          <code class="ruby">  # @note Will be `nil` for a root node.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1680">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :parent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1681">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1682">
          
          
          <code class="ruby">  # @!attribute [r] root</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1683">
          
          
          <code class="ruby">  # Root node for the (sub)tree to which this node belongs.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1684">
          
          
          <code class="ruby">  # A root node&#39;s root is itself.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1685">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1686">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] Root of the (sub)tree.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1687">
          <span class="hits">1</span>
          
          <code class="ruby">  def root</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1688">
          
          
          <code class="ruby">    root = self</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1689">
          
          
          <code class="ruby">    root = root.parent while !root.root?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1690">
          
          
          <code class="ruby">    root</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1691">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1692">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1693">
          
          
          <code class="ruby">  # @!attribute [r] root?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1694">
          
          
          <code class="ruby">  # Returns `true` if this is a root node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1695">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1696">
          
          
          <code class="ruby">  # Note that orphaned children will also be reported as root nodes.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1697">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1698">
          
          
          <code class="ruby">  # @return [Boolean] `true` if this is a root node.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1699">
          <span class="hits">1</span>
          
          <code class="ruby">  def root?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1700">
          
          
          <code class="ruby">    @parent.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1701">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1702">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1703">
          
          
          <code class="ruby">  # @!attribute [r] has_content?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1704">
          
          
          <code class="ruby">  # `true` if this node has content.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1705">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1706">
          
          
          <code class="ruby">  # @return [Boolean] `true` if the node has content.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1707">
          <span class="hits">1</span>
          
          <code class="ruby">  def has_content?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1708">
          
          
          <code class="ruby">    @content != nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1709">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1710">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1711">
          
          
          <code class="ruby">  # @!attribute [r] leaf?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1712">
          
          
          <code class="ruby">  # `true` if this node is a `leaf` - i.e., one without any children.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1713">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1714">
          
          
          <code class="ruby">  # @return [Boolean] `true` if this is a leaf node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1715">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1716">
          
          
          <code class="ruby">  # @see #has_children?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1717">
          <span class="hits">1</span>
          
          <code class="ruby">  def leaf?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1718">
          
          
          <code class="ruby">    !has_children?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1719">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1720">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1721">
          
          
          <code class="ruby">  # @!attribute [r] parentage</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1722">
          
          
          <code class="ruby">  # An array of ancestors of this node in reversed order</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1723">
          
          
          <code class="ruby">  # (the first element is the immediate parent of this node).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1724">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1725">
          
          
          <code class="ruby">  # Returns `nil` if this is a root node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1726">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1727">
          
          
          <code class="ruby">  # @return [Array&lt;Fizzy::Tree::Node&gt;] An array of ancestors of this node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1728">
          
          
          <code class="ruby">  # @return [nil] if this is a root node.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1729">
          <span class="hits">1</span>
          
          <code class="ruby">  def parentage</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1730">
          
          
          <code class="ruby">    return nil if root?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1731">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1732">
          
          
          <code class="ruby">    parentage_array = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1733">
          
          
          <code class="ruby">    prev_parent = self.parent</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1734">
          
          
          <code class="ruby">    while (prev_parent)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1735">
          
          
          <code class="ruby">      parentage_array &lt;&lt; prev_parent</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1736">
          
          
          <code class="ruby">      prev_parent = prev_parent.parent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1737">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1738">
          
          
          <code class="ruby">    parentage_array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1739">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1740">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1741">
          
          
          <code class="ruby">  # @!attribute [r] has_children?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1742">
          
          
          <code class="ruby">  # `true` if the this node has any child node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1743">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1744">
          
          
          <code class="ruby">  # @return [Boolean] `true` if child nodes exist.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1745">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1746">
          
          
          <code class="ruby">  # @see #leaf?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1747">
          <span class="hits">1</span>
          
          <code class="ruby">  def has_children?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1748">
          
          
          <code class="ruby">    @children.length != 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1749">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1750">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1751">
          
          
          <code class="ruby">  # @!group Node Creation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1752">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1753">
          
          
          <code class="ruby">  # Creates a new node with a name and optional content.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1754">
          
          
          <code class="ruby">  # The node name is expected to be unique within the tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1755">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1756">
          
          
          <code class="ruby">  # The content can be of any type, and defaults to `nil`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1757">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1758">
          
          
          <code class="ruby">  # @param [Object] name Name of the node. Conventional usage is to pass a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1759">
          
          
          <code class="ruby">  #   String (Integer names may cause *surprises*)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1760">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1761">
          
          
          <code class="ruby">  # @param [Object] content Content of the node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1762">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1763">
          
          
          <code class="ruby">  # @raise [ArgumentError] Raised if the node name is empty.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1764">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1765">
          
          
          <code class="ruby">  # @note If the name is an `Integer`, then the semantics of {#[]} access</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1766">
          
          
          <code class="ruby">  #   method can be surprising, as an `Integer` parameter to that method</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1767">
          
          
          <code class="ruby">  #   normally acts as an index to the children array, and follows the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1768">
          
          
          <code class="ruby">  #   *zero-based* indexing convention.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1769">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1770">
          
          
          <code class="ruby">  # @see #[]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1771">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(name, content = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1772">
          
          
          <code class="ruby">    raise ArgumentError, &quot;Node name HAS to be provided!&quot; if name == nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1773">
          
          
          <code class="ruby">    @name, @content = name, content</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1774">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1775">
          
          
          <code class="ruby">    if name.kind_of?(Integer)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1776">
          
          
          <code class="ruby">      warning &quot;Using integer as node name.&quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1777">
          
          
          <code class="ruby">        &quot; Semantics of TreeNode[] may not be what you expect!&quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1778">
          
          
          <code class="ruby">        &quot; #{name} #{content}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1779">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1780">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1781">
          
          
          <code class="ruby">    self.set_as_root!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1782">
          
          
          <code class="ruby">    @children_hash = Hash.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1783">
          
          
          <code class="ruby">    @children = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1784">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1785">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1786">
          
          
          <code class="ruby">  # Returns a copy of this node, with its parent and children links removed.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1787">
          
          
          <code class="ruby">  # The original node remains attached to its tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1788">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1789">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] A copy of this node.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1790">
          <span class="hits">1</span>
          
          <code class="ruby">  def detached_copy</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1791">
          
          
          <code class="ruby">    self.class.new(@name, @content ? @content.clone : nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1792">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1793">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1794">
          
          
          <code class="ruby">  # Returns a copy of entire (sub-)tree from this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1795">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1796">
          
          
          <code class="ruby">  # @author Vincenzo Farruggia</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1797">
          
          
          <code class="ruby">  # @since 0.8.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1798">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1799">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] A copy of (sub-)tree from this node.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1800">
          <span class="hits">1</span>
          
          <code class="ruby">  def detached_subtree_copy</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1801">
          
          
          <code class="ruby">    new_node = detached_copy</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1802">
          
          
          <code class="ruby">    children { |child| new_node &lt;&lt; child.detached_subtree_copy }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1803">
          
          
          <code class="ruby">    new_node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1804">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1805">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1806">
          
          
          <code class="ruby">  # Alias for {Fizzy::Tree::Node#detached_subtree_copy}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1807">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1808">
          
          
          <code class="ruby">  # @see Fizzy::Tree::Node#detached_subtree_copy</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1809">
          <span class="hits">1</span>
          
          <code class="ruby">  alias :dup :detached_subtree_copy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1810">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1811">
          
          
          <code class="ruby">  # Returns a {marshal-dump}[http://ruby-doc.org/core-1.8.7/Marshal.html]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1812">
          
          
          <code class="ruby">  # represention of the (sub)tree rooted at this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1813">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1814">
          <span class="hits">1</span>
          
          <code class="ruby">  def marshal_dump</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1815">
          
          
          <code class="ruby">    self.collect { |node| node.create_dump_rep }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1816">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1817">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1818">
          
          
          <code class="ruby">  # Creates a dump representation of this node and returns the same as</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1819">
          
          
          <code class="ruby">  # a hash.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1820">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_dump_rep           # :nodoc:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1821">
          
          
          <code class="ruby">    { :name =&gt; @name,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1822">
          
          
          <code class="ruby">      :parent =&gt; (root? ? nil : @parent.name),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1823">
          
          
          <code class="ruby">      :content =&gt; Marshal.dump(@content)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1824">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1825">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1826">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1827">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :create_dump_rep</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1828">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1829">
          
          
          <code class="ruby">  # Loads a marshalled dump of a tree and returns the root node of the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1830">
          
          
          <code class="ruby">  # reconstructed tree. See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1831">
          
          
          <code class="ruby">  # {Marshal}[http://ruby-doc.org/core-1.8.7/Marshal.html] class for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1832">
          
          
          <code class="ruby">  # additional details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1833">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1834">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1835">
          
          
          <code class="ruby">  # @todo This method probably should be a class method. It currently clobbers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1836">
          
          
          <code class="ruby">  #       self and makes itself the root.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1837">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1838">
          <span class="hits">1</span>
          
          <code class="ruby">  def marshal_load(dumped_tree_array)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1839">
          
          
          <code class="ruby">    nodes = { }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1840">
          
          
          <code class="ruby">    dumped_tree_array.each do |node_hash|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1841">
          
          
          <code class="ruby">      name        = node_hash[:name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1842">
          
          
          <code class="ruby">      parent_name = node_hash[:parent]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1843">
          
          
          <code class="ruby">      content     = Marshal.load(node_hash[:content])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1844">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1845">
          
          
          <code class="ruby">      if parent_name then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1846">
          
          
          <code class="ruby">        nodes[name] = current_node = Fizzy::Tree::Node.new(name, content)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1847">
          
          
          <code class="ruby">        nodes[parent_name].add current_node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1848">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1849">
          
          
          <code class="ruby">        # This is the root node, hence initialize self.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1850">
          
          
          <code class="ruby">        initialize(name, content)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1851">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1852">
          
          
          <code class="ruby">        nodes[name] = self    # Add self to the list of nodes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1853">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1854">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1855">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1856">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1857">
          
          
          <code class="ruby">  # @!endgroup</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1858">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1859">
          
          
          <code class="ruby">  # Returns string representation of this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1860">
          
          
          <code class="ruby">  # This method is primarily meant for debugging purposes.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1861">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1862">
          
          
          <code class="ruby">  # @return [String] A string representation of the node.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1863">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1864">
          
          
          <code class="ruby">    &quot;Node Name: #{@name}&quot; +</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1865">
          
          
          <code class="ruby">      &quot; Content: &quot; + (@content.to_s || &quot;&lt;Empty&gt;&quot;) +</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1866">
          
          
          <code class="ruby">      &quot; Parent: &quot; + (root?()  ? &quot;&lt;None&gt;&quot; : @parent.name.to_s) +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1867">
          
          
          <code class="ruby">      &quot; Children: #{@children.length}&quot; +</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1868">
          
          
          <code class="ruby">      &quot; Total Nodes: #{size()}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1869">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1870">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1871">
          
          
          <code class="ruby">  # @!group Structure Modification</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1872">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1873">
          
          
          <code class="ruby">  # Convenience synonym for {Fizzy::Tree::Node#add} method.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1874">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1875">
          
          
          <code class="ruby">  # This method allows an easy mechanism to add node hierarchies to the tree</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1876">
          
          
          <code class="ruby">  # on a given path via chaining the method calls to successive child nodes.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1877">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1878">
          
          
          <code class="ruby">  # @example Add a child and grand-child to the root</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1879">
          
          
          <code class="ruby">  #   root &lt;&lt; child &lt;&lt; grand_child</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1880">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1881">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] child the child node to add.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1882">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1883">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The added child node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1884">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1885">
          
          
          <code class="ruby">  # @see Fizzy::Tree::Node#add</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1886">
          <span class="hits">1</span>
          
          <code class="ruby">  def &lt;&lt;(child)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1887">
          
          
          <code class="ruby">    add(child)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1888">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1889">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1890">
          
          
          <code class="ruby">  # Adds the specified child node to this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1891">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1892">
          
          
          <code class="ruby">  # This method can also be used for *grafting* a subtree into this</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1893">
          
          
          <code class="ruby">  # node&#39;s tree, if the specified child node is the root of a subtree (i.e.,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1894">
          
          
          <code class="ruby">  # has child nodes under it).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1895">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1896">
          
          
          <code class="ruby">  # this node becomes parent of the node passed in as the argument, and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1897">
          
          
          <code class="ruby">  # the child is added as the last child (&quot;right most&quot;) in the current set of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1898">
          
          
          <code class="ruby">  # children of this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1899">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1900">
          
          
          <code class="ruby">  # Additionally you can specify a insert position. The new node will be</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1901">
          
          
          <code class="ruby">  # inserted BEFORE that position. If you don&#39;t specify any position the node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1902">
          
          
          <code class="ruby">  # will be just appended. This feature is provided to make implementation of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1903">
          
          
          <code class="ruby">  # node movement within the tree very simple.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1904">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1905">
          
          
          <code class="ruby">  # If an insertion position is provided, it needs to be within the valid</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1906">
          
          
          <code class="ruby">  # range of:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1907">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1908">
          
          
          <code class="ruby">  #    -children.size..children.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1909">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1910">
          
          
          <code class="ruby">  # This is to prevent `nil` nodes being created as children if a non-existant</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1911">
          
          
          <code class="ruby">  # position is used.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1912">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1913">
          
          
          <code class="ruby">  # If the new node being added has an existing parent node, then it will be</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1914">
          
          
          <code class="ruby">  # removed from this pre-existing parent prior to being added as a child to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1915">
          
          
          <code class="ruby">  # this node. I.e., the child node will effectively be moved from its old</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1916">
          
          
          <code class="ruby">  # parent to this node. In this situation, after the operation is complete,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1917">
          
          
          <code class="ruby">  # the node will no longer exist as a child for its old parent.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1918">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1919">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] child The child node to add.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1920">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1921">
          
          
          <code class="ruby">  # @param [optional, Number] at_index The optional position where the node is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1922">
          
          
          <code class="ruby">  #                                    to be inserted.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1923">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1924">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The added child node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1925">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1926">
          
          
          <code class="ruby">  # @raise [RuntimeError] This exception is raised if another child node with</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1927">
          
          
          <code class="ruby">  #                       the same name exists, or if an invalid insertion</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1928">
          
          
          <code class="ruby">  #                       position is specified.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1929">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1930">
          
          
          <code class="ruby">  # @raise [ArgumentError] This exception is raised if a `nil` node is passed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1931">
          
          
          <code class="ruby">  #                        as the argument.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1932">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1933">
          
          
          <code class="ruby">  # @see #&lt;&lt;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1934">
          <span class="hits">1</span>
          
          <code class="ruby">  def add(child, at_index = -1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1935">
          
          
          <code class="ruby">    # Only handles the immediate child scenario</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1936">
          
          
          <code class="ruby">    raise ArgumentError,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1937">
          
          
          <code class="ruby">      &quot;Attempting to add a nil node&quot; unless child</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1938">
          
          
          <code class="ruby">    raise ArgumentError,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1939">
          
          
          <code class="ruby">      &quot;Attempting add node to itself&quot; if self.equal?(child)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1940">
          
          
          <code class="ruby">    raise ArgumentError,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1941">
          
          
          <code class="ruby">      &quot;Attempting add root as a child&quot; if child.equal?(root)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1942">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1943">
          
          
          <code class="ruby">    # Lazy mans unique test, won&#39;t test if children of child are unique in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1944">
          
          
          <code class="ruby">    # this tree too.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1945">
          
          
          <code class="ruby">    if @children_hash.include?(child.name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1946">
          
          
          <code class="ruby">      raise &quot;Child #{child.name} already added!&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1947">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1948">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1949">
          
          
          <code class="ruby">    child.parent.remove! child if child.parent # Detach from the old parent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1950">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1951">
          
          
          <code class="ruby">    if insertion_range.include?(at_index)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1952">
          
          
          <code class="ruby">      @children.insert(at_index, child)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1953">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1954">
          
          
          <code class="ruby">      raise &quot;Attempting to insert a child at a non-existent location&quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1955">
          
          
          <code class="ruby">        &quot; (#{at_index}) &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1956">
          
          
          <code class="ruby">        &quot;when only positions from &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1957">
          
          
          <code class="ruby">        &quot;#{insertion_range.min} to #{insertion_range.max} exist.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1958">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1959">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1960">
          
          
          <code class="ruby">    @children_hash[child.name]  = child</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1961">
          
          
          <code class="ruby">    child.parent = self</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1962">
          
          
          <code class="ruby">    return child</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1963">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1964">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1965">
          
          
          <code class="ruby">  # Return a range of valid insertion positions.  Used in the #add method.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1966">
          <span class="hits">1</span>
          
          <code class="ruby">  def insertion_range</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1967">
          
          
          <code class="ruby">    max = @children.size</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1968">
          
          
          <code class="ruby">    min = -(max+1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1969">
          
          
          <code class="ruby">    min..max</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1970">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1971">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1972">
          <span class="hits">1</span>
          
          <code class="ruby">  private :insertion_range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1973">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1974">
          
          
          <code class="ruby">  # Renames the node and updates the parent&#39;s reference to it</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1975">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1976">
          
          
          <code class="ruby">  # @param [Object] new_name Name of the node. Conventional usage is to pass a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1977">
          
          
          <code class="ruby">  #                          String (Integer names may cause *surprises*)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1978">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1979">
          
          
          <code class="ruby">  # @return [Object] The old name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1980">
          <span class="hits">1</span>
          
          <code class="ruby">  def rename(new_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1981">
          
          
          <code class="ruby">    old_name = @name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1982">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1983">
          
          
          <code class="ruby">    if root?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1984">
          
          
          <code class="ruby">      self.name=(new_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1985">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1986">
          
          
          <code class="ruby">      @parent.rename_child old_name, new_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1987">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1988">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1989">
          
          
          <code class="ruby">    old_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1990">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1991">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1992">
          
          
          <code class="ruby">  # Renames the specified child node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1993">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1994">
          
          
          <code class="ruby">  # @param [Object] old_name old Name of the node. Conventional usage is to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1995">
          
          
          <code class="ruby">  #                     pass a String (Integer names may cause *surprises*)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1996">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1997">
          
          
          <code class="ruby">  # @param [Object] new_name new Name of the node. Conventional usage is to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1998">
          
          
          <code class="ruby">  #   pass a String (Integer names may cause *surprises*)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1999">
          <span class="hits">1</span>
          
          <code class="ruby">  def rename_child(old_name, new_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2000">
          
          
          <code class="ruby">    unless @children_hash.has_key?(old_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2001">
          
          
          <code class="ruby">      raise ArgumentError, &quot;Invalid child name specified: #{old_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2002">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2003">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2004">
          
          
          <code class="ruby">    @children_hash[new_name] = @children_hash.delete(old_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2005">
          
          
          <code class="ruby">    @children_hash[new_name].name=(new_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2006">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2007">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2008">
          
          
          <code class="ruby">  # Protected method to set the name of this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2009">
          
          
          <code class="ruby">  # This method should *NOT* be invoked by client code.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2010">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2011">
          
          
          <code class="ruby">  # @param [Object] new_name The node Name to set.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2012">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2013">
          
          
          <code class="ruby">  # @return [Object] The new name.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2014">
          <span class="hits">1</span>
          
          <code class="ruby">  def name=(new_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2015">
          
          
          <code class="ruby">    @name = new_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2016">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2017">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2018">
          
          
          <code class="ruby">  # Replaces the specified child node with another child node on this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2019">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2020">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] old_child The child node to be replaced.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2021">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] new_child The child node to be replaced with.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2022">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2023">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The removed child node</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2024">
          <span class="hits">1</span>
          
          <code class="ruby">  def replace!(old_child, new_child)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2025">
          
          
          <code class="ruby">    child_index = @children.find_index(old_child)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2026">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2027">
          
          
          <code class="ruby">    old_child = remove! old_child</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2028">
          
          
          <code class="ruby">    add new_child, child_index</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2029">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2030">
          
          
          <code class="ruby">    return old_child</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2031">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2032">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2033">
          
          
          <code class="ruby">  # Replaces the node with another node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2034">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2035">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] node The node to replace this node with</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2036">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2037">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The replaced child node</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2038">
          <span class="hits">1</span>
          
          <code class="ruby">  def replace_with(node)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2039">
          
          
          <code class="ruby">    @parent.replace!(self, node)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2040">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2041">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2042">
          
          
          <code class="ruby">  # Removes the specified child node from this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2043">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2044">
          
          
          <code class="ruby">  # This method can also be used for *pruning* a sub-tree, in cases where the removed child node is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2045">
          
          
          <code class="ruby">  # the root of the sub-tree to be pruned.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2046">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2047">
          
          
          <code class="ruby">  # The removed child node is orphaned but accessible if an alternate reference exists.  If accessible via</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2048">
          
          
          <code class="ruby">  # an alternate reference, the removed child will report itself as a root node for its sub-tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2049">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2050">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] child The child node to remove.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2051">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2052">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The removed child node, or `nil` if a `nil` was passed in as argument.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2053">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2054">
          
          
          <code class="ruby">  # @see #remove_from_parent!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2055">
          
          
          <code class="ruby">  # @see #remove_all!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2056">
          <span class="hits">1</span>
          
          <code class="ruby">  def remove!(child)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2057">
          
          
          <code class="ruby">    return nil unless child</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2058">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2059">
          
          
          <code class="ruby">    @children_hash.delete(child.name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2060">
          
          
          <code class="ruby">    @children.delete(child)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2061">
          
          
          <code class="ruby">    child.set_as_root!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2062">
          
          
          <code class="ruby">    child</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2063">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2064">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2065">
          
          
          <code class="ruby">  # Protected method to set the parent node for this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2066">
          
          
          <code class="ruby">  # This method should *NOT* be invoked by client code.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2067">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2068">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] parent The parent node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2069">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2070">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The parent node.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2071">
          <span class="hits">1</span>
          
          <code class="ruby">  def parent=(parent)         # :nodoc:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2072">
          
          
          <code class="ruby">    @parent = parent</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2073">
          
          
          <code class="ruby">    @node_depth = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2074">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2075">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2076">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :parent=, :name=</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2077">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2078">
          
          
          <code class="ruby">  # Removes this node from its parent. This node becomes the new root for its</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2079">
          
          
          <code class="ruby">  # subtree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2080">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2081">
          
          
          <code class="ruby">  # If this is the root node, then does nothing.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2082">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2083">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] `self` (the removed node) if the operation is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2084">
          
          
          <code class="ruby">  #                                successful, `nil` otherwise.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2085">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2086">
          
          
          <code class="ruby">  # @see #remove_all!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2087">
          <span class="hits">1</span>
          
          <code class="ruby">  def remove_from_parent!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2088">
          
          
          <code class="ruby">    @parent.remove!(self) unless root?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2089">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2090">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2091">
          
          
          <code class="ruby">  # Removes all children from this node. If an independent reference exists to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2092">
          
          
          <code class="ruby">  # the child nodes, then these child nodes report themselves as roots after</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2093">
          
          
          <code class="ruby">  # this operation.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2094">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2095">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] this node (`self`)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2096">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2097">
          
          
          <code class="ruby">  # @see #remove!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2098">
          
          
          <code class="ruby">  # @see #remove_from_parent!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2099">
          <span class="hits">1</span>
          
          <code class="ruby">  def remove_all!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2100">
          
          
          <code class="ruby">    @children.each { |child| child.set_as_root! }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2102">
          
          
          <code class="ruby">    @children_hash.clear</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2103">
          
          
          <code class="ruby">    @children.clear</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2104">
          
          
          <code class="ruby">    self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2105">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2107">
          
          
          <code class="ruby">  # Protected method which sets this node as a root node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2108">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2109">
          
          
          <code class="ruby">  # @return `nil`.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2110">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_as_root!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2111">
          
          
          <code class="ruby">    self.parent = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2112">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2114">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :set_as_root!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2116">
          
          
          <code class="ruby">  # Freezes all nodes in the (sub)tree rooted at this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2117">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2118">
          
          
          <code class="ruby">  # The nodes become immutable after this operation.  In effect, the entire tree&#39;s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2119">
          
          
          <code class="ruby">  # structure and contents become _read-only_ and cannot be changed.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2120">
          <span class="hits">1</span>
          
          <code class="ruby">  def freeze_tree!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2121">
          
          
          <code class="ruby">    each {|node| node.freeze}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2122">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2124">
          
          
          <code class="ruby">  # @!endgroup</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2126">
          
          
          <code class="ruby">  # @!group Tree Traversal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2128">
          
          
          <code class="ruby">  # Returns the requested node from the set of immediate children.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2129">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2130">
          
          
          <code class="ruby">  # - If the `name` argument is an _Integer_, then the in-sequence</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2131">
          
          
          <code class="ruby">  #   array of children is accessed using the argument as the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2132">
          
          
          <code class="ruby">  #   *index* (zero-based).  However, if the second _optional_</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2133">
          
          
          <code class="ruby">  #   `num_as_name` argument is `true`, then the `name` is used</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2134">
          
          
          <code class="ruby">  #   literally as a name, and *NOT* as an *index*</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2135">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2136">
          
          
          <code class="ruby">  # - If the `name` argument is *NOT* an _Integer_, then it is taken to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2137">
          
          
          <code class="ruby">  #   be the *name* of the child node to be returned.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2138">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2139">
          
          
          <code class="ruby">  # If a non-`Integer` `name` is passed, and the `num_as_name`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2140">
          
          
          <code class="ruby">  # parameter is also `true`, then a warning is thrown (as this is a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2141">
          
          
          <code class="ruby">  # redundant use of the `num_as_name` flag.)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2142">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2143">
          
          
          <code class="ruby">  # @param [String|Number] name_or_index Name of the child, or its</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2144">
          
          
          <code class="ruby">  #   positional index in the array of child nodes.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2145">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2146">
          
          
          <code class="ruby">  # @param [Boolean] num_as_name Whether to treat the `Integer`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2147">
          
          
          <code class="ruby">  #   `name` argument as an actual name, and *NOT* as an _index_ to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2148">
          
          
          <code class="ruby">  #   the children array.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2149">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2150">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] the requested child node.  If the index</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2151">
          
          
          <code class="ruby">  #   in not in range, or the name is not present, then a `nil`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2152">
          
          
          <code class="ruby">  #   is returned.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2153">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2154">
          
          
          <code class="ruby">  # @note The use of `Integer` names is allowed by using the optional</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2155">
          
          
          <code class="ruby">  #       `num_as_name` flag.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2156">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2157">
          
          
          <code class="ruby">  # @raise [ArgumentError] Raised if the `name_or_index` argument is `nil`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2158">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2159">
          
          
          <code class="ruby">  # @see #add</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2160">
          
          
          <code class="ruby">  # @see #initialize</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2161">
          <span class="hits">1</span>
          
          <code class="ruby">  def [](name_or_index, num_as_name=false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2162">
          
          
          <code class="ruby">    raise ArgumentError,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2163">
          
          
          <code class="ruby">      &quot;Name_or_index needs to be provided!&quot; if name_or_index == nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2164">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2165">
          
          
          <code class="ruby">    if name_or_index.kind_of?(Integer) and not num_as_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2166">
          
          
          <code class="ruby">      @children[name_or_index]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2167">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2168">
          
          
          <code class="ruby">      if num_as_name and not name_or_index.kind_of?(Integer)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2169">
          
          
          <code class="ruby">        warn StandardWarning,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2170">
          
          
          <code class="ruby">          &quot;Redundant use of the `num_as_name` flag for non-integer node name&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2171">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2172">
          
          
          <code class="ruby">      @children_hash[name_or_index]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2173">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2174">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2175">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2176">
          
          
          <code class="ruby">  # Traverses each node (including this node) of the (sub)tree rooted at this</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2177">
          
          
          <code class="ruby">  # node by yielding the nodes to the specified block.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2178">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2179">
          
          
          <code class="ruby">  # The traversal is *depth-first* and from *left-to-right* in pre-ordered</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2180">
          
          
          <code class="ruby">  # sequence.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2181">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2182">
          
          
          <code class="ruby">  # @yieldparam node [Fizzy::Tree::Node] Each node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2183">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2184">
          
          
          <code class="ruby">  # @see #preordered_each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2185">
          
          
          <code class="ruby">  # @see #breadth_each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2186">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2187">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] this node, if a block if given</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2188">
          
          
          <code class="ruby">  # @return [Enumerator] an enumerator on this tree, if a block is *not* given</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2189">
          <span class="hits">1</span>
          
          <code class="ruby">  def each(&amp;block)             # :yields: node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2191">
          
          
          <code class="ruby">    return self.to_enum unless block_given?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2193">
          
          
          <code class="ruby">    node_stack = [self]   # Start with this node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2194">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2195">
          
          
          <code class="ruby">    until node_stack.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2196">
          
          
          <code class="ruby">      current = node_stack.shift    # Pop the top-most node</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2197">
          
          
          <code class="ruby">      if current                    # Might be &#39;nil&#39; (esp. for binary trees)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2198">
          
          
          <code class="ruby">        yield current               # and process it</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2199">
          
          
          <code class="ruby">        # Stack children of the current node at top of the stack</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2200">
          
          
          <code class="ruby">        node_stack = current.children.concat(node_stack)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2201">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2202">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2203">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2204">
          
          
          <code class="ruby">    return self if block_given?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2205">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2206">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2207">
          
          
          <code class="ruby">  # Traverses the (sub)tree rooted at this node in pre-ordered sequence.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2208">
          
          
          <code class="ruby">  # This is a synonym of {Fizzy::Tree::Node#each}.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2209">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2210">
          
          
          <code class="ruby">  # @yieldparam node [Fizzy::Tree::Node] Each node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2211">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2212">
          
          
          <code class="ruby">  # @see #each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2213">
          
          
          <code class="ruby">  # @see #breadth_each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2214">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2215">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] this node, if a block if given</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2216">
          
          
          <code class="ruby">  # @return [Enumerator] an enumerator on this tree, if a block is *not* given</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2217">
          <span class="hits">1</span>
          
          <code class="ruby">  def preordered_each(&amp;block)  # :yields: node</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2218">
          
          
          <code class="ruby">    each(&amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2219">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2220">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2221">
          
          
          <code class="ruby">  # Traverses the (sub)tree rooted at this node in post-ordered sequence.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2222">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2223">
          
          
          <code class="ruby">  # @yieldparam node [Fizzy::Tree::Node] Each node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2224">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2225">
          
          
          <code class="ruby">  # @see #preordered_each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2226">
          
          
          <code class="ruby">  # @see #breadth_each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2227">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] this node, if a block if given</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2228">
          
          
          <code class="ruby">  # @return [Enumerator] an enumerator on this tree, if a block is *not* given</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2229">
          <span class="hits">1</span>
          
          <code class="ruby">  def postordered_each(&amp;block)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2230">
          
          
          <code class="ruby">    return self.to_enum(:postordered_each) unless block_given?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2231">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2232">
          
          
          <code class="ruby">    # Using a marked node in order to skip adding the children of nodes that</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2233">
          
          
          <code class="ruby">    # have already been visited. This allows the stack depth to be controlled,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2234">
          
          
          <code class="ruby">    # and also allows stateful backtracking.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2235">
          
          
          <code class="ruby">    markednode = Struct.new(:node, :visited)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2236">
          
          
          <code class="ruby">    node_stack = [markednode.new(self, false)] # Start with self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2237">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2238">
          
          
          <code class="ruby">    until node_stack.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2239">
          
          
          <code class="ruby">      peek_node = node_stack[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2240">
          
          
          <code class="ruby">      if peek_node.node.has_children? and not peek_node.visited</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2241">
          
          
          <code class="ruby">        peek_node.visited = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2242">
          
          
          <code class="ruby">        # Add the children to the stack. Use the marking structure.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2243">
          
          
          <code class="ruby">        marked_children =</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2244">
          
          
          <code class="ruby">          peek_node.node.children.map {|node| markednode.new(node, false)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2245">
          
          
          <code class="ruby">        node_stack = marked_children.concat(node_stack)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2246">
          
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2247">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2248">
          
          
          <code class="ruby">        yield node_stack.shift.node           # Pop and yield the current node</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2249">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2250">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2251">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2252">
          
          
          <code class="ruby">    return self if block_given?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2253">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2254">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2255">
          
          
          <code class="ruby">  # Performs breadth-first traversal of the (sub)tree rooted at this node. The</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2256">
          
          
          <code class="ruby">  # traversal at a given level is from *left-to-right*. this node itself is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2257">
          
          
          <code class="ruby">  # the first node to be traversed.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2258">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2259">
          
          
          <code class="ruby">  # @yieldparam node [Fizzy::Tree::Node] Each node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2260">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2261">
          
          
          <code class="ruby">  # @see #preordered_each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2262">
          
          
          <code class="ruby">  # @see #breadth_each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2263">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2264">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] this node, if a block if given</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2265">
          
          
          <code class="ruby">  # @return [Enumerator] an enumerator on this tree, if a block is *not* given</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2266">
          <span class="hits">1</span>
          
          <code class="ruby">  def breadth_each(&amp;block)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2267">
          
          
          <code class="ruby">    return self.to_enum(:breadth_each) unless block_given?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2268">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2269">
          
          
          <code class="ruby">    node_queue = [self]       # Create a queue with self as the initial entry</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2270">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2271">
          
          
          <code class="ruby">    # Use a queue to do breadth traversal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2272">
          
          
          <code class="ruby">    until node_queue.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2273">
          
          
          <code class="ruby">      node_to_traverse = node_queue.shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2274">
          
          
          <code class="ruby">      yield node_to_traverse</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2275">
          
          
          <code class="ruby">      # Enqueue the children from left to right.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2276">
          
          
          <code class="ruby">      node_to_traverse.children { |child| node_queue.push child }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2277">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2278">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2279">
          
          
          <code class="ruby">    return self if block_given?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2280">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2282">
          
          
          <code class="ruby">  # An array of all the immediate children of this node. The child</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2283">
          
          
          <code class="ruby">  # nodes are ordered &quot;left-to-right&quot; in the returned array.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2284">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2285">
          
          
          <code class="ruby">  # If a block is given, yields each child node to the block</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2286">
          
          
          <code class="ruby">  # traversing from left to right.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2287">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2288">
          
          
          <code class="ruby">  # @yieldparam child [Fizzy::Tree::Node] Each child node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2289">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2290">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] This node, if a block is given</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2291">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2292">
          
          
          <code class="ruby">  # @return [Array&lt;Fizzy::Tree::Node&gt;] An array of the child nodes, if no block</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2293">
          
          
          <code class="ruby">  #                                 is given.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2294">
          <span class="hits">1</span>
          
          <code class="ruby">  def children</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2295">
          
          
          <code class="ruby">    if block_given?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2296">
          
          
          <code class="ruby">      @children.each {|child| yield child}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2297">
          
          
          <code class="ruby">      return self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2298">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2299">
          
          
          <code class="ruby">      return @children.clone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2300">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2301">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2302">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2303">
          
          
          <code class="ruby">  # Yields every leaf node of the (sub)tree rooted at this node to the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2304">
          
          
          <code class="ruby">  # specified block.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2305">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2306">
          
          
          <code class="ruby">  # May yield this node as well if this is a leaf node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2307">
          
          
          <code class="ruby">  # Leaf traversal is *depth-first* and *left-to-right*.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2308">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2309">
          
          
          <code class="ruby">  # @yieldparam node [Fizzy::Tree::Node] Each leaf node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2310">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2311">
          
          
          <code class="ruby">  # @see #each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2312">
          
          
          <code class="ruby">  # @see #breadth_each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2313">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2314">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] this node, if a block if given</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2315">
          
          
          <code class="ruby">  # @return [Array&lt;Fizzy::Tree::Node&gt;] An array of the leaf nodes</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2316">
          <span class="hits">1</span>
          
          <code class="ruby">  def each_leaf &amp;block</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2317">
          
          
          <code class="ruby">    if block_given?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2318">
          
          
          <code class="ruby">      self.each { |node| yield(node) if node.leaf? }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2319">
          
          
          <code class="ruby">      return self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2320">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2321">
          
          
          <code class="ruby">      self.select { |node| node.leaf?}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2322">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2323">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2324">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2325">
          
          
          <code class="ruby">  # @!endgroup</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2326">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2327">
          
          
          <code class="ruby">  # @!group Navigating the Child Nodes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2328">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2329">
          
          
          <code class="ruby">  # First child of this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2330">
          
          
          <code class="ruby">  # Will be `nil` if no children are present.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2331">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2332">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The first child, or `nil` if none is present.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2333">
          <span class="hits">1</span>
          
          <code class="ruby">  def first_child</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2334">
          
          
          <code class="ruby">    children.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2335">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2336">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2337">
          
          
          <code class="ruby">  # Last child of this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2338">
          
          
          <code class="ruby">  # Will be `nil` if no children are present.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2339">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2340">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The last child, or `nil` if none is present.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2341">
          <span class="hits">1</span>
          
          <code class="ruby">  def last_child</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2342">
          
          
          <code class="ruby">    children.last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2343">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2344">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2345">
          
          
          <code class="ruby">  # @!group Navigating the Sibling Nodes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2346">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2347">
          
          
          <code class="ruby">  # First sibling of this node. If this is the root node, then returns</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2348">
          
          
          <code class="ruby">  # itself.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2349">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2350">
          
          
          <code class="ruby">  # &#39;First&#39; sibling is defined as follows:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2351">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2352">
          
          
          <code class="ruby">  # First sibling:: The left-most child of this node&#39;s parent, which may be</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2353">
          
          
          <code class="ruby">  # this node itself</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2354">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2355">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The first sibling node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2356">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2357">
          
          
          <code class="ruby">  # @see #first_sibling?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2358">
          
          
          <code class="ruby">  # @see #last_sibling</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2359">
          <span class="hits">1</span>
          
          <code class="ruby">  def first_sibling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2360">
          
          
          <code class="ruby">    root? ? self : parent.children.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2361">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2362">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2363">
          
          
          <code class="ruby">  # Returns `true` if this node is the first sibling at its level.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2364">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2365">
          
          
          <code class="ruby">  # @return [Boolean] `true` if this is the first sibling.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2366">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2367">
          
          
          <code class="ruby">  # @see #last_sibling?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2368">
          
          
          <code class="ruby">  # @see #first_sibling</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2369">
          <span class="hits">1</span>
          
          <code class="ruby">  def first_sibling?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2370">
          
          
          <code class="ruby">    first_sibling == self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2371">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2372">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2373">
          
          
          <code class="ruby">  # Last sibling of this node.  If this is the root node, then returns</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2374">
          
          
          <code class="ruby">  # itself.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2375">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2376">
          
          
          <code class="ruby">  # &#39;Last&#39; sibling is defined as follows:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2377">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2378">
          
          
          <code class="ruby">  # Last sibling:: The right-most child of this node&#39;s parent, which may be</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2379">
          
          
          <code class="ruby">  # this node itself</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2380">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2381">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] The last sibling node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2382">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2383">
          
          
          <code class="ruby">  # @see #last_sibling?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2384">
          
          
          <code class="ruby">  # @see #first_sibling</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2385">
          <span class="hits">1</span>
          
          <code class="ruby">  def last_sibling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2386">
          
          
          <code class="ruby">    root? ? self : parent.children.last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2387">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2388">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2389">
          
          
          <code class="ruby">  # Returns `true` if this node is the last sibling at its level.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2390">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2391">
          
          
          <code class="ruby">  # @return [Boolean] `true` if this is the last sibling.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2392">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2393">
          
          
          <code class="ruby">  # @see #first_sibling?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2394">
          
          
          <code class="ruby">  # @see #last_sibling</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2395">
          <span class="hits">1</span>
          
          <code class="ruby">  def last_sibling?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2396">
          
          
          <code class="ruby">    last_sibling == self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2397">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2398">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2399">
          
          
          <code class="ruby">  # An array of siblings for this node. This node is excluded.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2400">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2401">
          
          
          <code class="ruby">  # If a block is provided, yields each of the sibling nodes to the block.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2402">
          
          
          <code class="ruby">  # The root always has `nil` siblings.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2403">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2404">
          
          
          <code class="ruby">  # @yieldparam sibling [Fizzy::Tree::Node] Each sibling node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2405">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2406">
          
          
          <code class="ruby">  # @return [Array&lt;Fizzy::Tree::Node&gt;] Array of siblings of this node. Will</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2407">
          
          
          <code class="ruby">  #                                 return an empty array for *root*</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2408">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2409">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] This node, if no block is given</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2410">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2411">
          
          
          <code class="ruby">  # @see #first_sibling</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2412">
          
          
          <code class="ruby">  # @see #last_sibling</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2413">
          <span class="hits">1</span>
          
          <code class="ruby">  def siblings</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2414">
          
          
          <code class="ruby">    if block_given?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2415">
          
          
          <code class="ruby">      parent.children.each { |sibling| yield sibling if sibling != self }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2416">
          
          
          <code class="ruby">      return self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2417">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2418">
          
          
          <code class="ruby">      return [] if root?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2419">
          
          
          <code class="ruby">      siblings = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2420">
          
          
          <code class="ruby">      parent.children {|my_sibling|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2421">
          
          
          <code class="ruby">        siblings &lt;&lt; my_sibling if my_sibling != self}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2422">
          
          
          <code class="ruby">      siblings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2423">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2424">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2425">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2426">
          
          
          <code class="ruby">  # `true` if this node is the only child of its parent.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2427">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2428">
          
          
          <code class="ruby">  # As a special case, a root node will always return `true`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2429">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2430">
          
          
          <code class="ruby">  # @return [Boolean] `true` if this is the only child of its parent.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2431">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2432">
          
          
          <code class="ruby">  # @see #siblings</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2433">
          <span class="hits">1</span>
          
          <code class="ruby">  def only_child?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2434">
          
          
          <code class="ruby">    root? ? true : parent.children.size == 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2435">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2436">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2437">
          
          
          <code class="ruby">  # Next sibling for this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2438">
          
          
          <code class="ruby">  # The _next_ node is defined as the node to right of this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2439">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2440">
          
          
          <code class="ruby">  # Will return `nil` if no subsequent node is present, or if this is a root</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2441">
          
          
          <code class="ruby">  # node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2442">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2443">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] the next sibling node, if present.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2444">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2445">
          
          
          <code class="ruby">  # @see #previous_sibling</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2446">
          
          
          <code class="ruby">  # @see #siblings</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2447">
          <span class="hits">1</span>
          
          <code class="ruby">  def next_sibling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2448">
          
          
          <code class="ruby">    return nil if root?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2449">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2450">
          
          
          <code class="ruby">    myidx = parent.children.index(self)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2451">
          
          
          <code class="ruby">    parent.children.at(myidx + 1) if myidx</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2452">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2453">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2454">
          
          
          <code class="ruby">  # Previous sibling of this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2455">
          
          
          <code class="ruby">  # _Previous_ node is defined to be the node to left of this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2456">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2457">
          
          
          <code class="ruby">  # Will return `nil` if no predecessor node is present, or if this is a root</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2458">
          
          
          <code class="ruby">  # node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2459">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2460">
          
          
          <code class="ruby">  # @return [Fizzy::Tree::Node] the previous sibling node, if present.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2461">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2462">
          
          
          <code class="ruby">  # @see #next_sibling</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2463">
          
          
          <code class="ruby">  # @see #siblings</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2464">
          <span class="hits">1</span>
          
          <code class="ruby">  def previous_sibling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2465">
          
          
          <code class="ruby">    return nil if root?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2466">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2467">
          
          
          <code class="ruby">    myidx = parent.children.index(self)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2468">
          
          
          <code class="ruby">    parent.children.at(myidx - 1) if myidx &amp;&amp; myidx &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2469">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2470">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2471">
          
          
          <code class="ruby">  # @!endgroup</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2472">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2473">
          
          
          <code class="ruby">  # Provides a comparision operation for the nodes.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2474">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2475">
          
          
          <code class="ruby">  # Comparision is based on the natural ordering of the node name objects.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2476">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2477">
          
          
          <code class="ruby">  # @param [Fizzy::Tree::Node] other The other node to compare against.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2478">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2479">
          
          
          <code class="ruby">  # @return [Integer] +1 if this node is a &#39;successor&#39;, 0 if equal and -1 if</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2480">
          
          
          <code class="ruby">  #                   this node is a &#39;predecessor&#39;. Returns &#39;nil&#39; if the other</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2481">
          
          
          <code class="ruby">  #                   object is not a &#39;Fizzy::Tree::Node&#39;.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2482">
          <span class="hits">1</span>
          
          <code class="ruby">  def &lt;=&gt;(other)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2483">
          
          
          <code class="ruby">    return nil if other == nil || other.class != Fizzy::Tree::Node</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2484">
          
          
          <code class="ruby">    self.name &lt;=&gt; other.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2485">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2486">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2487">
          
          
          <code class="ruby">  # Pretty prints the (sub)tree rooted at this node.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2488">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2489">
          
          
          <code class="ruby">  # @param [Integer] level The indentation level (4 spaces) to start with.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2490">
          
          
          <code class="ruby">  # @param [Integer] max_depth optional maximum depth at which the printing</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2491">
          
          
          <code class="ruby">  #                            with stop.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2492">
          
          
          <code class="ruby">  # @param [Proc] block optional block to use for rendering</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2493">
          <span class="hits">1</span>
          
          <code class="ruby">  def print_tree(level = node_depth, max_depth = nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2494">
          
          
          <code class="ruby">                 block = lambda { |node, prefix|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2495">
          
          
          <code class="ruby">    puts &quot;#{prefix} #{node.name}&quot; })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2496">
          
          
          <code class="ruby">    prefix = &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2497">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2498">
          
          
          <code class="ruby">    if root?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2499">
          
          
          <code class="ruby">      prefix &lt;&lt; &#39;*&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2500">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2501">
          
          
          <code class="ruby">      prefix &lt;&lt; &#39;|&#39; unless parent.last_sibling?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2502">
          
          
          <code class="ruby">      prefix &lt;&lt; (&#39; &#39; * (level - 1) * 4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2503">
          
          
          <code class="ruby">      prefix &lt;&lt; (last_sibling? ? &#39;+&#39; : &#39;|&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2504">
          
          
          <code class="ruby">      prefix &lt;&lt; &#39;---&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2505">
          
          
          <code class="ruby">      prefix &lt;&lt; (has_children? ? &#39;+&#39; : &#39;&gt;&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2506">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2507">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2508">
          
          
          <code class="ruby">    block.call(self, prefix)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2509">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2510">
          
          
          <code class="ruby">    # Exit if the max level is defined, and reached.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2511">
          
          
          <code class="ruby">    return unless max_depth.nil? || level &lt; max_depth</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2512">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2513">
          
          
          <code class="ruby">    children do |child|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2514">
          
          
          <code class="ruby">      child.print_tree(level + 1, max_depth, block) if child # Child might be `nil`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2515">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2516">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2517">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2518">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2519">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2520">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────────────── Argparse ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2521">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2522">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::ArgParse</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2523">
          
          
          <code class="ruby">  # ───────────────────────────────────────────────────────────────────── API ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2524">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2525">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.define_command(*args, **kwargs)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2526">
          
          
          <code class="ruby">    Proxy.new.define_command(*args, **kwargs)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2527">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2528">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2529">
          <span class="hits">1</span>
          
          <code class="ruby">  class Proxy</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2530">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :command, :handlers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2531">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2532">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2533">
          
          
          <code class="ruby">      @command = Command.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2534">
          
          
          <code class="ruby">      @handlers = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2535">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2536">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2537">
          <span class="hits">1</span>
          
          <code class="ruby">    def define_command(*args, **kwargs)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2538">
          
          
          <code class="ruby">      command.add_subcommand(*args, **kwargs)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2539">
          
          
          <code class="ruby">      self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2540">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2541">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2542">
          <span class="hits">1</span>
          
          <code class="ruby">    def run(args)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2543">
          
          
          <code class="ruby">      command.run if command.parse(args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2544">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2545">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2546">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2547">
          
          
          <code class="ruby">  # ────────────────────────────────────────────────────────────────────────────</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2548">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2549">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2550">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────── Types ← Argparse ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2551">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2552">
          <span class="hits">1</span>
          
          <code class="ruby">OptionParser.accept(Pathname) do |s,|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2553">
          
          
          <code class="ruby">  begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2554">
          
          
          <code class="ruby">    Pathname.new(s) if s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2555">
          
          
          <code class="ruby">  rescue ArgumentError</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2556">
          
          
          <code class="ruby">    raise OptionParser::InvalidArgument, s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2557">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2558">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2559">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2560">
          
          
          <code class="ruby"># ────────────────────────────────────────── Command parser ← argparse ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2561">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2562">
          
          
          <code class="ruby"># Base class to declare argument parsing for commands.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2563">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2564">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::ArgParse::CommandParser</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2565">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :name, :parser, :options, :handlers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2566">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2567">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2568">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2569">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(name)</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="2570">
          <span class="hits">20</span>
          
          <code class="ruby">    @name = name.to_s</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="2571">
          <span class="hits">20</span>
          
          <code class="ruby">    @options = {}</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="2572">
          <span class="hits">20</span>
          
          <code class="ruby">    @handlers = {}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2573">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2574">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2575">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse(args)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2576">
          <span class="hits">2</span>
          
          <code class="ruby">    args = args.dup</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2577">
          <span class="hits">2</span>
          
          <code class="ruby">    parse!(args)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2578">
          <span class="hits">2</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2579">
          
          
          <code class="ruby">  rescue StandardError =&gt; error</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2580">
          
          
          <code class="ruby">    error(error.to_s.capitalize, exc: nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2581">
          
          
          <code class="ruby">    tell_help</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2582">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2583">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2584">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2585">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse!(args)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2586">
          
          
          <code class="ruby">    error &quot;Abstract method called with: #{args}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2587">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2588">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2589">
          <span class="hits">1</span>
          
          <code class="ruby">  def help</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="2590">
          <span class="hits">3</span>
          
          <code class="ruby">    parser.banner = banner</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="2591">
          <span class="hits">3</span>
          
          <code class="ruby">    parser.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2592">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2593">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2594">
          <span class="hits">1</span>
          
          <code class="ruby">  def tell_help</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2595">
          
          
          <code class="ruby">    tell(help)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2596">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2597">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2598">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2599">
          
          
          <code class="ruby">    &quot;#{self.class.name}(name=#{name})&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2600">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2601">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2602">
          <span class="hits">1</span>
          
          <code class="ruby">  alias to_s inspect</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2603">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2604">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2605">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2606">
          <span class="hits">1</span>
          
          <code class="ruby">  def banner</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2607">
          
          
          <code class="ruby">    error &quot;Abstract method called&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2608">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2609">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2610">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2611">
          
          
          <code class="ruby"># ────────────────────────────────────── Rootcommand parser ← argparse ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2612">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2613">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2614">
          
          
          <code class="ruby"># Error representing an invalid subcommand name has been specified.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2615">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2616">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::ArgParse::InvalidSubCommandName &lt; StandardError</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2617">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2618">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2619">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2620">
          
          
          <code class="ruby">    super(&quot;Invalid sub-command named #{name}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2621">
          
          
          <code class="ruby">    @name = name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2622">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2623">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2624">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2625">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2626">
          
          
          <code class="ruby"># Error representing subcommand name hasn&#39;t been specified.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2627">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2628">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::ArgParse::NoSubCommandName &lt; StandardError</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2629">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2630">
          
          
          <code class="ruby">    super(&quot;No sub-command name given&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2631">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2632">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2633">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2634">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2635">
          
          
          <code class="ruby"># Root command, as a composite of sub-commands and some basic global parameters.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2636">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2637">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::ArgParse::RootCommandParser &lt; Fizzy::ArgParse::CommandParser</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2638">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :subcommand_parsers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2639">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2640">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(name, subcommand_parsers: [])</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2641">
          <span class="hits">1</span>
          
          <code class="ruby">    super(name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2642">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2643">
          <span class="hits">1</span>
          
          <code class="ruby">    @subcommand_parsers = subcommand_parsers</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2644">
          <span class="hits">1</span>
          
          <code class="ruby">    @parser = OptionParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2645">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2646">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2647">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2648">
          
          
          <code class="ruby">  # Register a handler matching command name.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2649">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2650">
          <span class="hits">1</span>
          
          <code class="ruby">  def on_command(command_name, &amp;block)</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="2651">
          <span class="hits">18</span>
          
          <code class="ruby">    handlers[{ regexp: command_name, type: :command_name }] = block</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2652">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2653">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2654">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2655">
          
          
          <code class="ruby">  # Register a handler matching options.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2656">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2657">
          <span class="hits">1</span>
          
          <code class="ruby">  def on_option(opt_name, opt_value = nil, &amp;block)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2658">
          
          
          <code class="ruby">    handlers[{ regexp: opt_name, type: :option_name }] = block</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2659">
          
          
          <code class="ruby">    handlers[{ regexp: opt_value, type: :option_value }] = block if opt_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2660">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2661">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2662">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2663">
          
          
          <code class="ruby">  # Run matching handlers if they match sub-command.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2664">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2665">
          <span class="hits">1</span>
          
          <code class="ruby">  def run</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2666">
          <span class="hits">2</span>
          
          <code class="ruby">    handlers.each do |info, handler|</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="2667">
          <span class="hits">18</span>
          
          <code class="ruby">      matches = matches_options?(info[:type], info[:regexp])</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="2668">
          <span class="hits">18</span>
          
          <code class="ruby">      break if matches &amp;&amp; handler.call(options)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2669">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2670">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2671">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2672">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse!(args)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2673">
          <span class="hits">2</span>
          
          <code class="ruby">    subcommand_name = pop_subcommand_name!(args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2674">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2675">
          <span class="hits">2</span>
          
          <code class="ruby">    subcommand_parser = find_subcommand_parser(subcommand_name)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2676">
          <span class="hits">2</span>
          
          <code class="ruby">    if subcommand_parser.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2677">
          
          
          <code class="ruby">      error(subcommand_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2678">
          
          
          <code class="ruby">            silent: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2679">
          
          
          <code class="ruby">            exc: Fizzy::ArgParse::InvalidSubCommandName)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2680">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2681">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2682">
          <span class="hits">2</span>
          
          <code class="ruby">    parse_subcommand_arguments(subcommand_parser, args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2683">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2684">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2685">
          <span class="hits">1</span>
          
          <code class="ruby">  def help(subcommand_name = nil)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2686">
          <span class="hits">2</span>
          
          <code class="ruby">    subcommand_name ||= options[:command]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2687">
          <span class="hits">2</span>
          
          <code class="ruby">    if subcommand_name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2688">
          <span class="hits">2</span>
          
          <code class="ruby">      find_subcommand_parser(subcommand_name).help</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2689">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2690">
          
          
          <code class="ruby">      super()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2691">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2692">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2693">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2694">
          <span class="hits">1</span>
          
          <code class="ruby">  def tell_help(subcommand_name = nil)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2695">
          <span class="hits">2</span>
          
          <code class="ruby">    tell(help(subcommand_name))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2696">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2697">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2698">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_subcommand_parser(subcommand_parser)</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="2699">
          <span class="hits">18</span>
          
          <code class="ruby">    subcommand_parsers &lt;&lt; subcommand_parser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2700">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2701">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2702">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2703">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2704">
          <span class="hits">1</span>
          
          <code class="ruby">  def banner</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2705">
          
          
          <code class="ruby">    [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2706">
          
          
          <code class="ruby">      &quot;Usage: #{name} #{options[:command] || &quot;[subcommand]&quot;} [options]&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2707">
          
          
          <code class="ruby">      &quot;Available sub-commands: #{subcommand_parsers.map(&amp;:name).join(&quot;, &quot;)}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2708">
          
          
          <code class="ruby">    ].join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2709">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2710">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2711">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2712">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2713">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2714">
          
          
          <code class="ruby">  # Ensures that subcommand name is present in provided `args`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2715">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2716">
          
          
          <code class="ruby">  # If present, it will be removed from `args` and returned.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2717">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2718">
          <span class="hits">1</span>
          
          <code class="ruby">  def pop_subcommand_name!(args)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2719">
          <span class="hits">2</span>
          
          <code class="ruby">    subcommand_name = args.shift</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2720">
          <span class="hits">2</span>
          
          <code class="ruby">    if subcommand_name.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2721">
          
          
          <code class="ruby">      error(nil, silent: true, exc: Fizzy::ArgParse::NoSubCommandName)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2722">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2723">
          <span class="hits">2</span>
          
          <code class="ruby">      subcommand_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2724">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2725">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2726">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2727">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2728">
          
          
          <code class="ruby">  # Check if `regexp` (of provided `type`) matches with the current options.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2729">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2730">
          <span class="hits">1</span>
          
          <code class="ruby">  def matches_options?(type, regexp)</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="2731">
          <span class="hits">18</span>
          
          <code class="ruby">    case type</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2732">
          
          
          <code class="ruby">    when :option_name  then options.any? { |n, _| regexp =~ n }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2733">
          
          
          <code class="ruby">    when :option_value then options.any? { |_, v| regexp =~ v }</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="2734">
          <span class="hits">18</span>
          
          <code class="ruby">    when :command_name then regexp =~ options[:command]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2735">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2736">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2737">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2738">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_subcommand_parser(subcommand_name = nil)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="2739">
          <span class="hits">4</span>
          
          <code class="ruby">    subcommand_name ||= options[:command]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="2740">
          <span class="hits">4</span>
          
          <code class="ruby">    matching_subcommand_parsers =</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2741">
          
          
          <code class="ruby">      subcommand_parsers.select do |c|</code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="2742">
          <span class="hits">54</span>
          
          <code class="ruby">        c.name == subcommand_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2743">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="2744">
          <span class="hits">4</span>
          
          <code class="ruby">    matching_subcommand_parsers.first unless matching_subcommand_parsers.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2745">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2746">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2747">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_subcommand_arguments(subcommand, args)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2748">
          <span class="hits">2</span>
          
          <code class="ruby">    subcommand.parse!(args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2749">
          
          
          <code class="ruby">  ensure</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2750">
          <span class="hits">2</span>
          
          <code class="ruby">    options.deep_merge!(subcommand.options)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2751">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2752">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2753">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2754">
          
          
          <code class="ruby"># ─────────────────────────────────────── Subcommand parser ← argparse ← Misc ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2755">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2756">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2757">
          
          
          <code class="ruby"># Sub-command, thus it cannot be parsed standalone but only as part of a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2758">
          
          
          <code class="ruby"># root-command.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2759">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2760">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::ArgParse::SubCommandParser &lt; Fizzy::ArgParse::CommandParser</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2761">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :desc, :spec</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2762">
          <span class="hits">1</span>
          
          <code class="ruby">  private :spec</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2763">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2764">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(name, desc, spec: {})</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="2765">
          <span class="hits">19</span>
          
          <code class="ruby">    super(name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2766">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="2767">
          <span class="hits">19</span>
          
          <code class="ruby">    @desc = desc.to_s</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="2768">
          <span class="hits">19</span>
          
          <code class="ruby">    @spec = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2769">
          
          
          <code class="ruby">      verbose: { abbrev: &quot;v&quot;, desc: &quot;Run verbosely&quot;, type: :boolean }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2770">
          
          
          <code class="ruby">    }.deep_merge(spec)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2771">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="2772">
          <span class="hits">19</span>
          
          <code class="ruby">    options[:command] = @name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2773">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="2774">
          <span class="hits">38</span>
          
          <code class="ruby">    @parser = OptionParser.new { |opts| fill_opts(opts) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2775">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2776">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2777">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse!(args)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2778">
          <span class="hits">2</span>
          
          <code class="ruby">    parser.banner = banner</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2779">
          <span class="hits">2</span>
          
          <code class="ruby">    parser.parse!(args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2780">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2781">
          <span class="hits">2</span>
          
          <code class="ruby">    missing =</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="2782">
          <span class="hits">4</span>
          
          <code class="ruby">      spec.select { |name, info|  info[:required] &amp;&amp; options[name].nil? }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2783">
          
          
          <code class="ruby">          .map    { |name, _info| name }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2784">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2785">
          <span class="hits">2</span>
          
          <code class="ruby">    return if missing.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2786">
          
          
          <code class="ruby">    raise OptionParser::MissingArgument, missing.join(&quot;, &quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2787">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2788">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2789">
          <span class="hits">1</span>
          
          <code class="ruby">  def help_to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2790">
          
          
          <code class="ruby">    puts &quot;help_to_s&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2791">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2792">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2793">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2794">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2795">
          <span class="hits">1</span>
          
          <code class="ruby">  def banner</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2796">
          
          
          <code class="ruby">    # TODO, replace &quot;fizzy&quot; with rootcommand name (find a way to find</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2797">
          
          
          <code class="ruby">    #       rootcommand from subcommand)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2798">
          
          
          <code class="ruby">    [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2799">
          
          
          <code class="ruby">      &quot;Usage: fizzy #{name} [options]&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2800">
          
          
          <code class="ruby">      desc</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="2801">
          <span class="hits">5</span>
          
          <code class="ruby">    ].join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2802">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2803">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2804">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2805">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2806">
          <span class="hits">1</span>
          
          <code class="ruby">  def fill_opts(opts)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="2807">
          <span class="hits">19</span>
          
          <code class="ruby">    spec.each do |opt_name, opt_info|</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2808">
          <span class="hits">55</span>
          
          <code class="ruby">      opt_info = default_opt_info.merge(opt_info)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2809">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2810">
          <span class="hits">55</span>
          
          <code class="ruby">      opt_args = compute_opt_args(opt_name, opt_info)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2811">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2812">
          <span class="hits">55</span>
          
          <code class="ruby">      options[opt_name] = opt_info[:default] if opt_info[:default]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2813">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="2814">
          <span class="hits">56</span>
          
          <code class="ruby">      opts.on(*opt_args) { |opt_value| options[opt_name] = opt_value }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2815">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2816">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2817">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2818">
          <span class="hits">1</span>
          
          <code class="ruby">  def compute_opt_args(name, info)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2819">
          <span class="hits">55</span>
          
          <code class="ruby">    args = []</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2820">
          <span class="hits">55</span>
          
          <code class="ruby">    args += compute_abbrev_args(info[:abbrev])</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2821">
          <span class="hits">55</span>
          
          <code class="ruby">    args += compute_type_args(name, info[:type], info[:required])</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2822">
          <span class="hits">55</span>
          
          <code class="ruby">    args += compute_desc_args(info[:desc], info[:default], info[:type])</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2823">
          <span class="hits">55</span>
          
          <code class="ruby">    args</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2824">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2825">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2826">
          <span class="hits">1</span>
          
          <code class="ruby">  def compute_abbrev_args(abbrev)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2827">
          <span class="hits">55</span>
          
          <code class="ruby">    args = []</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2828">
          <span class="hits">55</span>
          
          <code class="ruby">    args &lt;&lt; &quot;-#{abbrev}&quot; if abbrev</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2829">
          <span class="hits">55</span>
          
          <code class="ruby">    args</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2830">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2831">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2832">
          <span class="hits">1</span>
          
          <code class="ruby">  def compute_type_args(name, type, req)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2833">
          <span class="hits">55</span>
          
          <code class="ruby">    arg_name = name.to_s.dasherize</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2834">
          <span class="hits">55</span>
          
          <code class="ruby">    args = []</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2835">
          <span class="hits">55</span>
          
          <code class="ruby">    if type == Array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2836">
          
          
          <code class="ruby">      args += [&quot;--#{arg_name} x,y,z&quot;, type]</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2837">
          <span class="hits">55</span>
          
          <code class="ruby">    elsif type == :boolean</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="2838">
          <span class="hits">19</span>
          
          <code class="ruby">      args &lt;&lt; &quot;--[no-]#{arg_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2839">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2840">
          
          
          <code class="ruby">      args &lt;&lt; if req</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="2841">
          <span class="hits">19</span>
          
          <code class="ruby">                &quot;--#{arg_name} #{name.upcase}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2842">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="2843">
          <span class="hits">17</span>
          
          <code class="ruby">                &quot;--#{arg_name} [#{name.upcase}]&quot;</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="2844">
          <span class="hits">36</span>
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="2845">
          <span class="hits">36</span>
          
          <code class="ruby">      args &lt;&lt; type if type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2846">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2847">
          <span class="hits">55</span>
          
          <code class="ruby">    args</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2848">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2849">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2850">
          <span class="hits">1</span>
          
          <code class="ruby">  def compute_desc_args(desc, default, type)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2851">
          <span class="hits">55</span>
          
          <code class="ruby">    full_desc = desc</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2852">
          <span class="hits">55</span>
          
          <code class="ruby">    full_desc &lt;&lt; &quot; (default: #{default})&quot; if default</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2853">
          <span class="hits">55</span>
          
          <code class="ruby">    full_desc &lt;&lt; &quot; (allowed: #{type.join(&quot;, &quot;)})&quot; if type.is_a? Array</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2854">
          <span class="hits">55</span>
          
          <code class="ruby">    [full_desc]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2855">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2856">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2857">
          <span class="hits">1</span>
          
          <code class="ruby">  def default_opt_info</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2858">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2859">
          
          
          <code class="ruby">      required: false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2860">
          
          
          <code class="ruby">      abbrev: nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2861">
          
          
          <code class="ruby">      desc: nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2862">
          
          
          <code class="ruby">      type: nil</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="2863">
          <span class="hits">55</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2864">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2865">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2866">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2867">
          
          
          <code class="ruby"># ────────────────────────────────────────────────────── Base lexer ← Grammar ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2868">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2869">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::BaseLexer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2870">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2871">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2872">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2873">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(string)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2874">
          
          
          <code class="ruby">    @base   = StringScanner.new(string)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2875">
          
          
          <code class="ruby">    @rules  = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2876">
          
          
          <code class="ruby">    @tokens = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2877">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2878">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2879">
          <span class="hits">1</span>
          
          <code class="ruby">  def ignore(pattern)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2880">
          
          
          <code class="ruby">    @rules &lt;&lt; [pattern, [:SKIP]]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2881">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2882">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2883">
          <span class="hits">1</span>
          
          <code class="ruby">  def tokens(patterns, *names)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2884">
          
          
          <code class="ruby">    Array(patterns).map do |pattern|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2885">
          
          
          <code class="ruby">      case pattern</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2886">
          
          
          <code class="ruby">      when Regexp then pattern</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2887">
          
          
          <code class="ruby">      when String then Regexp.new(pattern)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2888">
          
          
          <code class="ruby">      else             Regexp.new(pattern.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2889">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2890">
          
          
          <code class="ruby">    end.each do |pattern|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2891">
          
          
          <code class="ruby">      @rules &lt;&lt; [pattern, names]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2892">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2893">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2894">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2895">
          <span class="hits">1</span>
          
          <code class="ruby">  def token(patterns, name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2896">
          
          
          <code class="ruby">    tokens(patterns, name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2897">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2898">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2899">
          <span class="hits">1</span>
          
          <code class="ruby">  def keyword(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2900">
          
          
          <code class="ruby">    token(Regexp.new(name), name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2901">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2902">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2903">
          <span class="hits">1</span>
          
          <code class="ruby">  def next_token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2904">
          
          
          <code class="ruby">    build_tokens if @tokens.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2905">
          
          
          <code class="ruby">    t = @tokens.shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2906">
          
          
          <code class="ruby">    t.first == :SKIP ? next_token : t</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2907">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2908">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2909">
          <span class="hits">1</span>
          
          <code class="ruby">private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2910">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2911">
          
          
          <code class="ruby">  # (Re)build the list of tokens.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2912">
          
          
          <code class="ruby">  # Every token is: `[value, token_name]`.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2913">
          <span class="hits">1</span>
          
          <code class="ruby">  def build_tokens</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2914">
          
          
          <code class="ruby">    @tokens  = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2915">
          
          
          <code class="ruby">    @tokens += find_tokens until @base.eos?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2916">
          
          
          <code class="ruby">    @tokens &lt;&lt; [false, false] # Last token, meaning EOS.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2917">
          
          
          <code class="ruby">    debug(&quot;Built tokens: `#{@tokens}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2918">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2919">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2920">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_tokens</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2921">
          
          
          <code class="ruby">    @rules.each do |pattern, tokens|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2922">
          
          
          <code class="ruby">      matched_substring = @base.scan(pattern)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2923">
          
          
          <code class="ruby">      unless matched_substring.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2924">
          
          
          <code class="ruby">        if @base[1].nil? # No captures, return the matched string.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2925">
          
          
          <code class="ruby">          error(&quot;Only one token, not `#{tokens.length}` (`#{tokens}`) should &quot; +</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2926">
          
          
          <code class="ruby">                &quot;be provided.&quot;) if tokens.length != 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2927">
          
          
          <code class="ruby">          return [[tokens.first, matched_substring]]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2928">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2929">
          
          
          <code class="ruby">          captures, base_idx = [], 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2930">
          
          
          <code class="ruby">          captures &lt;&lt; @base[base_idx] until @base[base_idx += 1].nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2931">
          
          
          <code class="ruby">          error(&quot;You need to provide `#{captures.length}` tokens, instead of &quot; +</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2932">
          
          
          <code class="ruby">                &quot;`#{tokens.length}`.&quot;) unless captures.length == tokens.length</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2933">
          
          
          <code class="ruby">          return tokens.zip(captures)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2934">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2935">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2936">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2937">
          
          
          <code class="ruby">    error(&quot;Unexpected characters.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2938">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2939">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2940">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2941">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2942">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────────────────────── Lexer ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2943">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2944">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::LogicLexer &lt; Fizzy::BaseLexer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2945">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2946">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(string)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2947">
          
          
          <code class="ruby">    super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2948">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2949">
          
          
          <code class="ruby">    ignore(/\s+/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2950">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2951">
          
          
          <code class="ruby">    token(/=/,    :EQ)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2952">
          
          
          <code class="ruby">    token(/&amp;&amp;/,   :AND)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2953">
          
          
          <code class="ruby">    token(/\|\|/, :OR)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2954">
          
          
          <code class="ruby">    token(/\(/,   :LBRACKET)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2955">
          
          
          <code class="ruby">    token(/\)/,   :RBRACKET)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2956">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2957">
          
          
          <code class="ruby">    tokens(/(f\?)(#{name_with(&quot;-_&quot;)})/,  :FEATURE_PREFIX, :FEATURE_NAME)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2958">
          
          
          <code class="ruby">    tokens(/(v\?)(#{name_with(&quot;-_.&quot;)})/, :VAR_PREFIX,     :VAR_NAME)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2959">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2960">
          
          
          <code class="ruby">    token(/.+/, :VALUE) # Anything that would otherwise not match is a value.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2961">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2962">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2963">
          <span class="hits">1</span>
          
          <code class="ruby">private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2964">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2965">
          <span class="hits">1</span>
          
          <code class="ruby">  def name_with(symbols)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2966">
          
          
          <code class="ruby">    /\w+(?:[#{symbols}]\w+)*/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2967">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2968">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2969">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2970">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2971">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────────────────── Evaluator ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2972">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2973">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::LogicEvaluator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2974">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2975">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2976">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2977">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(receiver)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2978">
          
          
          <code class="ruby">    @receiver = receiver</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2979">
          
          
          <code class="ruby">    @stack    = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2980">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2981">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2982">
          <span class="hits">1</span>
          
          <code class="ruby">  def result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2983">
          
          
          <code class="ruby">    res = @stack.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2984">
          
          
          <code class="ruby">    debug(&quot;Retrieving result from stack `#{@stack}`: `#{res}`.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2985">
          
          
          <code class="ruby">    res</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2986">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2987">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2988">
          <span class="hits">1</span>
          
          <code class="ruby">  def and</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2989">
          
          
          <code class="ruby">    arg1 = @stack.pop</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2990">
          
          
          <code class="ruby">    arg2 = @stack.pop</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2991">
          
          
          <code class="ruby">    result = (arg1 == true) &amp;&amp; (arg2 == true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2992">
          
          
          <code class="ruby">    @stack &lt;&lt; result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2993">
          
          
          <code class="ruby">    debug(&quot;Performed logical `and` between `#{arg1}` and `#{arg2}`, &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2994">
          
          
          <code class="ruby">          &quot;evaluated to `#{result}`.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2995">
          
          
          <code class="ruby">    debug_stack_state</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2996">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2997">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2998">
          <span class="hits">1</span>
          
          <code class="ruby">  def or</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2999">
          
          
          <code class="ruby">    arg1 = @stack.pop</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3000">
          
          
          <code class="ruby">    arg2 = @stack.pop</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3001">
          
          
          <code class="ruby">    result = arg1 == true || arg2 == true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3002">
          
          
          <code class="ruby">    @stack &lt;&lt; result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3003">
          
          
          <code class="ruby">    debug(&quot;Performed logical `or` between `#{arg1}` and `#{arg2}`, &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3004">
          
          
          <code class="ruby">          &quot;evaluated to `#{result}`.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3005">
          
          
          <code class="ruby">    debug_stack_state</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3006">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3007">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3008">
          <span class="hits">1</span>
          
          <code class="ruby">  def has_feature?(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3009">
          
          
          <code class="ruby">    result = @receiver.has_feature?(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3010">
          
          
          <code class="ruby">    @stack &lt;&lt; result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3011">
          
          
          <code class="ruby">    debug(&quot;Parsed feature `#{name}`: it&#39;s #{result ? &quot;&quot; : &quot;not &quot;}available.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3012">
          
          
          <code class="ruby">    debug_stack_state</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3013">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3014">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3015">
          <span class="hits">1</span>
          
          <code class="ruby">  def has_variable?(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3016">
          
          
          <code class="ruby">    var_value = @receiver.get_var(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3017">
          
          
          <code class="ruby">    result = !var_value.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3018">
          
          
          <code class="ruby">    @stack &lt;&lt; result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3019">
          
          
          <code class="ruby">    debug(&quot;Parsed variable `#{name}` with value `#{var_value}`: &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3020">
          
          
          <code class="ruby">          &quot;it&#39;s #{result ? &quot;&quot; : &quot;not &quot;}available.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3021">
          
          
          <code class="ruby">    debug_stack_state</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3022">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3023">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3024">
          <span class="hits">1</span>
          
          <code class="ruby">  def variable_value?(name, expected_value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3025">
          
          
          <code class="ruby">    var_value = @receiver.get_var(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3026">
          
          
          <code class="ruby">    result = var_value == expected_value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3027">
          
          
          <code class="ruby">    @stack &lt;&lt; result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3028">
          
          
          <code class="ruby">    debug(&quot;Parsed variable `#{name}` with value `#{var_value}`: &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3029">
          
          
          <code class="ruby">          &quot;it&#39;s #{result ? &quot;&quot; : &quot;not &quot;}equal to `#{expected_value}`.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3030">
          
          
          <code class="ruby">    debug_stack_state</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3031">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3032">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3033">
          <span class="hits">1</span>
          
          <code class="ruby">  def debug_stack_state</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3034">
          
          
          <code class="ruby">    debug(&quot;Stack state is: `#{@stack}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3035">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3036">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :debug_stack_state</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3037">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3038">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3039">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3040">
          
          
          <code class="ruby"># ────────────────────────────────────────────────────────────── Logic Parser ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3041">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3042">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3043">
          
          
          <code class="ruby"># DO NOT MODIFY!!!!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3044">
          
          
          <code class="ruby"># This file is automatically generated by Racc 1.4.14</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3045">
          
          
          <code class="ruby"># from Racc grammer file &quot;&quot;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3046">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3047">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3048">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;racc/parser.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3049">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3050">
          <span class="hits">1</span>
          
          <code class="ruby">  class LogicParser &lt; Racc::Parser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3051">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3052">
          <span class="hits">1</span>
          
          <code class="ruby">module_eval(&lt;&lt;&#39;...end parser.y/module_eval...&#39;, &#39;parser.y&#39;, 31)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3053">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3054">
          
          
          <code class="ruby">  def parse(receiver, arg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3055">
          
          
          <code class="ruby">    @yydebug = Fizzy::CFG.debug</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3056">
          
          
          <code class="ruby">    @lexer   = Fizzy::LogicLexer.new(arg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3057">
          
          
          <code class="ruby">    @eval    = Fizzy::LogicEvaluator.new(receiver)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3058">
          
          
          <code class="ruby">    do_parse</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3059">
          
          
          <code class="ruby">    @eval.result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3060">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3061">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3062">
          
          
          <code class="ruby">  def next_token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3063">
          
          
          <code class="ruby">    @lexer.next_token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3064">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3065">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3066">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3067">
          
          
          <code class="ruby"># vim: set filetype=racc :</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3068">
          
          
          <code class="ruby">...end parser.y/module_eval...</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3069">
          
          
          <code class="ruby">##### State transition tables begin ###</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3070">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3071">
          <span class="hits">1</span>
          
          <code class="ruby">racc_action_table = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3072">
          
          
          <code class="ruby">     3,     3,     4,     4,     5,     5,     3,     3,     4,     4,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3073">
          
          
          <code class="ruby">     5,     5,     7,     8,     6,    15,     7,     8,    10,    11,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3074">
          
          
          <code class="ruby">    12,    16,     7,    17 ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3075">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3076">
          <span class="hits">1</span>
          
          <code class="ruby">racc_action_check = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3077">
          
          
          <code class="ruby">     0,     3,     0,     3,     0,     3,     7,     8,     7,     8,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3078">
          
          
          <code class="ruby">     7,     8,     9,     9,     1,     9,     2,     2,     4,     5,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3079">
          
          
          <code class="ruby">     6,    11,    14,    16 ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3080">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3081">
          <span class="hits">1</span>
          
          <code class="ruby">racc_action_pointer = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3082">
          
          
          <code class="ruby">    -5,    14,    13,    -4,    10,     9,    20,     1,     2,     9,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3083">
          
          
          <code class="ruby">   nil,    19,   nil,   nil,    19,   nil,    12,   nil ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3084">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3085">
          <span class="hits">1</span>
          
          <code class="ruby">racc_action_default = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3086">
          
          
          <code class="ruby">    -8,    -8,    -1,    -8,    -8,    -8,    -8,    -8,    -8,    -8,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3087">
          
          
          <code class="ruby">    -5,    -6,    18,    -3,    -4,    -2,    -8,    -7 ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3088">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3089">
          <span class="hits">1</span>
          
          <code class="ruby">racc_goto_table = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3090">
          
          
          <code class="ruby">     2,     1,   nil,     9,   nil,   nil,   nil,    13,    14 ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3091">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3092">
          <span class="hits">1</span>
          
          <code class="ruby">racc_goto_check = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3093">
          
          
          <code class="ruby">     2,     1,   nil,     2,   nil,   nil,   nil,     2,     2 ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3094">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3095">
          <span class="hits">1</span>
          
          <code class="ruby">racc_goto_pointer = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3096">
          
          
          <code class="ruby">   nil,     1,     0 ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3097">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3098">
          <span class="hits">1</span>
          
          <code class="ruby">racc_goto_default = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3099">
          
          
          <code class="ruby">   nil,   nil,   nil ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3101">
          <span class="hits">1</span>
          
          <code class="ruby">racc_reduce_table = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3102">
          
          
          <code class="ruby">  0, 0, :racc_error,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3103">
          
          
          <code class="ruby">  1, 13, :_reduce_none,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3104">
          
          
          <code class="ruby">  3, 14, :_reduce_none,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3105">
          
          
          <code class="ruby">  3, 14, :_reduce_3,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3106">
          
          
          <code class="ruby">  3, 14, :_reduce_4,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3107">
          
          
          <code class="ruby">  2, 14, :_reduce_5,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3108">
          
          
          <code class="ruby">  2, 14, :_reduce_6,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3109">
          
          
          <code class="ruby">  4, 14, :_reduce_7 ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3111">
          <span class="hits">1</span>
          
          <code class="ruby">racc_reduce_n = 8</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3113">
          <span class="hits">1</span>
          
          <code class="ruby">racc_shift_n = 18</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3114">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3115">
          <span class="hits">1</span>
          
          <code class="ruby">racc_token_table = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3116">
          
          
          <code class="ruby">  false =&gt; 0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3117">
          
          
          <code class="ruby">  :error =&gt; 1,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3118">
          
          
          <code class="ruby">  :EQ =&gt; 2,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3119">
          
          
          <code class="ruby">  :AND =&gt; 3,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3120">
          
          
          <code class="ruby">  :OR =&gt; 4,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3121">
          
          
          <code class="ruby">  :LBRACKET =&gt; 5,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3122">
          
          
          <code class="ruby">  :RBRACKET =&gt; 6,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3123">
          
          
          <code class="ruby">  :FEATURE_PREFIX =&gt; 7,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3124">
          
          
          <code class="ruby">  :FEATURE_NAME =&gt; 8,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3125">
          
          
          <code class="ruby">  :VAR_PREFIX =&gt; 9,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3126">
          
          
          <code class="ruby">  :VAR_NAME =&gt; 10,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3127">
          
          
          <code class="ruby">  :VALUE =&gt; 11 }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3128">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3129">
          <span class="hits">1</span>
          
          <code class="ruby">racc_nt_base = 12</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3131">
          <span class="hits">1</span>
          
          <code class="ruby">racc_use_result_var = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3133">
          <span class="hits">1</span>
          
          <code class="ruby">Racc_arg = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3134">
          
          
          <code class="ruby">  racc_action_table,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3135">
          
          
          <code class="ruby">  racc_action_check,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3136">
          
          
          <code class="ruby">  racc_action_default,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3137">
          
          
          <code class="ruby">  racc_action_pointer,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3138">
          
          
          <code class="ruby">  racc_goto_table,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3139">
          
          
          <code class="ruby">  racc_goto_check,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3140">
          
          
          <code class="ruby">  racc_goto_default,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3141">
          
          
          <code class="ruby">  racc_goto_pointer,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3142">
          
          
          <code class="ruby">  racc_nt_base,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3143">
          
          
          <code class="ruby">  racc_reduce_table,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3144">
          
          
          <code class="ruby">  racc_token_table,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3145">
          
          
          <code class="ruby">  racc_shift_n,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3146">
          
          
          <code class="ruby">  racc_reduce_n,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3147">
          
          
          <code class="ruby">  racc_use_result_var ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3149">
          <span class="hits">1</span>
          
          <code class="ruby">Racc_token_to_s_table = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3150">
          
          
          <code class="ruby">  &quot;$end&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3151">
          
          
          <code class="ruby">  &quot;error&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3152">
          
          
          <code class="ruby">  &quot;EQ&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3153">
          
          
          <code class="ruby">  &quot;AND&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3154">
          
          
          <code class="ruby">  &quot;OR&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3155">
          
          
          <code class="ruby">  &quot;LBRACKET&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3156">
          
          
          <code class="ruby">  &quot;RBRACKET&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3157">
          
          
          <code class="ruby">  &quot;FEATURE_PREFIX&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3158">
          
          
          <code class="ruby">  &quot;FEATURE_NAME&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3159">
          
          
          <code class="ruby">  &quot;VAR_PREFIX&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3160">
          
          
          <code class="ruby">  &quot;VAR_NAME&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3161">
          
          
          <code class="ruby">  &quot;VALUE&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3162">
          
          
          <code class="ruby">  &quot;$start&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3163">
          
          
          <code class="ruby">  &quot;target&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3164">
          
          
          <code class="ruby">  &quot;exp&quot; ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3165">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3166">
          <span class="hits">1</span>
          
          <code class="ruby">Racc_debug_parser = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3167">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3168">
          
          
          <code class="ruby">##### State transition tables end #####</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3169">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3170">
          
          
          <code class="ruby"># reduce 0 omitted</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3171">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3172">
          
          
          <code class="ruby"># reduce 1 omitted</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3173">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3174">
          
          
          <code class="ruby"># reduce 2 omitted</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3175">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3176">
          <span class="hits">1</span>
          
          <code class="ruby">module_eval(&lt;&lt;&#39;.,.,&#39;, &#39;parser.y&#39;, 20)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3177">
          
          
          <code class="ruby">  def _reduce_3(val, _values, result)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3178">
          
          
          <code class="ruby">     @eval.and </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3179">
          
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3180">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3181">
          
          
          <code class="ruby">.,.,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3183">
          <span class="hits">1</span>
          
          <code class="ruby">module_eval(&lt;&lt;&#39;.,.,&#39;, &#39;parser.y&#39;, 21)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3184">
          
          
          <code class="ruby">  def _reduce_4(val, _values, result)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3185">
          
          
          <code class="ruby">     @eval.or  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3186">
          
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3187">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3188">
          
          
          <code class="ruby">.,.,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3190">
          <span class="hits">1</span>
          
          <code class="ruby">module_eval(&lt;&lt;&#39;.,.,&#39;, &#39;parser.y&#39;, 23)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3191">
          
          
          <code class="ruby">  def _reduce_5(val, _values, result)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3192">
          
          
          <code class="ruby">     @eval.has_feature?(val[1])            </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3193">
          
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3194">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3195">
          
          
          <code class="ruby">.,.,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3196">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3197">
          <span class="hits">1</span>
          
          <code class="ruby">module_eval(&lt;&lt;&#39;.,.,&#39;, &#39;parser.y&#39;, 24)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3198">
          
          
          <code class="ruby">  def _reduce_6(val, _values, result)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3199">
          
          
          <code class="ruby">     @eval.has_variable?(val[1])           </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3200">
          
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3201">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3202">
          
          
          <code class="ruby">.,.,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3203">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3204">
          <span class="hits">1</span>
          
          <code class="ruby">module_eval(&lt;&lt;&#39;.,.,&#39;, &#39;parser.y&#39;, 25)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3205">
          
          
          <code class="ruby">  def _reduce_7(val, _values, result)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3206">
          
          
          <code class="ruby">     @eval.variable_value?(val[1], val[3]) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3207">
          
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3208">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3209">
          
          
          <code class="ruby">.,.,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3211">
          <span class="hits">1</span>
          
          <code class="ruby">def _reduce_none(val, _values, result)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3212">
          
          
          <code class="ruby">  val[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3213">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3214">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3215">
          
          
          <code class="ruby">  end   # class LogicParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3216">
          
          
          <code class="ruby">  end   # module Fizzy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3218">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────── Environment ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3219">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3220">
          
          
          <code class="ruby"># Utilities to retrieve informations about the host environment &amp; system.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3221">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3222">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Environment</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3223">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3224">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3225">
          
          
          <code class="ruby">  # Find an executable called `name` in the `$PATH`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3226">
          
          
          <code class="ruby">  # Note: `name` can also be a path pointing to the executable.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3227">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3228">
          <span class="hits">1</span>
          
          <code class="ruby">  def which?(_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3229">
          
          
          <code class="ruby">    exts = ENV[&quot;PATHEXT&quot;] ? ENV[&quot;PATHEXT&quot;].split(&quot;;&quot;) : [&quot;&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3230">
          
          
          <code class="ruby">    ENV[&quot;PATH&quot;].split(File::PATH_SEPARATOR).each do |path|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3231">
          
          
          <code class="ruby">      exts.each do |ext|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3232">
          
          
          <code class="ruby">        exe = File.join(path, &quot;#{cmd}#{ext}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3233">
          
          
          <code class="ruby">        return exe if File.executable?(exe) &amp;&amp; !File.directory?(exe)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3234">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3235">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3236">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3237">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3239">
          
          
          <code class="ruby">  # Return the environment variable matching the provided `name`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3240">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3241">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_env(name, default: nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3242">
          
          
          <code class="ruby">    ENV[name.to_s] || default</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3243">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3244">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3245">
          
          
          <code class="ruby">  # Same of `get_env`, but raise an error if the environment variable hasn&#39;t</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3246">
          
          
          <code class="ruby">  # been found or is `nil`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3247">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3248">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_env!(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3249">
          
          
          <code class="ruby">    value = get_env(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3250">
          
          
          <code class="ruby">    error(&quot;Undefined environment variable: `#{name}`.&quot;) if value.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3251">
          
          
          <code class="ruby">    value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3252">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3253">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3254">
          
          
          <code class="ruby">  # Check if the underlying operating system is MacOSX.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3255">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3256">
          <span class="hits">1</span>
          
          <code class="ruby">  def osx?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3257">
          
          
          <code class="ruby">    Fizzy::CFG.os == :osx</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3258">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3259">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3260">
          
          
          <code class="ruby">  # Check if the underlying operating system is GNU/Linux.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3261">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3262">
          <span class="hits">1</span>
          
          <code class="ruby">  def linux?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3263">
          
          
          <code class="ruby">    Fizzy::CFG.os == :linux</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3264">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3265">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3266">
          
          
          <code class="ruby">  # Check if the underlying operating system is Windows.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3267">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3268">
          <span class="hits">1</span>
          
          <code class="ruby">  def windows?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3269">
          
          
          <code class="ruby">    Fizzy::CFG.os == :windows</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3270">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3271">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3272">
          
          
          <code class="ruby">  # Execute a function, based on the underlying operating system.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3273">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3274">
          <span class="hits">1</span>
          
          <code class="ruby">  def case_os(osx: nil, linux: nil, windows: nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3275">
          
          
          <code class="ruby">    if osx?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3276">
          
          
          <code class="ruby">      osx.respond_to?(:call) ? osx.call : osx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3277">
          
          
          <code class="ruby">    elsif linux?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3278">
          
          
          <code class="ruby">      linux.respond_to?(:call) ? linux.call : linux</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3279">
          
          
          <code class="ruby">    elsif windows?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3280">
          
          
          <code class="ruby">      windows.respond_to?(:call) ? windows.call : windows</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3281">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3282">
          
          
          <code class="ruby">      error(&quot;Unrecognized operating system.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3283">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3284">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3285">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3286">
          <span class="hits">1</span>
          
          <code class="ruby">  def xdg_config_home(name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3287">
          
          
          <code class="ruby">    Pathname.new(get_env(:XDG_CONFIG_HOME) || &quot;~/.config&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3288">
          
          
          <code class="ruby">            .expand_variables</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3289">
          
          
          <code class="ruby">            .expand_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3290">
          
          
          <code class="ruby">            .join(name.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3291">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3292">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3293">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3294">
          
          
          <code class="ruby"># ────────────────────────────────────────────────────────── Execution ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3295">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3296">
          
          
          <code class="ruby"># Utilities to start and manage programs execution.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3297">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3298">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Execution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3299">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3300">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3301">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3302">
          
          
          <code class="ruby">  # Execute the provided shell command (`cmd`).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3303">
          
          
          <code class="ruby">  # If `as_su` is `true` the command is executed as super user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3304">
          
          
          <code class="ruby">  # (i.e. as root, using sudo).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3305">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3306">
          <span class="hits">1</span>
          
          <code class="ruby">  def exec_cmd(cmd, as_su: false, chdir: nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3307">
          
          
          <code class="ruby">    cmd = cmd.map(&amp;:to_s).map(&amp;:shell_escape).join(&quot; &quot;) if cmd.is_a?(Array)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3309">
          
          
          <code class="ruby">    full_cmd = as_su ? &quot;sudo #{cmd}&quot; : cmd</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3310">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3311">
          
          
          <code class="ruby">    run_mode = defined?(@run_mode) ? @run_mode : :normal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3312">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3313">
          
          
          <code class="ruby">    really_run = case run_mode</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3314">
          
          
          <code class="ruby">                   when :normal then true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3315">
          
          
          <code class="ruby">                   when :paranoid</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3316">
          
          
          <code class="ruby">                     ask(&quot;Do you want to run command `#{full_cmd}`&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3317">
          
          
          <code class="ruby">                   when :dry then false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3318">
          
          
          <code class="ruby">                   else true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3319">
          
          
          <code class="ruby">                 end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3320">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3321">
          
          
          <code class="ruby">    if really_run || run_mode == :dry</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3322">
          
          
          <code class="ruby">      tell(as_su ? &quot;{m{[sudo]}} #{cmd}&quot; : cmd)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3323">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3324">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3325">
          
          
          <code class="ruby">    status = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3326">
          
          
          <code class="ruby">    if really_run</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3327">
          
          
          <code class="ruby">      if chdir</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3328">
          
          
          <code class="ruby">        FileUtils.cd(chdir) do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3329">
          
          
          <code class="ruby">          status = system(full_cmd)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3330">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3331">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3332">
          
          
          <code class="ruby">        status = system(full_cmd)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3333">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3334">
          
          
          <code class="ruby">      warning(&quot;Command `#{full_cmd}` failed.&quot;) unless status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3335">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3336">
          
          
          <code class="ruby">    status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3337">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3338">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3339">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3340">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3341">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────────── Filesystem ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3342">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3343">
          
          
          <code class="ruby"># Utilities to interact with the filesystem.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3344">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3345">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Filesystem</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3346">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3347">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Execution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3348">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3349">
          
          
          <code class="ruby">  # Find a YAML file prefixed by `path` (guess extension name).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3350">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3351">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_yaml_path(path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3352">
          
          
          <code class="ruby">    if path.file?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3353">
          
          
          <code class="ruby">      path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3354">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3355">
          
          
          <code class="ruby">      %w[yml yaml].map do |ext|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3356">
          
          
          <code class="ruby">        p = Pathname.new(&quot;#{path}.#{ext}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3357">
          
          
          <code class="ruby">        p if p.file?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3358">
          
          
          <code class="ruby">      end.compact.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3359">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3360">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3361">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3362">
          
          
          <code class="ruby">  # Check if the provided `path` is an existing directory.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3363">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3364">
          
          
          <code class="ruby">  # If `writable` is true, also check if `path` points to a writable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3365">
          
          
          <code class="ruby">  # directory.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3366">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3367">
          <span class="hits">1</span>
          
          <code class="ruby">  def existing_dir(path, writable: true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3368">
          
          
          <code class="ruby">    dir_path = path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3369">
          
          
          <code class="ruby">    dir_path = dir_path.dirname until dir_path.directory?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3370">
          
          
          <code class="ruby">    writable &amp;&amp; !dir_path.writable? ? nil : dir_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3371">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3372">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3373">
          
          
          <code class="ruby">  # Return an object (`OpenStruct`), which contains all of the well-known</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3374">
          
          
          <code class="ruby">  # paths.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3375">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3376">
          
          
          <code class="ruby">  # Before adding a path, some validations are executed to ensure that path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3377">
          
          
          <code class="ruby">  # points to a correct thing.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3378">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3379">
          
          
          <code class="ruby">  # You can skip some validations and filling some paths:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3380">
          
          
          <code class="ruby">  # - `valid_cfg`:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3381">
          
          
          <code class="ruby">  #   - If `false` don&#39;t validate and fill paths related to the configuration.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3382">
          
          
          <code class="ruby">  #   - If `readonly`, don&#39;t validate writability for configuration.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3383">
          
          
          <code class="ruby">  # - `valid_inst`:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3384">
          
          
          <code class="ruby">  #   - If `false` don&#39;t validate and fill paths related to the configuration</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3385">
          
          
          <code class="ruby">  #     instances.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3386">
          
          
          <code class="ruby">  #   - If `true`, be sure to provide the argument `cur_inst_name`, which</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3387">
          
          
          <code class="ruby">  #     should contain the name of the current instance (the instance that</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3388">
          
          
          <code class="ruby">  #     should be used).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3389">
          
          
          <code class="ruby">  #   - If `readonly`, don&#39;t validate writability for instance.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3390">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3391">
          <span class="hits">1</span>
          
          <code class="ruby">  def prepare_storage(root_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3392">
          
          
          <code class="ruby">                      valid_meta: true, valid_cfg: true, valid_inst: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3393">
          
          
          <code class="ruby">                      meta_name: nil, cur_cfg_name: nil, cur_inst_name: nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3394">
          
          
          <code class="ruby">    root_path = Pathname.new(root_path).expand_variables.expand_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3395">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3396">
          
          
          <code class="ruby">    # Paths based on internal conventions.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3397">
          
          
          <code class="ruby">    parent_path = root_path.dirname</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3398">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3399">
          
          
          <code class="ruby">    cfg_path = root_path.join(&quot;cfg&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3400">
          
          
          <code class="ruby">    cur_cfg_path = cfg_path.join(cur_cfg_name) if cur_cfg_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3401">
          
          
          <code class="ruby">    cur_cfg_vars_path = cur_cfg_path.join(&quot;vars&quot;) if cur_cfg_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3402">
          
          
          <code class="ruby">    cur_cfg_elems_path = cur_cfg_path.join(&quot;elems&quot;) if cur_cfg_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3403">
          
          
          <code class="ruby">    cur_cfg_meta_path = find_yaml_path(cur_cfg_path.join(meta_name)) if cur_cfg_path &amp;&amp; meta_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3404">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3405">
          
          
          <code class="ruby">    inst_path = root_path.join(&quot;inst&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3406">
          
          
          <code class="ruby">    cur_inst_path = inst_path.join(cur_inst_name) if cur_inst_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3407">
          
          
          <code class="ruby">    cur_inst_vars_path = cur_inst_path.join(&quot;vars&quot;) if cur_inst_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3408">
          
          
          <code class="ruby">    cur_inst_elems_path = cur_inst_path.join(&quot;elems&quot;) if cur_inst_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3409">
          
          
          <code class="ruby">    cur_inst_meta_path = find_yaml_path(cur_inst_path.join(meta_name)) if cur_inst_path &amp;&amp; meta_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3410">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3411">
          
          
          <code class="ruby">    # Validate `root_path`.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3412">
          
          
          <code class="ruby">    if !root_path.directory? &amp;&amp; !parent_path.writable?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3413">
          
          
          <code class="ruby">      error(&quot;Cannot create directory: `#{root_path}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3414">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3415">
          
          
          <code class="ruby">    if root_path.file?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3416">
          
          
          <code class="ruby">      if ask(&quot;`#{root_path}` already exists but is a regular file. Remove&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3417">
          
          
          <code class="ruby">        exec_cmd(&quot;rm #{root_path.shell_escape}&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3418">
          
          
          <code class="ruby">                 as_su: File.owned?(root_path))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3419">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3420">
          
          
          <code class="ruby">        error(&quot;File `#{root_path}` already exists but is needed as fizzy &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3421">
          
          
          <code class="ruby">              &quot;root directory. Aborting.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3422">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3423">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3424">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3425">
          
          
          <code class="ruby">    # XXX: This check is for preventing errors when we don&#39;t want to create the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3426">
          
          
          <code class="ruby">    #      directory structure. Should we add a dedicate argument?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3427">
          
          
          <code class="ruby">    if !valid_cfg &amp;&amp; !valid_inst &amp;&amp; root_path.directory? &amp;&amp; !root_path.writable?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3428">
          
          
          <code class="ruby">      error(&quot;No write permissions in Fizzy storage at path `#{root_path}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3429">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3430">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3431">
          
          
          <code class="ruby">    if valid_cfg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3432">
          
          
          <code class="ruby">      unless root_path.directory?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3433">
          
          
          <code class="ruby">        error(&quot;The Fizzy root directory `#{root_path}` doesn&#39;t exist &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3434">
          
          
          <code class="ruby">              &quot;(maybe you need to run: `fizzy cfg sync`).&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3435">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3436">
          
          
          <code class="ruby">      if cur_cfg_path.nil? ||</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3437">
          
          
          <code class="ruby">         !cur_cfg_path.directory? ||</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3438">
          
          
          <code class="ruby">         !(valid_cfg == :readonly || cur_cfg_path.writable?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3439">
          
          
          <code class="ruby">        error(&quot;The current configuration `#{cur_cfg_name}` is invalid: &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3440">
          
          
          <code class="ruby">              &quot;it&#39;s not a valid directory.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3441">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3442">
          
          
          <code class="ruby">      if valid_meta &amp;&amp; (cur_cfg_meta_path.nil? || !cur_cfg_meta_path.file?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3443">
          
          
          <code class="ruby">        error(&quot;The meta file path `#{cur_cfg_meta_path}` is invalid.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3444">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3445">
          
          
          <code class="ruby">      if cur_cfg_vars_path.nil? || !cur_cfg_vars_path.directory?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3446">
          
          
          <code class="ruby">        error(&quot;The variables directory `#{cur_cfg_vars_path}` is invalid.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3447">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3448">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3449">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3450">
          
          
          <code class="ruby">    if valid_inst</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3451">
          
          
          <code class="ruby">      unless root_path.directory?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3452">
          
          
          <code class="ruby">        error(&quot;The Fizzy root directory `#{root_path}` doesn&#39;t exist &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3453">
          
          
          <code class="ruby">              &quot;(maybe you need to run: `fizzy cfg sync`).&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3454">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3455">
          
          
          <code class="ruby">      if cur_inst_path.nil? || !cur_inst_path.directory? || !(valid_inst == :readonly || cur_inst_path.writable?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3456">
          
          
          <code class="ruby">        error(&quot;The current instance `#{cur_inst_name}` is invalid: it&#39;s &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3457">
          
          
          <code class="ruby">              &quot;not a valid directory.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3458">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3459">
          
          
          <code class="ruby">      if valid_meta &amp;&amp; (cur_inst_meta_path.nil? || !cur_inst_meta_path.file?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3460">
          
          
          <code class="ruby">        error(&quot;The meta file path `#{cur_inst_meta_path}` is invalid.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3461">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3462">
          
          
          <code class="ruby">      if cur_inst_vars_path.nil? || !cur_inst_vars_path.directory?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3463">
          
          
          <code class="ruby">        error(&quot;The variables directory `#{cur_inst_vars_path}` is invalid.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3464">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3465">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3466">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3467">
          
          
          <code class="ruby">    # Create non-existing internal directories.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3468">
          
          
          <code class="ruby">    FileUtils.mkdir_p(root_path) unless root_path.directory?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3469">
          
          
          <code class="ruby">    [cfg_path, inst_path].each do |dir_path|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3470">
          
          
          <code class="ruby">      next if dir_path.directory?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3471">
          
          
          <code class="ruby">      FileUtils.mkdir_p(dir_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3472">
          
          
          <code class="ruby">      exec_cmd(&quot;chmod a+w #{dir_path.shell_escape}&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3473">
          
          
          <code class="ruby">               as_su: File.owned?(dir_path))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3474">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3475">
          
          
          <code class="ruby">    if cur_inst_path &amp;&amp; !cur_inst_path.directory?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3476">
          
          
          <code class="ruby">      FileUtils.mkdir_p(cur_inst_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3477">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3478">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3479">
          
          
          <code class="ruby">    # Return the known storage paths.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3480">
          
          
          <code class="ruby">    OpenStruct.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3481">
          
          
          <code class="ruby">      root:          root_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3482">
          
          
          <code class="ruby">      cfg:           cfg_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3483">
          
          
          <code class="ruby">      cur_cfg:       cur_cfg_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3484">
          
          
          <code class="ruby">      cur_cfg_vars:  cur_cfg_vars_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3485">
          
          
          <code class="ruby">      cur_cfg_elems: cur_cfg_elems_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3486">
          
          
          <code class="ruby">      cur_cfg_meta:  cur_cfg_meta_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3487">
          
          
          <code class="ruby">      inst:          inst_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3488">
          
          
          <code class="ruby">      cur_inst:      cur_inst_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3489">
          
          
          <code class="ruby">      cur_inst_vars: cur_inst_vars_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3490">
          
          
          <code class="ruby">      cur_inst_elems: cur_inst_elems_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3491">
          
          
          <code class="ruby">      cur_inst_meta: cur_inst_meta_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3492">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3493">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3494">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3495">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3496">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────────── Setup ← Vars ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3497">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3498">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Vars</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3499">
          <span class="hits">1</span>
          
          <code class="ruby">  class Setup</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3500">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3501">
          <span class="hits">1</span>
          
          <code class="ruby">    include Fizzy::IO</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3502">
          <span class="hits">1</span>
          
          <code class="ruby">    include Fizzy::Filesystem</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3503">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3504">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(vars_dir_path, name, bindings)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3505">
          
          
          <code class="ruby">      @binding = bindings</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3506">
          
          
          <code class="ruby">      @vars_dir_path = vars_dir_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3507">
          
          
          <code class="ruby">      @name          = name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3508">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3509">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3510">
          
          
          <code class="ruby">    # Setup the variables that will be used during ERB processing.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3511">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3512">
          
          
          <code class="ruby">    # Those variables will be set into an instance field called `@vars`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3513">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3514">
          
          
          <code class="ruby">    # After calling this method, you can directly access the variables using</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3515">
          
          
          <code class="ruby">    # `@vars` or using the attribute reader `vars`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3516">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3517">
          <span class="hits">1</span>
          
          <code class="ruby">    def run</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3518">
          
          
          <code class="ruby">      setup_vars(@vars_dir_path, @name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3519">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3520">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3521">
          <span class="hits">1</span>
          
          <code class="ruby">    def setup_vars(vars_dir_path, name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3522">
          
          
          <code class="ruby">      fmt, content = read_vars(vars_dir_path, name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3523">
          
          
          <code class="ruby">      error(&quot;Invalid vars: `#{name}`.&quot;) if fmt == nil || content == nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3524">
          
          
          <code class="ruby">      self_vars    = parse_vars(name, fmt, content)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3525">
          
          
          <code class="ruby">      parents      = parse_parents_vars(fmt, content)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3526">
          
          
          <code class="ruby">      parents_vars = merge_parents_vars(vars_dir_path, parents)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3527">
          
          
          <code class="ruby">      merge_with_parents_vars(self_vars, parents_vars)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3528">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3529">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :setup_vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3530">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3531">
          <span class="hits">1</span>
          
          <code class="ruby">    def read_vars(vars_dir_path, name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3532">
          
          
          <code class="ruby">      yaml_file_path = find_yaml_path(vars_dir_path.join(name)) unless vars_dir_path.nil? || name.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3533">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3534">
          
          
          <code class="ruby">      if yaml_file_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3535">
          
          
          <code class="ruby">        [:yaml, File.read(yaml_file_path)]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3536">
          
          
          <code class="ruby">      elsif !name.nil? &amp;&amp; ENV.has_key?(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3537">
          
          
          <code class="ruby">        [:json, ENV[name]]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3538">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3539">
          
          
          <code class="ruby">        [nil, nil]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3540">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3541">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3542">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :read_vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3543">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3544">
          <span class="hits">1</span>
          
          <code class="ruby">    def parse_vars(name, fmt, content)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3545">
          
          
          <code class="ruby">      content = ERB.new(content).result(@binding)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3546">
          
          
          <code class="ruby">      case fmt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3547">
          
          
          <code class="ruby">        when :yaml</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3548">
          
          
          <code class="ruby">          begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3549">
          
          
          <code class="ruby">            YAML.load(content) || {}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3550">
          
          
          <code class="ruby">          rescue Psych::SyntaxError =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3551">
          
          
          <code class="ruby">            error(&quot;Invalid syntax in YAML `#{name}`: #{e.message}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3552">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3553">
          
          
          <code class="ruby">        when :json</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3554">
          
          
          <code class="ruby">          begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3555">
          
          
          <code class="ruby">            JSON.parse(content)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3556">
          
          
          <code class="ruby">          rescue JSON::JSONError =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3557">
          
          
          <code class="ruby">            error(&quot;Invalid JSON `#{name}`: #{e.message}.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3558">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3559">
          
          
          <code class="ruby">        else error(&quot;Unrecognized format: `#{fmt}`&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3560">
          
          
          <code class="ruby">      end.deep_symbolize_keys</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3561">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3562">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :parse_vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3563">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3564">
          <span class="hits">1</span>
          
          <code class="ruby">    def parse_parents_vars(fmt, content)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3565">
          
          
          <code class="ruby">      parents_regexp = case fmt</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3566">
          
          
          <code class="ruby">                         when :yaml then Fizzy::CFG.vars.yaml_regexp</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3567">
          
          
          <code class="ruby">                         when :json then Fizzy::CFG.vars.json_regexp</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3568">
          
          
          <code class="ruby">                         else       error(&quot;Unrecognized format: `#{fmt}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3569">
          
          
          <code class="ruby">                       end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3570">
          
          
          <code class="ruby">      if md = content.match(parents_regexp)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3571">
          
          
          <code class="ruby">        md[:parents].split(&quot;,&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3572">
          
          
          <code class="ruby">                    .map(&amp;:strip)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3573">
          
          
          <code class="ruby">                    .reject{|p| p =~ Fizzy::CFG.vars.parent_dummy_regexp}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3574">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3575">
          
          
          <code class="ruby">        []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3576">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3577">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3578">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :parse_parents_vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3579">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3580">
          <span class="hits">1</span>
          
          <code class="ruby">    def merge_with_parents_vars(self_vars, parents_vars)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3581">
          
          
          <code class="ruby">      parents_vars.magic_merge(self_vars)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3582">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3583">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :merge_with_parents_vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3584">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3585">
          <span class="hits">1</span>
          
          <code class="ruby">    def merge_parents_vars(vars_dir_path, parents)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3586">
          
          
          <code class="ruby">      parents.inject([]) do |acc, parent| # Vars for each parent.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3587">
          
          
          <code class="ruby">        parent_vars = setup_vars(vars_dir_path, parent)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3588">
          
          
          <code class="ruby">        acc &lt;&lt; parent_vars</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3589">
          
          
          <code class="ruby">      end.inject({}) do |acc, parent_vars| # Merge them.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3590">
          
          
          <code class="ruby">        acc.magic_merge(parent_vars)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3591">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3592">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3593">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :merge_parents_vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3594">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3595">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3596">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3597">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3598">
          
          
          <code class="ruby"># ────────────────────────────────────────────────────── Filter ← Vars ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3599">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3600">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Vars</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3601">
          <span class="hits">1</span>
          
          <code class="ruby">  module Filter</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3602">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.define(name, description: nil, &amp;block)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3603">
          <span class="hits">1</span>
          
          <code class="ruby">      @filters ||= []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3604">
          <span class="hits">1</span>
          
          <code class="ruby">      @filters &lt;&lt; SimpleFilter.new(name, description.strip, &amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3605">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3606">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3607">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.apply(blob)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3608">
          
          
          <code class="ruby">      filter = (@filters || []).find { |f| f.match?(blob) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3609">
          
          
          <code class="ruby">      if filter</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3610">
          
          
          <code class="ruby">        filter.apply(blob)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3611">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3612">
          
          
          <code class="ruby">        blob</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3613">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3614">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3615">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3616">
          <span class="hits">1</span>
          
          <code class="ruby">    class SimpleFilter</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3617">
          <span class="hits">1</span>
          
          <code class="ruby">      include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3618">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3619">
          <span class="hits">1</span>
          
          <code class="ruby">      attr_reader :name, :desc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3620">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3621">
          <span class="hits">1</span>
          
          <code class="ruby">      def initialize(name, desc, &amp;block)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3622">
          <span class="hits">1</span>
          
          <code class="ruby">        @name   = name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3623">
          <span class="hits">1</span>
          
          <code class="ruby">        @desc   = desc</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3624">
          <span class="hits">1</span>
          
          <code class="ruby">        @block  = block</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3625">
          <span class="hits">1</span>
          
          <code class="ruby">        @regexp = /^&lt;\{\s*(?&lt;name&gt;#{@name})\s*(?&lt;args&gt;\S+)\s*\}&gt;$/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3626">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3627">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3628">
          <span class="hits">1</span>
          
          <code class="ruby">      def match?(blob)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3629">
          
          
          <code class="ruby">        return false unless blob.is_a?(String) || blob.is_a?(Symbol)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3630">
          
          
          <code class="ruby">        @regexp =~ blob.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3631">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3632">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3633">
          <span class="hits">1</span>
          
          <code class="ruby">      def apply(blob)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3634">
          
          
          <code class="ruby">        md = @regexp.match(blob)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3635">
          
          
          <code class="ruby">        return if md.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3636">
          
          
          <code class="ruby">        args = md[:args]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3637">
          
          
          <code class="ruby">        def args.split_by_separator(sep = &quot;,&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3638">
          
          
          <code class="ruby">          split(/(?:\s*[#{sep}]\s*)/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3639">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3640">
          
          
          <code class="ruby">        @block.call(args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3641">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3642">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3643">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3644">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3645">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3646">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────── Retriever ← Vars ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3647">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3648">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Vars</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3649">
          <span class="hits">1</span>
          
          <code class="ruby">  class Retriever</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3650">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3651">
          <span class="hits">1</span>
          
          <code class="ruby">    include Fizzy::IO</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3652">
          <span class="hits">1</span>
          
          <code class="ruby">    include Fizzy::TypeSystem</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3653">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3654">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(vars)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3655">
          
          
          <code class="ruby">      @vars = vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3656">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3657">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3658">
          
          
          <code class="ruby">    # Return the variables matching the provided `name`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3659">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3660">
          
          
          <code class="ruby">    # The result is normally a list of the matching variables; but if `expand`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3661">
          
          
          <code class="ruby">    # is `true`, empty list is expanded to `nil` and a list of one element is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3662">
          
          
          <code class="ruby">    # expanded to that element.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3663">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3664">
          <span class="hits">1</span>
          
          <code class="ruby">    def get(var_name, type: nil, strict: false, single_match: false, expand: true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3665">
          
          
          <code class="ruby">      var = _get_var(@vars, var_name, single_match: single_match)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3666">
          
          
          <code class="ruby">      var = _typize_var(var_name, var, type, strict)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3667">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3668">
          
          
          <code class="ruby">      if expand</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3669">
          
          
          <code class="ruby">        case var.length</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3670">
          
          
          <code class="ruby">          when 0 then nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3671">
          
          
          <code class="ruby">          when 1 then var.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3672">
          
          
          <code class="ruby">          else        var</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3673">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3674">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3675">
          
          
          <code class="ruby">        var</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3676">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3677">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3678">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3679">
          
          
          <code class="ruby">    # Accept a list of variables (`vars` argument) and ensure they are correctly</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3680">
          
          
          <code class="ruby">    # typed, according to `type`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3681">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3682">
          
          
          <code class="ruby">    # See `Fizzy::TypeSystem#typize` for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3683">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3684">
          <span class="hits">1</span>
          
          <code class="ruby">    def _typize_var(name, variable, type, strict)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3685">
          
          
          <code class="ruby">      Array(variable).map do |var|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3686">
          
          
          <code class="ruby">        typize(name, var, type: type, strict: strict)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3687">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3688">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3689">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :_typize_var</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3690">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3691">
          <span class="hits">1</span>
          
          <code class="ruby">    def _ensure_type!(name, var, *types)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3692">
          
          
          <code class="ruby">      if types.any?{|type| var.is_a?(type)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3693">
          
          
          <code class="ruby">        var</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3694">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3695">
          
          
          <code class="ruby">        error(&quot;Invalid type for variable `#{name}`: &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3696">
          
          
          <code class="ruby">              &quot;it&#39;s not a `#{type.name}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3697">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3698">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3699">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :_ensure_type!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3700">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3701">
          
          
          <code class="ruby">    # Returns a list of variables matching the provided `name`, chosen from `vars`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3702">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3703">
          
          
          <code class="ruby">    # The argument `single_match` can be one of `[:force, true, false]`, to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3704">
          
          
          <code class="ruby">    # respectively force, restrict to, don&#39;t return a single match (the first).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3705">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3706">
          
          
          <code class="ruby">    # This method effectively implements the logic to retrieve variables.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3707">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3708">
          <span class="hits">1</span>
          
          <code class="ruby">    def _get_var(vars, name, single_match: :force)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3709">
          
          
          <code class="ruby">      dot_split_regexp = /([^.]+)(?:\.|$)/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3710">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3711">
          
          
          <code class="ruby">      name.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3712">
          
          
          <code class="ruby">          .scan(dot_split_regexp)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3713">
          
          
          <code class="ruby">          .map{|match_group| match_group[0]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3714">
          
          
          <code class="ruby">          .reject(&amp;:empty?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3715">
          
          
          <code class="ruby">          .inject(vars) do |current_objects, name_component|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3716">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3717">
          
          
          <code class="ruby">        # Intermediate `current_objects` are lists because every step returns</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3718">
          
          
          <code class="ruby">        # a list.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3719">
          
          
          <code class="ruby">        # If a step is not-final (i.e. intermediate), we need to be sure there</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3720">
          
          
          <code class="ruby">        # is only one element.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3721">
          
          
          <code class="ruby">        if current_objects.is_a?(Array)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3722">
          
          
          <code class="ruby">          if current_objects.length == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3723">
          
          
          <code class="ruby">            current_objects = current_objects.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3724">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3725">
          
          
          <code class="ruby">            error(&quot;Variabile name diverges: multiple intermediate paths are &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3726">
          
          
          <code class="ruby">                  &quot;taken (`[#{current_objects}]`).&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3727">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3728">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3729">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3730">
          
          
          <code class="ruby">        # Fill `next_objects`.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3731">
          
          
          <code class="ruby">        next_objects = if current_objects.has_key?(name_component)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3732">
          
          
          <code class="ruby">                         # Exact match.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3733">
          
          
          <code class="ruby">                         Array[current_objects[name_component]]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3734">
          
          
          <code class="ruby">                       elsif current_objects.has_key?(name_component.to_sym)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3735">
          
          
          <code class="ruby">                         # Exact match.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3736">
          
          
          <code class="ruby">                         Array[current_objects[name_component.to_sym]]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3737">
          
          
          <code class="ruby">                       else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3738">
          
          
          <code class="ruby">                         # Check if there are elements with key matching</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3739">
          
          
          <code class="ruby">                         # `name_component` as regexp.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3740">
          
          
          <code class="ruby">                         # Return `nil` if nothing is found.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3741">
          
          
          <code class="ruby">                         current_objects.select do |k, v|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3742">
          
          
          <code class="ruby">                           k.to_s =~ Regexp.new(/^#{name_component}$/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3743">
          
          
          <code class="ruby">                         end.values</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3744">
          
          
          <code class="ruby">                       end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3745">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3746">
          
          
          <code class="ruby">        # Filter `next_objects`.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3747">
          
          
          <code class="ruby">        next_objects = next_objects.map{|e| Fizzy::Vars::Filter.apply(e)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3748">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3749">
          
          
          <code class="ruby">        # Adjust `next_objects`, according to `single_match` argument.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3750">
          
          
          <code class="ruby">        next_objects = if single_match</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3751">
          
          
          <code class="ruby">                         if single_match == :force &amp;&amp; next_objects.length != 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3752">
          
          
          <code class="ruby">                           error(&quot;Expected a single match for variable &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3753">
          
          
          <code class="ruby">                                 &quot;`#{name}`, but instead got &quot; +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3754">
          
          
          <code class="ruby">                                 &quot;`#{next_objects.length}`&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3755">
          
          
          <code class="ruby">                         end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3756">
          
          
          <code class="ruby">                         next_objects.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3757">
          
          
          <code class="ruby">                       else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3758">
          
          
          <code class="ruby">                         next_objects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3759">
          
          
          <code class="ruby">                       end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3760">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3761">
          
          
          <code class="ruby">        if next_objects.nil? ||</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3762">
          
          
          <code class="ruby">           (next_objects.is_a?(Array) &amp;&amp; next_objects.empty?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3763">
          
          
          <code class="ruby">          break nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3764">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3765">
          
          
          <code class="ruby">        next_objects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3766">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3767">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3768">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :_get_var</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3769">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3770">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3771">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3772">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3773">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────────── Api ← Vars ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3774">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3775">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3776">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3777">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3778">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3779">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3780">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3781">
          
          
          <code class="ruby">  # Return a list of the available variables files.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3782">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3783">
          <span class="hits">1</span>
          
          <code class="ruby">  def avail_vars(vars_dir_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3784">
          
          
          <code class="ruby">    Pathname.glob(vars_dir_path.join(&quot;*&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3785">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3786">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3787">
          
          
          <code class="ruby">  # See `Fizzy::Vars::Setup#run`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3788">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3789">
          <span class="hits">1</span>
          
          <code class="ruby">  def setup_vars(vars_dir_path, name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3790">
          
          
          <code class="ruby">    info(&quot;vars: &quot;, name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3791">
          
          
          <code class="ruby">    @vars = Fizzy::Vars::Setup.new(vars_dir_path, name, binding).run()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3792">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3793">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3794">
          
          
          <code class="ruby">  # See `Fizzy::Vars::Retriever#run`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3795">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3796">
          <span class="hits">1</span>
          
          <code class="ruby">  def var(var_name, **opts)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3797">
          
          
          <code class="ruby">    Fizzy::Vars::Retriever.new(@vars).get(var_name, **opts)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3798">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3799">
          <span class="hits">1</span>
          
          <code class="ruby">  alias_method :get_var, :var # NOTE: For backward compatibility</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3800">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3801">
          
          
          <code class="ruby">  # Same of `var`, but raise an error if the variable hasn&#39;t been found or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3802">
          
          
          <code class="ruby">  # is `nil`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3803">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3804">
          <span class="hits">1</span>
          
          <code class="ruby">  def var!(var_name, **opts)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3805">
          
          
          <code class="ruby">    value = var(var_name, **opts)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3806">
          
          
          <code class="ruby">    value.nil? ? error(&quot;Undefined variable: `#{var_name}`.&quot;) : value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3807">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3808">
          <span class="hits">1</span>
          
          <code class="ruby">  alias_method :get_var!, :var! # NOTE: For backward compatibility</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3809">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3810">
          
          
          <code class="ruby">  # Check if the feature with the provided name (`feature_name`) is enabled.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3811">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3812">
          
          
          <code class="ruby">  # Since the features are defined just using variables, before calling this</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3813">
          
          
          <code class="ruby">  # method be sure that `setup_vars` has already been called.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3814">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3815">
          <span class="hits">1</span>
          
          <code class="ruby">  def has_feature?(*feature_names, match: :all?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3816">
          
          
          <code class="ruby">    features = get_var!(&quot;features&quot;, single_match: :force)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3817">
          
          
          <code class="ruby">    feature_names.map(&amp;:to_s).send(match) do |feature_name|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3818">
          
          
          <code class="ruby">      features.include? feature_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3819">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3820">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3821">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3822">
          
          
          <code class="ruby">  # Filter the values associated to the features, keeping only those</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3823">
          
          
          <code class="ruby">  # associated to available features.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3824">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3825">
          <span class="hits">1</span>
          
          <code class="ruby">  def data_for_features(info, sep: nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3826">
          
          
          <code class="ruby">    data = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3827">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3828">
          
          
          <code class="ruby">    info.each do |feature_name, associated_value|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3829">
          
          
          <code class="ruby">      if has_feature?(feature_name.to_sym)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3830">
          
          
          <code class="ruby">        if associated_value.respond_to?(:call)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3831">
          
          
          <code class="ruby">          data &lt;&lt; associated_value.call</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3832">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3833">
          
          
          <code class="ruby">          data &lt;&lt; associated_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3834">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3835">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3836">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3837">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3838">
          
          
          <code class="ruby">    if data.length == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3839">
          
          
          <code class="ruby">      def data.inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3840">
          
          
          <code class="ruby">        first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3841">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3842">
          
          
          <code class="ruby">    elsif sep</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3843">
          
          
          <code class="ruby">      def data.inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3844">
          
          
          <code class="ruby">        join(sep)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3845">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3846">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3847">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3848">
          
          
          <code class="ruby">    data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3849">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3850">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3851">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3852">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3853">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────────────── Locals ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3854">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3855">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Locals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3856">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3857">
          <span class="hits">1</span>
          
          <code class="ruby">  extend Forwardable</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3858">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3859">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3860">
          <span class="hits">1</span>
          
          <code class="ruby">  def_delegators :@locals_proxy, :local, :local!, :local?, :prefix?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3861">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3862">
          
          
          <code class="ruby">  # Entry point for using the DSL defined by `Proxy` class.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3863">
          
          
          <code class="ruby">  # The DSL is directly accessible inside the provided block.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3864">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3865">
          <span class="hits">1</span>
          
          <code class="ruby">  def define_locals(&amp;block)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3866">
          
          
          <code class="ruby">    error(&quot;No requirements specification provided.&quot;) unless block_given?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3867">
          
          
          <code class="ruby">    @locals_proxy = Fizzy::Locals::Proxy.new(self)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3868">
          
          
          <code class="ruby">    @locals_proxy.instance_eval(&amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3869">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3870">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3871">
          
          
          <code class="ruby">  # DSL used for defining locals.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3872">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3873">
          <span class="hits">1</span>
          
          <code class="ruby">  class Proxy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3874">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3875">
          <span class="hits">1</span>
          
          <code class="ruby">    include Fizzy::IO</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3876">
          <span class="hits">1</span>
          
          <code class="ruby">    include Fizzy::TypeSystem</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3877">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3878">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :locals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3879">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3880">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(receiver)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3881">
          
          
          <code class="ruby">      @receiver = receiver</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3882">
          
          
          <code class="ruby">      @locals   = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3883">
          
          
          <code class="ruby">      @prefix   = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3884">
          
          
          <code class="ruby">      @prefix_history = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3885">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3886">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3887">
          
          
          <code class="ruby">    # ──────────────────────────────────────────────────────────────────────────</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3888">
          
          
          <code class="ruby">    # ☞ DSL definition</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3889">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3890">
          
          
          <code class="ruby">    # Create a new `local` fetching the value from the corresponding `variable`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3891">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3892">
          <span class="hits">1</span>
          
          <code class="ruby">    def variable(name, *args, **opts)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3893">
          
          
          <code class="ruby">      name = name.to_s.to_sym</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3894">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3895">
          
          
          <code class="ruby">      var = _get_var(name, **opts.slice(:type, :strict))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3896">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3897">
          
          
          <code class="ruby">      name  = opts.fetch(:as, name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3898">
          
          
          <code class="ruby">      value = var.nil? ? opts.fetch(:default, nil) : var</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3899">
          
          
          <code class="ruby">      value = yield(value) if block_given?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3900">
          
          
          <code class="ruby">      _set_local(name, value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3901">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3902">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3903">
          
          
          <code class="ruby">    # Create a new computed `local`, based upon other locals.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3904">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3905">
          <span class="hits">1</span>
          
          <code class="ruby">    def computed(name, **typize_opts, &amp;block)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3906">
          
          
          <code class="ruby">      name = name.to_s.to_sym</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3907">
          
          
          <code class="ruby">      error(&quot;Invalid local name `#{name}`: it&#39;s blank.&quot;) if name.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3908">
          
          
          <code class="ruby">      error(&quot;Cannot compute local `#{name}`.&quot;) unless block_given?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3909">
          
          
          <code class="ruby">      value = @receiver.instance_exec(&amp;block)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3910">
          
          
          <code class="ruby">      value = typize(name, value, **typize_opts) if typize_opts.length &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3911">
          
          
          <code class="ruby">      _set_local(name, value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3912">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3913">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3914">
          
          
          <code class="ruby">    # Access the value of a local.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3915">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3916">
          <span class="hits">1</span>
          
          <code class="ruby">    def local(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3917">
          
          
          <code class="ruby">      @locals[name.to_s.to_sym]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3918">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3919">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3920">
          
          
          <code class="ruby">    # Access the value of a local or raise an error if it&#39;s not defined.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3921">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3922">
          <span class="hits">1</span>
          
          <code class="ruby">    def local!(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3923">
          
          
          <code class="ruby">      value = local(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3924">
          
          
          <code class="ruby">      error(&quot;Undefined local `#{name}`.&quot;) if value.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3925">
          
          
          <code class="ruby">      value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3926">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3927">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3928">
          
          
          <code class="ruby">    # If all locals identified by `names` are available, evaluate the block</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3929">
          
          
          <code class="ruby">    # passing the locals&#39; values.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3930">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3931">
          <span class="hits">1</span>
          
          <code class="ruby">    def local?(*names, &amp;block)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3932">
          
          
          <code class="ruby">      names.collect{|name| local(name)}.compact.length == names.length</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3933">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3934">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3935">
          <span class="hits">1</span>
          
          <code class="ruby">    def prefixed(var, as: nil, optional: false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3936">
          
          
          <code class="ruby">      error(&quot;A block is required&quot;) unless block_given?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3937">
          
          
          <code class="ruby">      unless @receiver.get_var(var.to_s.gsub(/\.$/, &quot;&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3938">
          
          
          <code class="ruby">        return if optional</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3939">
          
          
          <code class="ruby">        error(&quot;Invalid variable prefix: `#{var}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3940">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3941">
          
          
          <code class="ruby">      @prefix = {var: var, local: as}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3942">
          
          
          <code class="ruby">      @prefix_history &lt;&lt; @prefix</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3943">
          
          
          <code class="ruby">      yield</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3944">
          
          
          <code class="ruby">      @prefix = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3945">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3946">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3947">
          
          
          <code class="ruby">    # Return `true`, if a prefix starting with the provided `prefix` has</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3948">
          
          
          <code class="ruby">    # been defined; otherwise, `false`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3949">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3950">
          <span class="hits">1</span>
          
          <code class="ruby">    def prefix?(prefix)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3951">
          
          
          <code class="ruby">      @prefix_history.any?{|p| p[:local].to_s.start_with?(prefix.to_s)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3952">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3953">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3954">
          
          
          <code class="ruby">    # ──────────────────────────────────────────────────────────────────────────</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3955">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3956">
          <span class="hits">1</span>
          
          <code class="ruby">    def _get_var(name, **opts)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3957">
          
          
          <code class="ruby">      name = @prefix &amp;&amp; @prefix[:var] ? &quot;#{@prefix[:var]}#{name}&quot; : name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3958">
          
          
          <code class="ruby">      @receiver.get_var(name.to_s.to_sym, **opts)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3959">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3960">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3961">
          <span class="hits">1</span>
          
          <code class="ruby">    def _set_local(name, value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3962">
          
          
          <code class="ruby">      name = @prefix &amp;&amp; @prefix[:local] ? &quot;#{@prefix[:local]}#{name}&quot; : name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3963">
          
          
          <code class="ruby">      @locals[name.to_s.to_sym] = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3964">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3965">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3966">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3967">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3968">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3969">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3970">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────── Init ← Meta ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3971">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3972">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Meta</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3973">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3974">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3975">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────── Commands ← Meta ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3976">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3977">
          
          
          <code class="ruby"># Manage commands declared in the meta file.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3978">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3979">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Meta::Commands</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3980">
          
          
          <code class="ruby">  # Base command.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3981">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3982">
          <span class="hits">1</span>
          
          <code class="ruby">  class Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3983">
          <span class="hits">1</span>
          
          <code class="ruby">    include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3984">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3985">
          <span class="hits">1</span>
          
          <code class="ruby">    def type</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3986">
          
          
          <code class="ruby">      self.class.type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3987">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3988">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3989">
          <span class="hits">1</span>
          
          <code class="ruby">    def invalid_spec(name, value = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3990">
          
          
          <code class="ruby">      msg  = &quot;Invalid `#{name}` provided to command `#{type}`: &quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3991">
          
          
          <code class="ruby">      msg += value.nil? ? &quot;no value given.&quot; : &quot;`#{value}`.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3992">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3993">
          
          
          <code class="ruby">      error(msg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3994">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3995">
          <span class="hits">1</span>
          
          <code class="ruby">    protected :invalid_spec</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3996">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3997">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3998">
          
          
          <code class="ruby">  # Meta-Command that syncs a repository.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3999">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4000">
          
          
          <code class="ruby">  # Spec:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4001">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4002">
          
          
          <code class="ruby">  # * `repo`: The repository specification.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4003">
          
          
          <code class="ruby">  # * `dst`: The destination path.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4004">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4005">
          <span class="hits">1</span>
          
          <code class="ruby">  class Sync &lt; Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4006">
          <span class="hits">1</span>
          
          <code class="ruby">    def validate!(spec)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4007">
          
          
          <code class="ruby">      # 1: Validate.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4008">
          
          
          <code class="ruby">      invalid_spec :repo unless spec.key?(:repo)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4009">
          
          
          <code class="ruby">      invalid_spec :dst  unless spec.key?(:dst)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4010">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4011">
          
          
          <code class="ruby">      # 2: Normalize.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4012">
          
          
          <code class="ruby">      @repo = spec[:repo]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4013">
          
          
          <code class="ruby">      @dst = Pathname.new(spec[:dst]).expand_variables.expand_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4014">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4015">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4016">
          <span class="hits">1</span>
          
          <code class="ruby">    def execute</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4017">
          
          
          <code class="ruby">      Fizzy::Sync.perform(@dst, @repo)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4018">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4019">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4020">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.type</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4021">
          
          
          <code class="ruby">      :sync</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4022">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4023">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4024">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4025">
          
          
          <code class="ruby">  # Meta-Command that performs a file download.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4026">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4027">
          
          
          <code class="ruby">  # Spec:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4028">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4029">
          
          
          <code class="ruby">  # * `url`: The URL where the file should be downloaded.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4030">
          
          
          <code class="ruby">  # * `dst`: The destination path.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4031">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4032">
          <span class="hits">1</span>
          
          <code class="ruby">  class Download &lt; Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4033">
          <span class="hits">1</span>
          
          <code class="ruby">    def validate!(spec)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4034">
          
          
          <code class="ruby">      # 1: Validate.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4035">
          
          
          <code class="ruby">      invalid_spec :url unless spec.key?(:url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4036">
          
          
          <code class="ruby">      invalid_spec :dst unless spec.key?(:dst)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4037">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4038">
          
          
          <code class="ruby">      # 2: Normalize.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4039">
          
          
          <code class="ruby">      @url = URI(spec[:url])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4040">
          
          
          <code class="ruby">      @dst = Pathname.new(spec[:dst]).expand_variables.expand_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4041">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4042">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4043">
          <span class="hits">1</span>
          
          <code class="ruby">    def execute</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4044">
          
          
          <code class="ruby">      res = Net::HTTP.get_response(@url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4045">
          
          
          <code class="ruby">      if res.is_a?(Net::HTTPSuccess)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4046">
          
          
          <code class="ruby">        # TODO: atm it requires the current user has write access.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4047">
          
          
          <code class="ruby">        #      refactor when a more robust permission mgmt is implemented.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4048">
          
          
          <code class="ruby">        FileUtils.mkdir_p(@dst.dirname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4049">
          
          
          <code class="ruby">        @dst.write(res.body)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4050">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4051">
          
          
          <code class="ruby">        error(&quot;Network error: cannot retrieve `#{@url}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4052">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4053">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4054">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4055">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.type</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4056">
          
          
          <code class="ruby">      :download</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4057">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4058">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4059">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4060">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.available</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4061">
          
          
          <code class="ruby">    [Sync, Download]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4062">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4063">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4064">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_type(type)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4065">
          
          
          <code class="ruby">    found = Fizzy::Meta::Commands.available.select do |command|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4066">
          
          
          <code class="ruby">      command.type == type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4067">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4068">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4069">
          
          
          <code class="ruby">    if found.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4070">
          
          
          <code class="ruby">      error &quot;Failed to find a command with type `#{type}`.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4071">
          
          
          <code class="ruby">    elsif found.length != 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4072">
          
          
          <code class="ruby">      error &quot;[BUG] Multiple commands matched type `#{type}`&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4073">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4074">
          
          
          <code class="ruby">      found[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4075">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4076">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4077">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4078">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4079">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────── Info ← Meta ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4080">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4081">
          
          
          <code class="ruby"># Access informations declared in the meta file.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4082">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4083">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Meta::Info</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4084">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4085">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4086">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4087">
          
          
          <code class="ruby">  # Return the normalized and validated meta object.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4088">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4089">
          
          
          <code class="ruby">  # Be sure to call `setup_vars` before calling this method.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4090">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4091">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_meta(meta_path, vars_path, elems_base_path, verbose)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4092">
          
          
          <code class="ruby">    tell(&quot;{b{Getting meta informations.}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4093">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4094">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4095">
          
          
          <code class="ruby">      meta = YAML.safe_load(File.read(meta_path)).deep_symbolize_keys</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4096">
          
          
          <code class="ruby">    rescue Psych::SyntaxError =&gt; exc</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4097">
          
          
          <code class="ruby">      error(&quot;Failed to parse meta file: `#{meta_path}`. &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4098">
          
          
          <code class="ruby">            &quot;Reason: `#{exc.message}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4099">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4101">
          
          
          <code class="ruby">    meta[:all_elems_count] = meta[:elems].count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4103">
          
          
          <code class="ruby">    # ──────────────────────────────────────────────────────────────────────────</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4104">
          
          
          <code class="ruby">    # ☞ Step 1: Normalize elements</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4106">
          
          
          <code class="ruby">    elem_erb_excluded_fields = %i[only]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4108">
          
          
          <code class="ruby">    meta[:elems] = [] unless meta.key?(:elems)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4110">
          
          
          <code class="ruby">    meta[:elems] = meta[:elems].each_with_index.collect do |elem, idx|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4111">
          
          
          <code class="ruby">      elem_identifier = elem[:name] || &quot;src = #{elem[:src]}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4112">
          
          
          <code class="ruby">      info(&quot;\nElement: &quot;, elem_identifier) if verbose</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4114">
          
          
          <code class="ruby">      # Step 1.1: Validate `only` and determine if the element is selected.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4115">
          
          
          <code class="ruby">      if elem.key?(:only) &amp;&amp;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4116">
          
          
          <code class="ruby">         !(elem[:only].is_a?(Hash) ||</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4117">
          
          
          <code class="ruby">         elem[:only].is_a?(String))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4118">
          
          
          <code class="ruby">        error(&quot;The configuration element `#{elem_identifier}` has invalid &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4119">
          
          
          <code class="ruby">              &quot;`only`: it&#39;s not a `Hash`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4120">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4121">
          
          
          <code class="ruby">      selected = selected_by_only?(elem[:only], verbose)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4123">
          
          
          <code class="ruby">      # Step 1.2: Pre-process strings with ERB.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4124">
          
          
          <code class="ruby">      if selected</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4125">
          
          
          <code class="ruby">        elem.each do |k, v|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4126">
          
          
          <code class="ruby">          unless elem_erb_excluded_fields.include?(k)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4127">
          
          
          <code class="ruby">            elem[k] = ERB.new(v.to_s).result(binding)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4128">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4129">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4130">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4132">
          
          
          <code class="ruby">      # Step 1.3: Validate and normalize:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4133">
          
          
          <code class="ruby">      #           `name`, `src`, `dst`, `fs_maps`, `perms`.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4134">
          
          
          <code class="ruby">      if selected</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4135">
          
          
          <code class="ruby">        unless elem.key?(:src)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4136">
          
          
          <code class="ruby">          error(&quot;Element `#{elem_identifier}` doesn&#39;t contain `src`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4137">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4138">
          
          
          <code class="ruby">        elem[:name] = elem[:src] unless elem.key?(:name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4139">
          
          
          <code class="ruby">        unless elem.key?(:dst)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4140">
          
          
          <code class="ruby">          error(&quot;Element `#{elem_identifier}` doesn&#39;t contain `dst`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4141">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4142">
          
          
          <code class="ruby">        elem[:perms] = elem[:perms].to_s if elem.key?(:perms)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4143">
          
          
          <code class="ruby">        elem[:fs_maps] = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4144">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4146">
          
          
          <code class="ruby">      selected ? elem : nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4147">
          
          
          <code class="ruby">    end.compact</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4149">
          
          
          <code class="ruby">    # Step 1.4: For each active elem, match the `src` field against the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4150">
          
          
          <code class="ruby">    #           filesystem and determine filesystem mapping (`fs_maps`).</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4151">
          
          
          <code class="ruby">    meta[:elems].each do |elem|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4152">
          
          
          <code class="ruby">      found = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4154">
          
          
          <code class="ruby">      Find.find(elems_base_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4155">
          
          
          <code class="ruby">          .map { |ebp| Pathname.new(ebp).expand_variables.expand_path }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4156">
          
          
          <code class="ruby">          .select(&amp;:file?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4157">
          
          
          <code class="ruby">          .each do |subfile_path|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4159">
          
          
          <code class="ruby">        subfile_rel_path = subfile_path.relative_path_from(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4160">
          
          
          <code class="ruby">          Pathname.new(elems_base_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4161">
          
          
          <code class="ruby">        ).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4162">
          
          
          <code class="ruby">        md = Regexp.new(elem[:src]).match(subfile_rel_path.gsub(/\.tt$/, &quot;&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4163">
          
          
          <code class="ruby">        next unless md</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4164">
          
          
          <code class="ruby">        found = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4165">
          
          
          <code class="ruby">        dst_path = elem[:dst].gsub(/&lt;([0-9]+)&gt;/) do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4166">
          
          
          <code class="ruby">          idx = Integer(Regexp.last_match(1))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4167">
          
          
          <code class="ruby">          if (1..md.length) === idx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4168">
          
          
          <code class="ruby">            md[idx]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4169">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4170">
          
          
          <code class="ruby">            error(&quot;Invalid `dst` for element `#{elem[:name]}`: nothing &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4171">
          
          
          <code class="ruby">                  &quot;captured at index `#{idx}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4172">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4173">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4174">
          
          
          <code class="ruby">        elem[:fs_maps] &lt;&lt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4175">
          
          
          <code class="ruby">          src_path: Pathname.new(subfile_path).expand_variables.expand_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4176">
          
          
          <code class="ruby">          dst_path: Pathname.new(dst_path).expand_variables.expand_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4177">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4178">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4179">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4180">
          
          
          <code class="ruby">      unless found</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4181">
          
          
          <code class="ruby">        warning(&quot;Inconsistency found for elem `#{elem[:name]}`: no file &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4182">
          
          
          <code class="ruby">                &quot;matches src: `#{elem[:src]}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4183">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4184">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4185">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4186">
          
          
          <code class="ruby">    # ──────────────────────────────────────────────────────────────────────────</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4187">
          
          
          <code class="ruby">    # ☞ Step 2: Normalize commands</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4188">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4189">
          
          
          <code class="ruby">    command_excluded_erb_fields = [:only]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4191">
          
          
          <code class="ruby">    meta[:commands] = [] unless meta.key?(:commands)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4193">
          
          
          <code class="ruby">    meta[:commands] = meta[:commands].each_with_index.collect do |spec, idx|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4194">
          
          
          <code class="ruby">      spec[:type] = spec[:type].to_sym</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4195">
          
          
          <code class="ruby">      spec[:name] ||= &quot;type = #{spec[:type]}, index = #{idx}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4196">
          
          
          <code class="ruby">      info(&quot;\nCommand: &quot;, spec[:name]) if verbose</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4197">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4198">
          
          
          <code class="ruby">      selected = selected_by_only?(spec[:only], verbose)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4199">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4200">
          
          
          <code class="ruby">      if selected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4201">
          
          
          <code class="ruby">        # Step 2.1: Pre-process strings with ERB.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4202">
          
          
          <code class="ruby">        spec.each do |key, value|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4203">
          
          
          <code class="ruby">          unless command_excluded_erb_fields.include?(key)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4204">
          
          
          <code class="ruby">            spec[key] = ERB.new(value).result(binding) if value.is_a?(String)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4205">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4206">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4207">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4208">
          
          
          <code class="ruby">        # Step 2.2: Validate command.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4209">
          
          
          <code class="ruby">        command = Fizzy::Meta::Commands.find_by_type(spec[:type]).new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4210">
          
          
          <code class="ruby">        command.validate!(spec)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4211">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4213">
          
          
          <code class="ruby">      selected ? command : nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4214">
          
          
          <code class="ruby">    end.compact</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4215">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4216">
          
          
          <code class="ruby">    # ──────────────────────────────────────────────────────────────────────────</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4218">
          
          
          <code class="ruby">    # Build the list of excluded files (needed by thor&#39;s `directory(..)`).</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4219">
          
          
          <code class="ruby">    all_files = SortedSet.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4220">
          
          
          <code class="ruby">      Find.find(elems_base_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4221">
          
          
          <code class="ruby">          .map { |f| Pathname.new(f).expand_variables.expand_path }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4222">
          
          
          <code class="ruby">          .select(&amp;:file?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4223">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4224">
          
          
          <code class="ruby">    src_paths = SortedSet.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4225">
          
          
          <code class="ruby">      meta[:elems].collect_concat do |elem|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4226">
          
          
          <code class="ruby">        elem[:fs_maps].map { |m| m[:src_path] }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4227">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4228">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4229">
          
          
          <code class="ruby">    vars_files = Pathname.glob(vars_path.join(&quot;*&quot;), File::FNM_DOTMATCH)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4230">
          
          
          <code class="ruby">    meta[:system_files]    = SortedSet.new(vars_files &lt;&lt; meta_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4231">
          
          
          <code class="ruby">    meta[:excluded_files]  = all_files - src_paths - meta[:system_files]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4232">
          
          
          <code class="ruby">    meta[:all_files_count] = all_files.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4233">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4234">
          
          
          <code class="ruby">    meta</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4235">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4236">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4237">
          
          
          <code class="ruby">  # Return whether the provided `only` specification is evaluated as an allow</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4238">
          
          
          <code class="ruby">  # (and not as a deny).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4239">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4240">
          <span class="hits">1</span>
          
          <code class="ruby">  def selected_by_only?(only, verbose)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4241">
          
          
          <code class="ruby">    selected = if only.is_a?(Hash) # Evaluate `only` has a Hash.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4242">
          
          
          <code class="ruby">                 wants_features = only.key?(:features)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4243">
          
          
          <code class="ruby">                 wants_vars = only.key?(:vars)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4244">
          
          
          <code class="ruby">                 if wants_features</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4245">
          
          
          <code class="ruby">                   feat_ok = only[:features].any? do |feature|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4246">
          
          
          <code class="ruby">                     case feature</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4247">
          
          
          <code class="ruby">                     when Array then feature.all? { |f| has_feature?(f) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4248">
          
          
          <code class="ruby">                     else has_feature?(feature)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4249">
          
          
          <code class="ruby">                     end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4250">
          
          
          <code class="ruby">                   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4251">
          
          
          <code class="ruby">                 else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4252">
          
          
          <code class="ruby">                   feat_ok = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4253">
          
          
          <code class="ruby">                 end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4254">
          
          
          <code class="ruby">                 vars_ok = if wants_vars</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4255">
          
          
          <code class="ruby">                             only[:vars].any? do |var|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4256">
          
          
          <code class="ruby">                               !get_var(var, single_match: false).nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4257">
          
          
          <code class="ruby">                             end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4258">
          
          
          <code class="ruby">                           else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4259">
          
          
          <code class="ruby">                             true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4260">
          
          
          <code class="ruby">                           end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4262">
          
          
          <code class="ruby">                 (!wants_features &amp;&amp; !wants_vars) || (feat_ok &amp;&amp; vars_ok)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4263">
          
          
          <code class="ruby">               elsif only.is_a?(String) # Evaluate `only` as a logic expression.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4264">
          
          
          <code class="ruby">                 Fizzy::LogicParser.new.parse(self, only)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4265">
          
          
          <code class="ruby">               elsif only.nil? # By default, it&#39;s selected.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4266">
          
          
          <code class="ruby">                 true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4267">
          
          
          <code class="ruby">               else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4268">
          
          
          <code class="ruby">                 error(&quot;`#{spec[:name]}` has invalid `only`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4269">
          
          
          <code class="ruby">               end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4270">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4271">
          
          
          <code class="ruby">    if verbose</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4272">
          
          
          <code class="ruby">      if selected</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4273">
          
          
          <code class="ruby">        if only.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4274">
          
          
          <code class="ruby">          info(&quot; ↳ &quot;, &quot;#{✔} `only` is empty.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4275">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4276">
          
          
          <code class="ruby">          info(&quot; ↳ &quot;, &quot;#{✔} `only` is present and satisfied.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4277">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4278">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4279">
          
          
          <code class="ruby">        info(&quot; ↳ &quot;, &quot;#{✘} `only` didn&#39;t match.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4280">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4281">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4282">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4283">
          
          
          <code class="ruby">    selected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4284">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4285">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4286">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4287">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────── Elements ← Meta ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4288">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4289">
          
          
          <code class="ruby"># Manage elements declared in the meta file.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4290">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4291">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Meta::Elements</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4292">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4293">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Execution</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4294">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4295">
          
          
          <code class="ruby">  # Return a list of functions capable to apply modifications on the system</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4296">
          
          
          <code class="ruby">  # based on the current elements configuration instance.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4297">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4298">
          
          
          <code class="ruby">  # In particular, an applier work for each element installed.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4299">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4300">
          <span class="hits">1</span>
          
          <code class="ruby">  def elements_appliers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4301">
          
          
          <code class="ruby">    [lambda { |elem| # Create parent directories.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4302">
          
          
          <code class="ruby">       elem[:fs_maps].each do |m|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4303">
          
          
          <code class="ruby">         parent_dir = m[:dst_path].dirname</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4304">
          
          
          <code class="ruby">         unless parent_dir.directory?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4305">
          
          
          <code class="ruby">           exec_cmd(&quot;mkdir -p #{parent_dir.shell_escape}&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4306">
          
          
          <code class="ruby">                    as_su: !existing_dir(parent_dir))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4307">
          
          
          <code class="ruby">         end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4308">
          
          
          <code class="ruby">       end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4309">
          
          
          <code class="ruby">     },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4310">
          
          
          <code class="ruby">     lambda { |elem| # Create a symlink for each elements&#39; `src_path`.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4311">
          
          
          <code class="ruby">       elem[:fs_maps].each do |m|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4312">
          
          
          <code class="ruby">         tell(&quot;  {m{#{m[:src_path]}}} ← {m{#{m[:dst_path]}}}&quot;) if @verbose</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4313">
          
          
          <code class="ruby">         cmd = &quot;ln -s&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4314">
          
          
          <code class="ruby">         should_link = if m[:dst_path].file?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4315">
          
          
          <code class="ruby">                         if m[:dst_path].realpath != m[:src_path]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4316">
          
          
          <code class="ruby">                           cmd &lt;&lt; &quot; -f&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4317">
          
          
          <code class="ruby">                           ask(&quot;The destination file `#{m[:dst_path]}` &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4318">
          
          
          <code class="ruby">                               &quot;already exists. Overwrite&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4319">
          
          
          <code class="ruby">                         else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4320">
          
          
          <code class="ruby">                           false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4321">
          
          
          <code class="ruby">                         end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4322">
          
          
          <code class="ruby">                       elsif m[:dst_path].directory?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4323">
          
          
          <code class="ruby">                         if ask(&quot;The destination file `#{m[:dst_path]}` &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4324">
          
          
          <code class="ruby">                                &quot;is a directory. Delete it&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4325">
          
          
          <code class="ruby">                           exec_cmd(&quot;rm -Rf #{m[:dst_path]}&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4326">
          
          
          <code class="ruby">                                    as_su: !existing_dir(m[:dst_path].dirname))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4327">
          
          
          <code class="ruby">                         end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4328">
          
          
          <code class="ruby">                       else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4329">
          
          
          <code class="ruby">                         # Link does not exist yet.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4330">
          
          
          <code class="ruby">                         true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4331">
          
          
          <code class="ruby">                       end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4333">
          
          
          <code class="ruby">         next unless should_link</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4334">
          
          
          <code class="ruby">         cmd &lt;&lt; &quot; #{m[:src_path].shell_escape}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4335">
          
          
          <code class="ruby">         cmd &lt;&lt; &quot; #{m[:dst_path].shell_escape}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4336">
          
          
          <code class="ruby">         exec_cmd(cmd, as_su: !existing_dir(m[:dst_path].dirname))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4337">
          
          
          <code class="ruby">       end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4338">
          
          
          <code class="ruby">     },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4339">
          
          
          <code class="ruby">     lambda { |elem| # Change perms of the instantiated files (if specified).</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4340">
          
          
          <code class="ruby">       if elem.key?(:perms)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4341">
          
          
          <code class="ruby">         elem[:fs_maps].each do |m|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4342">
          
          
          <code class="ruby">           if @verbose</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4343">
          
          
          <code class="ruby">             tell(&quot;Changing permissions of `{m{#{m[:src_path]}}}` to &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4344">
          
          
          <code class="ruby">                  &quot;`{m{#{elem[:perms]}}}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4345">
          
          
          <code class="ruby">           end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4346">
          
          
          <code class="ruby">           perms = elem[:perms].shell_escape</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4347">
          
          
          <code class="ruby">           src_path = m[:src_path].shell_escape</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4348">
          
          
          <code class="ruby">           exec_cmd(&quot;chmod #{perms} #{src_path}&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4349">
          
          
          <code class="ruby">                    as_su: !File.owned?(m[:src_path]))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4350">
          
          
          <code class="ruby">         end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4351">
          
          
          <code class="ruby">       end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4352">
          
          
          <code class="ruby">     }]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4353">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4354">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4355">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4356">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────── Base ← Sync ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4357">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4358">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::Sync</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4359">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4360">
          <span class="hits">1</span>
          
          <code class="ruby">  class &lt;&lt; self</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4361">
          <span class="hits">1</span>
          
          <code class="ruby">    include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4362">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4363">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4364">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.available</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4365">
          
          
          <code class="ruby">    [ Fizzy::Sync::Local,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4366">
          
          
          <code class="ruby">      Fizzy::Sync::Git</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4367">
          
          
          <code class="ruby">    ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4368">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4369">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4370">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.others(subject)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4371">
          
          
          <code class="ruby">    subject = subject.class unless subject.is_a?(Class)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4372">
          
          
          <code class="ruby">    result  = available</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4373">
          
          
          <code class="ruby">    result.delete(subject)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4374">
          
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4375">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4376">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4377">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.enabled(local_dir_path, remote_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4378">
          
          
          <code class="ruby">    available.map    { |e| e.new(local_dir_path, remote_url) }.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4379">
          
          
          <code class="ruby">              select { |e| e.enabled? }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4380">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4381">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4382">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.selected(local_dir_path, remote_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4383">
          
          
          <code class="ruby">    enabled(local_dir_path, remote_url).last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4384">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4385">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4386">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.perform(local_dir_path, remote_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4387">
          
          
          <code class="ruby">    synchronizer = selected(local_dir_path, remote_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4388">
          
          
          <code class="ruby">    tell(&quot;{c{Using synchronizer: `{m{#{synchronizer.name}}}`.}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4389">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4390">
          
          
          <code class="ruby">    status   = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4391">
          
          
          <code class="ruby">    status &amp;&amp;= synchronizer.update_local  if synchronizer.remote_changed?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4392">
          
          
          <code class="ruby">    status &amp;&amp;= synchronizer.update_remote if synchronizer.local_changed?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4393">
          
          
          <code class="ruby">    status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4394">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4395">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4396">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4397">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::Sync::Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4398">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4399">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4400">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4401">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4402">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4403">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(name, local_dir_path, remote_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4404">
          
          
          <code class="ruby">    must &quot;synchronizer name&quot;,    name,           be: :not_nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4405">
          
          
          <code class="ruby">    must &quot;local directory path&quot;, local_dir_path, be: Pathname</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4406">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4407">
          
          
          <code class="ruby">    @name           = name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4408">
          
          
          <code class="ruby">    @local_dir_path = local_dir_path.expand_variables.expand_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4409">
          
          
          <code class="ruby">    @remote_url     = remote_url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4410">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4411">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4412">
          
          
          <code class="ruby">  # Check if the current synchronizer is enabled.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4413">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4414">
          
          
          <code class="ruby">  # Note: inheritors should call the `super` method.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4415">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4416">
          
          
          <code class="ruby">  # Example:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4417">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4418">
          
          
          <code class="ruby">  #   def enabled?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4419">
          
          
          <code class="ruby">  #     my_policy || super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4420">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4421">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4422">
          <span class="hits">1</span>
          
          <code class="ruby">  def enabled?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4423">
          
          
          <code class="ruby">    return false if !@remote_url.nil? &amp;&amp;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4424">
          
          
          <code class="ruby">                    Fizzy::Sync.others(self).any? { |e|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4425">
          
          
          <code class="ruby">                      @remote_url.to_s.start_with?(&quot;#{e.name}:&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4426">
          
          
          <code class="ruby">                    }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4427">
          
          
          <code class="ruby">    return true if default? &amp;&amp; Fizzy::Sync.others(self).</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4428">
          
          
          <code class="ruby">      map  { |e| e.new(@local_dir_path, @remote_url) }.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4429">
          
          
          <code class="ruby">      all? { |e| !e.enabled? }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4430">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4431">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4432">
          
          
          <code class="ruby">  # Check if the current synchronizer is the default synchronizer.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4433">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4434">
          <span class="hits">1</span>
          
          <code class="ruby">  def default?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4435">
          
          
          <code class="ruby">    self.class == Fizzy::Sync.available.last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4436">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4437">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4438">
          
          
          <code class="ruby">  # Update local from the remote.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4439">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4440">
          <span class="hits">1</span>
          
          <code class="ruby">  abstract_method :update_local</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4441">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4442">
          
          
          <code class="ruby">  # Update remote from local.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4443">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4444">
          <span class="hits">1</span>
          
          <code class="ruby">  abstract_method :update_remote</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4445">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4446">
          
          
          <code class="ruby">  # Check if local is changed, and now is different from latest remote state.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4447">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4448">
          <span class="hits">1</span>
          
          <code class="ruby">  abstract_method :local_changed?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4449">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4450">
          
          
          <code class="ruby">  # Check if remote is changed, and now is different from latest local state.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4451">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4452">
          <span class="hits">1</span>
          
          <code class="ruby">  abstract_method :remote_changed?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4453">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4454">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4455">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4456">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────────── Local ← Sync ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4457">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4458">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::Sync::Local &lt; Fizzy::Sync::Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4459">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4460">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(local_dir_path, remote_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4461">
          
          
          <code class="ruby">    super(:local, local_dir_path, remote_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4462">
          
          
          <code class="ruby">    @remote_path = @remote_url.nil? ? nil : Pathname.new(@remote_url)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4463">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4464">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4465">
          
          
          <code class="ruby">  # Check if the synchronizer is enabled.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4466">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4467">
          <span class="hits">1</span>
          
          <code class="ruby">  def enabled?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4468">
          
          
          <code class="ruby">      ( super ||</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4469">
          
          
          <code class="ruby">        !@remote_path.nil? &amp;&amp; @remote_path.directory? ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4470">
          
          
          <code class="ruby">        local_valid_repo?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4471">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4472">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4473">
          
          
          <code class="ruby">  # Update local from the remote.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4474">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4475">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_local</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4476">
          
          
          <code class="ruby">    # TODO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4477">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4478">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4479">
          
          
          <code class="ruby">  # Update remote from local.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4480">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4481">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_remote</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4482">
          
          
          <code class="ruby">    # TODO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4483">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4484">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4485">
          
          
          <code class="ruby">  # Check if local is changed, and now is different from latest remote state.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4486">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4487">
          <span class="hits">1</span>
          
          <code class="ruby">  def local_changed?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4488">
          
          
          <code class="ruby">    # TODO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4489">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4490">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4491">
          
          
          <code class="ruby">  # Check if remote is changed, and now is different from latest local state.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4492">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4493">
          <span class="hits">1</span>
          
          <code class="ruby">  def remote_changed?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4494">
          
          
          <code class="ruby">    # TODO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4495">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4496">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4497">
          
          
          <code class="ruby">  # Check if the local directory holds a valid local repository.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4498">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4499">
          <span class="hits">1</span>
          
          <code class="ruby">  def local_valid_repo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4500">
          
          
          <code class="ruby">    @local_dir_path.directory?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4501">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4502">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4503">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4504">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4505">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────────── Git ← Sync ← Core ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4506">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4507">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::Sync::Git &lt; Fizzy::Sync::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4508">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4509">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Execution</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4510">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Filesystem</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4511">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4512">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(local_dir_path, remote_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4513">
          
          
          <code class="ruby">    super(:git, local_dir_path, remote_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4514">
          
          
          <code class="ruby">    @remote_normalized_url = normalize_url(@remote_url)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4515">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4516">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4517">
          
          
          <code class="ruby">  # Check if the synchronizer is enabled.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4518">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4519">
          <span class="hits">1</span>
          
          <code class="ruby">  def enabled?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4520">
          
          
          <code class="ruby">    (super ||</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4521">
          
          
          <code class="ruby">      (!@remote_url.nil? &amp;&amp; @remote_url.to_s.start_with?(&quot;#{@name}:&quot;)) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4522">
          
          
          <code class="ruby">      local_valid_repo?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4523">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4524">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4525">
          
          
          <code class="ruby">  # Update local from remote.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4526">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4527">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_local</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4528">
          
          
          <code class="ruby">    if local_valid_repo?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4529">
          
          
          <code class="ruby">      # Update existing local from remote, i.e. perform `git pull`.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4530">
          
          
          <code class="ruby">      tell(&quot;{b{Syncing from `{m{origin}}` to `{m{local}}`.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4531">
          
          
          <code class="ruby">      status   = perform_commit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4532">
          
          
          <code class="ruby">      status &amp;&amp;= perform_pull</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4533">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4534">
          
          
          <code class="ruby">      # Update non-existing local from remote, i.e. perform `git clone`.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4535">
          
          
          <code class="ruby">      perform_clone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4536">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4537">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4538">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4539">
          
          
          <code class="ruby">  # Update remote from local.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4540">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4541">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_remote</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4542">
          
          
          <code class="ruby">    tell(&quot;{b{Syncing from `{m{local}}` to `{m{origin}}`.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4543">
          
          
          <code class="ruby">    status   = perform_commit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4544">
          
          
          <code class="ruby">    status &amp;&amp;= perform_push</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4545">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4546">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4547">
          
          
          <code class="ruby">  # Check if local is changed, and now is different from latest remote state.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4548">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4549">
          <span class="hits">1</span>
          
          <code class="ruby">  def local_changed?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4550">
          
          
          <code class="ruby">    tell(&quot;{b{Checking if local repository is changed.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4551">
          
          
          <code class="ruby">    return false unless local_valid_repo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4552">
          
          
          <code class="ruby">    return true  if     working_tree_changes?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4553">
          
          
          <code class="ruby">    return true  if     perform_fetch &amp;&amp; should_push?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4554">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4555">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4556">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4557">
          
          
          <code class="ruby">  # Check if remote is changed, and now is different from latest local state.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4558">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4559">
          <span class="hits">1</span>
          
          <code class="ruby">  def remote_changed?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4560">
          
          
          <code class="ruby">    tell(&quot;{b{Checking if remote repository is changed.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4561">
          
          
          <code class="ruby">    return true unless local_valid_repo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4562">
          
          
          <code class="ruby">    return true if     perform_fetch &amp;&amp; should_pull?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4563">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4564">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4565">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4566">
          
          
          <code class="ruby">  # Normalize the remote git URL.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4567">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4568">
          <span class="hits">1</span>
          
          <code class="ruby">  def normalize_url(url, default_protocol: :ssh)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4569">
          
          
          <code class="ruby">    return nil if url.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4570">
          
          
          <code class="ruby">    url = url.to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4571">
          
          
          <code class="ruby">    protocols = %i[https ssh]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4572">
          
          
          <code class="ruby">    url = url.gsub(/^#{@name}:/, &quot;&quot;) # Remove VCS name prefix (optional).</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4573">
          
          
          <code class="ruby">    regexp = %r{</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4574">
          
          
          <code class="ruby">      ^</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4575">
          
          
          <code class="ruby">      (?&lt;protocol&gt;#{protocols.map { |p| &quot;#{p}:&quot; }.join(&quot;|&quot;)})?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4576">
          
          
          <code class="ruby">      (?&lt;username&gt;[a-z0-9\-_]+)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4577">
          
          
          <code class="ruby">      \/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4578">
          
          
          <code class="ruby">      (?&lt;repository&gt;[a-z0-9\-_]+)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4579">
          
          
          <code class="ruby">      $</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4580">
          
          
          <code class="ruby">    }xi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4581">
          
          
          <code class="ruby">    md = url.match(regexp)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4582">
          
          
          <code class="ruby">    return url unless md</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4583">
          
          
          <code class="ruby">    protocol = (md[:protocol] || default_protocol).to_s.gsub(/:$/, &quot;&quot;).to_sym</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4584">
          
          
          <code class="ruby">    case protocol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4585">
          
          
          <code class="ruby">    when :ssh   then &quot;git@github.com:#{md[:username]}/#{md[:repository]}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4586">
          
          
          <code class="ruby">    when :https then &quot;https://github.com/#{md[:username]}/#{md[:repository]}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4587">
          
          
          <code class="ruby">    else        error(&quot;Invalid protocol for `{m{#{url}}}`: `{m{#{protocol}}}` not in `{m{[#{protocols.join(&quot;, &quot;)}]}}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4588">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4589">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4590">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :normalize_url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4591">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4592">
          
          
          <code class="ruby">  # Check if the local directory holds a valid git repository.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4593">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4594">
          <span class="hits">1</span>
          
          <code class="ruby">  def local_valid_repo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4595">
          
          
          <code class="ruby">    @local_dir_path.directory? &amp;&amp; @local_dir_path.join(&quot;.git&quot;).directory?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4596">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4597">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :local_valid_repo?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4598">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4599">
          
          
          <code class="ruby">  # Get the Working Tree (local) changes.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4600">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4601">
          <span class="hits">1</span>
          
          <code class="ruby">  def working_tree_changes</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4602">
          
          
          <code class="ruby">    error(&quot;Invalid local repo: `#{@local_dir_path}`.&quot;) unless local_valid_repo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4603">
          
          
          <code class="ruby">    FileUtils.cd(@local_dir_path) do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4604">
          
          
          <code class="ruby">      return `git status -uall --porcelain`.strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4605">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4606">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4607">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :working_tree_changes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4608">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4609">
          
          
          <code class="ruby">  # Check if there are some changes in the Working Tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4610">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4611">
          <span class="hits">1</span>
          
          <code class="ruby">  def working_tree_changes?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4612">
          
          
          <code class="ruby">    !working_tree_changes.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4613">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4614">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :working_tree_changes?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4615">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4616">
          
          
          <code class="ruby">  # Get a `Hash` containing information about the local and remote repository.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4617">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4618">
          <span class="hits">1</span>
          
          <code class="ruby">  def info</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4619">
          
          
          <code class="ruby">    error &quot;Invalid local repo: `#{@local_dir_path}`&quot; unless local_valid_repo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4620">
          
          
          <code class="ruby">    FileUtils.cd(@local_dir_path) do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4621">
          
          
          <code class="ruby">      local = `git rev-parse @ 2&gt; /dev/null`.strip</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4622">
          
          
          <code class="ruby">      local = nil unless $CHILD_STATUS.success?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4623">
          
          
          <code class="ruby">      remote = `git rev-parse @{u} 2&gt; /dev/null`.strip</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4624">
          
          
          <code class="ruby">      remote = nil unless $CHILD_STATUS.success?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4625">
          
          
          <code class="ruby">      base = `git merge-base @ @{u} 2&gt; /dev/null`.strip</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4626">
          
          
          <code class="ruby">      base = nil unless $CHILD_STATUS.success?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4627">
          
          
          <code class="ruby">      return { local: local, remote: remote, base: base }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4628">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4629">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4630">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :info</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4631">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4632">
          
          
          <code class="ruby">  # Check if a `pull` operation is needed.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4633">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4634">
          <span class="hits">1</span>
          
          <code class="ruby">  def should_pull?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4635">
          
          
          <code class="ruby">    info[:remote] != info[:base]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4636">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4637">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :should_pull?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4638">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4639">
          
          
          <code class="ruby">  # Check if a `push` operation is needed.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4640">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4641">
          <span class="hits">1</span>
          
          <code class="ruby">  def should_push?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4642">
          
          
          <code class="ruby">    info[:local] != info[:base]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4643">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4644">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :should_push?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4645">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4646">
          
          
          <code class="ruby">  # Get the list of the available remote git repositories.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4647">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4648">
          <span class="hits">1</span>
          
          <code class="ruby">  def remotes</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4649">
          
          
          <code class="ruby">    error &quot;Invalid local repo: `#{@local_dir_path}`&quot; unless local_valid_repo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4650">
          
          
          <code class="ruby">    FileUtils.cd(@local_dir_path) do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4651">
          
          
          <code class="ruby">      return `git remote`.split(/\W+/).reject(&amp;:empty?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4652">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4653">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4654">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :remotes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4655">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4656">
          
          
          <code class="ruby">  # Get the list of the available git branches.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4657">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4658">
          <span class="hits">1</span>
          
          <code class="ruby">  def branches</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4659">
          
          
          <code class="ruby">    error &quot;Invalid local repo: `#{@local_dir_path}`&quot; unless local_valid_repo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4660">
          
          
          <code class="ruby">    FileUtils.cd(@local_dir_path) do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4661">
          
          
          <code class="ruby">      return `git branch`.split(/\W+/).reject(&amp;:empty?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4662">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4663">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4664">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :branches</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4665">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4666">
          
          
          <code class="ruby">  # Add the changes from the Working Tree to the stage.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4667">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4668">
          <span class="hits">1</span>
          
          <code class="ruby">  def perform_add(files: nil, interactive: false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4669">
          
          
          <code class="ruby">    error &quot;Invalid files `#{files}`.&quot; unless files.nil? || files.is_a?(Array)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4670">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4671">
          
          
          <code class="ruby">    cmd = %w[git add]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4672">
          
          
          <code class="ruby">    cmd &lt;&lt; &quot;-i&quot;  if     interactive</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4673">
          
          
          <code class="ruby">    cmd &lt;&lt; &quot;-A&quot;  if     files.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4674">
          
          
          <code class="ruby">    cmd &lt;&lt; files unless files.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4675">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4676">
          
          
          <code class="ruby">    error(&quot;Invalid local repo: `#{@local_dir_path}`&quot;) unless local_valid_repo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4677">
          
          
          <code class="ruby">    exec_cmd(cmd, as_su: !existing_dir(@local_dir_path), chdir: @local_dir_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4678">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4679">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :perform_add</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4680">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4681">
          
          
          <code class="ruby">  # Commit the changes in the Working Tree.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4682">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4683">
          <span class="hits">1</span>
          
          <code class="ruby">  def perform_commit(message: nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4684">
          
          
          <code class="ruby">    status = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4685">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4686">
          
          
          <code class="ruby">    if working_tree_changes?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4687">
          
          
          <code class="ruby">      tell(&quot;{c{The configuration has the following local changes:\n{w{#{working_tree_changes}}}.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4688">
          
          
          <code class="ruby">      if message || ask(&quot;Do you want to commit them all&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4689">
          
          
          <code class="ruby">        status &amp;&amp;= perform_add # Add from Working Tree to stage.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4690">
          
          
          <code class="ruby">        if status</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4691">
          
          
          <code class="ruby">          tell(&quot;{b{Performing commit.}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4692">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4693">
          
          
          <code class="ruby">          message ||= ask(&quot;Type the commit message&quot;, type: :string)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4694">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4695">
          
          
          <code class="ruby">          cmd = [&quot;git&quot;, &quot;commit&quot;, &quot;-a&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4696">
          
          
          <code class="ruby">          cmd &lt;&lt; &quot;--allow-empty-message&quot; if     message.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4697">
          
          
          <code class="ruby">          cmd += [&quot;-m&quot;, message]         unless message.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4698">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4699">
          
          
          <code class="ruby">          error(&quot;Invalid local repo: `#{@local_dir_path}`&quot;) unless local_valid_repo?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4700">
          
          
          <code class="ruby">          status &amp;&amp;= exec_cmd(cmd,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4701">
          
          
          <code class="ruby">                              as_su: !existing_dir(@local_dir_path),</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4702">
          
          
          <code class="ruby">                              chdir: @local_dir_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4703">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4704">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4705">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4706">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4707">
          
          
          <code class="ruby">    status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4708">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4709">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :perform_commit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4710">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4711">
          <span class="hits">1</span>
          
          <code class="ruby">  def perform_fetch(remote: nil, branch: nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4712">
          
          
          <code class="ruby">    error(&quot;Invalid remote `#{remote}`.&quot;) if remote &amp;&amp; !remotes.include?(remote)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4713">
          
          
          <code class="ruby">    error(&quot;Invalid branch `#{branch}`.&quot;) if branch &amp;&amp; !branches.include?(branch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4714">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4715">
          
          
          <code class="ruby">    tell(&quot;{b{Fetching information from remote.}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4716">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4717">
          
          
          <code class="ruby">    cmd = %w[git fetch]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4718">
          
          
          <code class="ruby">    cmd &lt;&lt; remote.shell_escape unless remote.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4719">
          
          
          <code class="ruby">    cmd &lt;&lt; branch.shell_escape unless branch.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4720">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4721">
          
          
          <code class="ruby">    error(&quot;Invalid local repo: `#{@local_dir_path}`&quot;) unless local_valid_repo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4722">
          
          
          <code class="ruby">    exec_cmd(cmd, as_su: !existing_dir(@local_dir_path), chdir: @local_dir_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4723">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4724">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :perform_fetch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4725">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4726">
          <span class="hits">1</span>
          
          <code class="ruby">  def perform_clone(recursive: true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4727">
          
          
          <code class="ruby">    tell(&quot;{b{Syncing from remote repository: `{m{#{@remote_normalized_url}}`.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4728">
          
          
          <code class="ruby">    error(&quot;Invalid url: can&#39;t be empty.&quot;) if @remote_normalized_url.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4729">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4730">
          
          
          <code class="ruby">    parent_dir = @local_dir_path.dirname</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4731">
          
          
          <code class="ruby">    name       = @local_dir_path.basename</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4732">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4733">
          
          
          <code class="ruby">    cmd = %w[git clone]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4734">
          
          
          <code class="ruby">    cmd &lt;&lt; &quot;--recursive&quot; if recursive</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4735">
          
          
          <code class="ruby">    cmd &lt;&lt; @remote_normalized_url.shell_escape</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4736">
          
          
          <code class="ruby">    cmd &lt;&lt; name.shell_escape</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4737">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4738">
          
          
          <code class="ruby">    exec_cmd(cmd, as_su: !existing_dir(parent_dir), chdir: parent_dir)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4739">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4740">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :perform_clone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4741">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4742">
          
          
          <code class="ruby">  # Pull from the provided `remote` in the provided `branch`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4743">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4744">
          <span class="hits">1</span>
          
          <code class="ruby">  def perform_pull(remote: nil, branch: nil, with_submodules: true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4745">
          
          
          <code class="ruby">    error(&quot;Invalid remote `#{remote}`.&quot;) if remote &amp;&amp; !remotes.include?(remote)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4746">
          
          
          <code class="ruby">    error(&quot;Invalid branch `#{branch}`.&quot;) if branch &amp;&amp; !branches.include?(branch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4747">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4748">
          
          
          <code class="ruby">    status = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4749">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4750">
          
          
          <code class="ruby">    if should_pull?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4751">
          
          
          <code class="ruby">      tell(&quot;{b{Performing pull.}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4752">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4753">
          
          
          <code class="ruby">      cmd = %w[git pull]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4754">
          
          
          <code class="ruby">      cmd &lt;&lt; remote.shell_escape unless remote.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4755">
          
          
          <code class="ruby">      cmd &lt;&lt; branch.shell_escape unless branch.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4756">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4757">
          
          
          <code class="ruby">      error(&quot;Invalid local repo: `{m{#{@local_dir_path}}}`.&quot;) unless local_valid_repo?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4758">
          
          
          <code class="ruby">      status = exec_cmd(cmd,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4759">
          
          
          <code class="ruby">                        as_su: !existing_dir(@local_dir_path),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4760">
          
          
          <code class="ruby">                        chdir: @local_dir_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4761">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4762">
          
          
          <code class="ruby">      if with_submodules</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4763">
          
          
          <code class="ruby">        status &amp;&amp;= exec_cmd(%w[git submodule update --recursive],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4764">
          
          
          <code class="ruby">                            as_su: !existing_dir(@local_dir_path),</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4765">
          
          
          <code class="ruby">                            chdir: @local_dir_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4766">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4767">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4768">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4769">
          
          
          <code class="ruby">    status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4770">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4771">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :perform_pull</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4772">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4773">
          
          
          <code class="ruby">  # Push to the provided `remote` in the provided `branch`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4774">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4775">
          <span class="hits">1</span>
          
          <code class="ruby">  def perform_push(remote: nil, branch: nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4776">
          
          
          <code class="ruby">    error(&quot;Invalid remote `#{remote}`&quot;) if remote &amp;&amp; !remotes.include?(remote)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4777">
          
          
          <code class="ruby">    error(&quot;Invalid branch `#{branch}`&quot;) if branch &amp;&amp; !branches.include?(branch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4778">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4779">
          
          
          <code class="ruby">    status = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4780">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4781">
          
          
          <code class="ruby">    if should_push?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4782">
          
          
          <code class="ruby">      tell(&quot;{b{Pushing to remote.}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4783">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4784">
          
          
          <code class="ruby">      cmd = %w[git push]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4785">
          
          
          <code class="ruby">      cmd &lt;&lt; remote.shell_escape unless remote.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4786">
          
          
          <code class="ruby">      cmd &lt;&lt; branch.shell_escape unless branch.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4787">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4788">
          
          
          <code class="ruby">      error(&quot;Invalid local repo: `{m{#{@local_dir_path}}}`.&quot;) unless local_valid_repo?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4789">
          
          
          <code class="ruby">      status &amp;&amp;= exec_cmd(cmd,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4790">
          
          
          <code class="ruby">                          as_su: !existing_dir(@local_dir_path),</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4791">
          
          
          <code class="ruby">                          chdir: @local_dir_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4792">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4793">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4794">
          
          
          <code class="ruby">    status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4795">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4796">
          <span class="hits">1</span>
          
          <code class="ruby">  protected :perform_push</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4797">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4798">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4799">
          
          
          <code class="ruby"># ───────────────────────────────────────────────── Lastpass ← Filter ← Depot ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4800">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4801">
          
          
          <code class="ruby">Fizzy::Vars::Filter.define(:lpass, description: &quot;&quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4802">
          
          
          <code class="ruby">LastPass filter allows to retrieve informations stored in a lastpass account</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4803">
          
          
          <code class="ruby">As arguments you can pass:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4804">
          
          
          <code class="ruby">- #0: A unique name or identifier of the element to be retrieved</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4805">
          
          
          <code class="ruby">- #1 [optional]: What information should be retrieved from the element</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4806">
          
          
          <code class="ruby">                 (defaults to the element&#39;s password)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4807">
          <span class="hits">1</span>
          
          <code class="ruby">&quot;&quot;&quot;) do |args|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4808">
          
          
          <code class="ruby">  args = args.split_by_separator</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4809">
          
          
          <code class="ruby">  name = args[0].shell_escape</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4810">
          
          
          <code class="ruby">  what = args[1] || :password</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4811">
          
          
          <code class="ruby">  what = &quot;--#{what}&quot; unless what.to_s.start_with?(&quot;--&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4812">
          
          
          <code class="ruby">  `lpass show --color=never #{what} #{name}`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4813">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4814">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4815">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────────────────────────── Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4816">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4817">
          
          
          <code class="ruby"># Namespace for fizzy commandline interface.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4818">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4819">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::CLI</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4820">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4821">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4822">
          
          
          <code class="ruby"># ────────────────────────────────────────────────────────── Known args ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4823">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4824">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4825">
          
          
          <code class="ruby"># Definition of specs for known arguments and relative utilities.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4826">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4827">
          <span class="hits">1</span>
          
          <code class="ruby">module Fizzy::CLI</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4828">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4829">
          
          
          <code class="ruby">  # Specs for known arguments.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4830">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4831">
          <span class="hits">1</span>
          
          <code class="ruby">  KNOWN_ARGS = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4832">
          
          
          <code class="ruby">    run_mode: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4833">
          
          
          <code class="ruby">      desc: &quot;How fizzy will perform its operations, e.g. simulating them &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4834">
          
          
          <code class="ruby">        &quot;or not&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4835">
          
          
          <code class="ruby">      abbrev: &quot;R&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4836">
          
          
          <code class="ruby">      default: &quot;normal&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4837">
          
          
          <code class="ruby">      type: %i[normal dry]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4838">
          
          
          <code class="ruby">    },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4839">
          
          
          <code class="ruby">    fizzy_dir: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4840">
          
          
          <code class="ruby">      desc: &quot;Specify fizzy directory&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4841">
          
          
          <code class="ruby">      abbrev: &quot;D&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4842">
          
          
          <code class="ruby">      default: Fizzy::CFG.default_fizzy_dir,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4843">
          
          
          <code class="ruby">      type: Pathname</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4844">
          
          
          <code class="ruby">    },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4845">
          
          
          <code class="ruby">    cfg_url: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4846">
          
          
          <code class="ruby">      desc: &quot;The URL to the repository holding configuration.&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4847">
          
          
          <code class="ruby">      abbrev: &quot;U&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4848">
          
          
          <code class="ruby">      required: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4849">
          
          
          <code class="ruby">    },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4850">
          
          
          <code class="ruby">    cfg_name: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4851">
          
          
          <code class="ruby">      desc: &quot;The name of the configuration that should be used.&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4852">
          
          
          <code class="ruby">      abbrev: &quot;C&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4853">
          
          
          <code class="ruby">      required: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4854">
          
          
          <code class="ruby">    },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4855">
          
          
          <code class="ruby">    inst_name: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4856">
          
          
          <code class="ruby">      desc: &quot;The name for the configuration instance to be used.&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4857">
          
          
          <code class="ruby">      abbrev: &quot;I&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4858">
          
          
          <code class="ruby">      required: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4859">
          
          
          <code class="ruby">    },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4860">
          
          
          <code class="ruby">    vars_name: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4861">
          
          
          <code class="ruby">      desc: &quot;The name for the variables file to be used.&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4862">
          
          
          <code class="ruby">      abbrev: &quot;V&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4863">
          
          
          <code class="ruby">      required: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4864">
          
          
          <code class="ruby">    },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4865">
          
          
          <code class="ruby">    meta_name: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4866">
          
          
          <code class="ruby">      desc: &quot;The name of the meta file.&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4867">
          
          
          <code class="ruby">      abbrev: &quot;M&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4868">
          
          
          <code class="ruby">      default: Fizzy::CFG.default_meta_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4869">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4870">
          
          
          <code class="ruby">  }.freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4871">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4872">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4873">
          
          
          <code class="ruby">  # Get specs for known fizzy command-line arguments.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4874">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4875">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.known_args(*names, **kwnames)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="4876">
          <span class="hits">13</span>
          
          <code class="ruby">    KNOWN_ARGS.select do |name, info|</code>
        </li>
      
        <li class="covered" data-hits="91" data-linenumber="4877">
          <span class="hits">91</span>
          
          <code class="ruby">      next true if names.include?(name)</code>
        </li>
      
        <li class="covered" data-hits="59" data-linenumber="4878">
          <span class="hits">59</span>
          
          <code class="ruby">      kwnames.each do |kwname, kwinfo|</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="4879">
          <span class="hits">10</span>
          
          <code class="ruby">        info.deep_merge!(kwinfo) if name == kwname</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="4880">
          <span class="hits">10</span>
          
          <code class="ruby">        next true if name == kwname</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4881">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="59" data-linenumber="4882">
          <span class="hits">59</span>
          
          <code class="ruby">      next false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4883">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4884">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4885">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4886">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4887">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────────────── Main ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4888">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4889">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4890">
          
          
          <code class="ruby"># Main of fizzy CLI.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4891">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4892">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::CLI::Main</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4893">
          <span class="hits">1</span>
          
          <code class="ruby">  include Singleton</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4894">
          <span class="hits">1</span>
          
          <code class="ruby">  extend Forwardable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4895">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4896">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :parser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4897">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4898">
          <span class="hits">1</span>
          
          <code class="ruby">  def_delegators :parser, :parse, :run, :tell_help, :help</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4899">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4900">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4901">
          <span class="hits">1</span>
          
          <code class="ruby">    @parser = Fizzy::ArgParse::RootCommandParser.new(&quot;fizzy&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4902">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4903">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4904">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_subcommand(subcommand)</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="4905">
          <span class="hits">18</span>
          
          <code class="ruby">    parser.on_command(/^#{subcommand.name}$/) do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4906">
          <span class="hits">2</span>
          
          <code class="ruby">      subcommand.run</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4907">
          <span class="hits">2</span>
          
          <code class="ruby">      false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4908">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="4909">
          <span class="hits">18</span>
          
          <code class="ruby">    parser.add_subcommand_parser(subcommand.parser)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4910">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4911">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4912">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4913">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────────────── Command ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4914">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4915">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4916">
          
          
          <code class="ruby"># Base class for CLI commands.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4917">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4918">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::CLI::Command</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4919">
          <span class="hits">1</span>
          
          <code class="ruby">  extend Forwardable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4920">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4921">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Environment</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4922">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Execution</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4923">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Filesystem</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4924">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Environment</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4925">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Execution</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4926">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Filesystem</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4927">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4928">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Vars</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4929">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Locals</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4930">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Meta::Info</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4931">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Meta::Elements</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4932">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::IO</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4933">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Vars</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4934">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Locals</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4935">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Meta::Info</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4936">
          <span class="hits">1</span>
          
          <code class="ruby">  include Fizzy::Meta::Elements</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4937">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4938">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :parser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4939">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4940">
          <span class="hits">1</span>
          
          <code class="ruby">  def_delegators :parser, :name, :options, :tell_help, :help</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4941">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4942">
          <span class="hits">1</span>
          
          <code class="ruby">  class &lt;&lt; self</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4943">
          <span class="hits">1</span>
          
          <code class="ruby">    def inherited(klass)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="4944">
          <span class="hits">9</span>
          
          <code class="ruby">      available.add(klass)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4945">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4946">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4947">
          <span class="hits">1</span>
          
          <code class="ruby">    def available</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4948">
          <span class="hits">14</span>
          
          <code class="ruby">      @available ||= Set.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4949">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4950">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4951">
          <span class="hits">1</span>
          
          <code class="ruby">    def command_name</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="4952">
          <span class="hits">37</span>
          
          <code class="ruby">      name.gsub(/^.*::/, &quot;&quot;).gsub(/Command$/, &quot;&quot;).downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4953">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4954">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4955">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4956">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(desc, spec = {})</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="4957">
          <span class="hits">19</span>
          
          <code class="ruby">    @parser = Fizzy::ArgParse::SubCommandParser.new(self.class.command_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4958">
          
          
          <code class="ruby">                                                    desc,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4959">
          
          
          <code class="ruby">                                                    spec)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4960">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4961">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4962">
          <span class="hits">1</span>
          
          <code class="ruby">  def run</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4963">
          
          
          <code class="ruby">    error(&quot;Abstract method called&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4964">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4965">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4966">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4967">
          
          
          <code class="ruby"># ────────────────────────────────────────────────────────── Cd ← Depot ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4968">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4969">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4970">
          
          
          <code class="ruby"># Fizzy command to show configuration details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4971">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4972">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::CLI::Cd &lt; Fizzy::CLI::Command</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4973">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4974">
          
          
          <code class="ruby">    super(&quot;Change directory to the configuration directory.&quot;,</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="4975">
          <span class="hits">3</span>
          
          <code class="ruby">          spec: Fizzy::CLI.known_args(:fizzy_dir, :cfg_name))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4976">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4977">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4978">
          <span class="hits">1</span>
          
          <code class="ruby">  def run</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4979">
          
          
          <code class="ruby">    paths = compute_paths</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4980">
          
          
          <code class="ruby">    dir_path = paths.cur_cfg || paths.cfg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4981">
          
          
          <code class="ruby">    change_dir(dir_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4982">
          
          
          <code class="ruby">    inform_user(dir_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4983">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4984">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4985">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4986">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4987">
          <span class="hits">1</span>
          
          <code class="ruby">  def compute_paths</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4988">
          
          
          <code class="ruby">    prepare_storage(options[:fizzy_dir],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4989">
          
          
          <code class="ruby">                    valid_meta:   false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4990">
          
          
          <code class="ruby">                    valid_inst:   false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4991">
          
          
          <code class="ruby">                    valid_cfg:    !options[:cfg_name].nil? &amp;&amp; :readonly,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4992">
          
          
          <code class="ruby">                    cur_cfg_name: options[:cfg_name])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4993">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4994">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4995">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4996">
          
          
          <code class="ruby">  # Change directory to the provided path, spawning a new sub-shell.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4997">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4998">
          <span class="hits">1</span>
          
          <code class="ruby">  def change_dir(dir_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4999">
          
          
          <code class="ruby">    tell(&quot;{c{Changing directory to: `#{dir_path}`.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5000">
          
          
          <code class="ruby">    FileUtils.cd(dir_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5001">
          
          
          <code class="ruby">    system(get_env!(:SHELL))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5002">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5003">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5004">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5005">
          
          
          <code class="ruby">  # Inform user about the change of directory.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5006">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5007">
          <span class="hits">1</span>
          
          <code class="ruby">  def inform_user(dir_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5008">
          
          
          <code class="ruby">    tell(&quot;{g{CD done in: `#{dir_path}`.}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5009">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5010">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5011">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5012">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────── Cleanup ← Depot ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5013">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5014">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5015">
          
          
          <code class="ruby"># Fizzy command to show fizzy version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5016">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5017">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::CLI::Cleanup &lt; Fizzy::CLI::Command</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5018">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5019">
          
          
          <code class="ruby">    super(&quot;Cleanup the fizzy storage.&quot;,</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5020">
          <span class="hits">2</span>
          
          <code class="ruby">          spec: Fizzy::CLI.known_args(:fizzy_dir))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5021">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5022">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5023">
          <span class="hits">1</span>
          
          <code class="ruby">  def run</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5024">
          
          
          <code class="ruby">    # Prepare paths for cleanup.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5025">
          
          
          <code class="ruby">    paths = prepare_storage(options[:fizzy_dir],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5026">
          
          
          <code class="ruby">                            valid_meta: false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5027">
          
          
          <code class="ruby">                            valid_cfg:  false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5028">
          
          
          <code class="ruby">                            valid_inst: false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5029">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5030">
          
          
          <code class="ruby">    # Perform cleanup.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5031">
          
          
          <code class="ruby">    status =</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5032">
          
          
          <code class="ruby">      if ask(&quot;Remove the fizzy root directory (`#{paths.root}`)&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5033">
          
          
          <code class="ruby">        paths.root.rmtree</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5034">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5035">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5036">
          
          
          <code class="ruby">    inform_user(status, paths.root)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5037">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5038">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5039">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5040">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5041">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5042">
          
          
          <code class="ruby">  # Inform user about the cleanup status.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5043">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5044">
          <span class="hits">1</span>
          
          <code class="ruby">  def inform_user(status, root_dir)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5045">
          
          
          <code class="ruby">    case status</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5046">
          
          
          <code class="ruby">    when true  then tell(&quot;{g{Successfully cleaned: `#{root_dir}`.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5047">
          
          
          <code class="ruby">    when false then error(&quot;Failed to cleanup: `#{root_dir}`.&quot;, :red)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5048">
          
          
          <code class="ruby">    when nil   then warning(&quot;Cleanup skipped.&quot;, ask_continue: false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5049">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5050">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5051">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5052">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5053">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────── Help ← Depot ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5054">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5055">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5056">
          
          
          <code class="ruby"># Fizzy command to show configuration details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5057">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5058">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::CLI::Help &lt; Fizzy::CLI::Command</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5059">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5060">
          
          
          <code class="ruby">    super(&quot;Show command help.&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5061">
          
          
          <code class="ruby">          spec: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5062">
          
          
          <code class="ruby">            command_name: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5063">
          
          
          <code class="ruby">              desc: &quot;The command name to show help for&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5064">
          
          
          <code class="ruby">              abbrev: &quot;C&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5065">
          
          
          <code class="ruby">              type: Fizzy::CLI::Command.available.map(&amp;:command_name),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5066">
          
          
          <code class="ruby">              required: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5067">
          
          
          <code class="ruby">            }</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5068">
          <span class="hits">2</span>
          
          <code class="ruby">          })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5069">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5070">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5071">
          <span class="hits">1</span>
          
          <code class="ruby">  def run</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5072">
          <span class="hits">2</span>
          
          <code class="ruby">    Fizzy::CLI::Main.instance.tell_help(options[:command_name])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5073">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5074">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5075">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5076">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────── Info ← Depot ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5077">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5078">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5079">
          
          
          <code class="ruby"># Fizzy command to show configuration details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5080">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5081">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::CLI::Info &lt; Fizzy::CLI::Command</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5082">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5083">
          
          
          <code class="ruby">    super(&quot;Show configuration information&quot;,</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5084">
          <span class="hits">2</span>
          
          <code class="ruby">          spec: Fizzy::CLI.known_args(:fizzy_dir, :cfg_name))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5085">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5086">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5087">
          <span class="hits">1</span>
          
          <code class="ruby">  def run</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5088">
          
          
          <code class="ruby">    paths = compute_paths</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5089">
          
          
          <code class="ruby">    tell_available_vars(paths.cur_cfg_vars)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5090">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5091">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5092">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5093">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5094">
          <span class="hits">1</span>
          
          <code class="ruby">  def compute_paths</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5095">
          
          
          <code class="ruby">    prepare_storage(options[:fizzy_dir],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5096">
          
          
          <code class="ruby">                    valid_meta:   false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5097">
          
          
          <code class="ruby">                    valid_cfg:    :readonly,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5098">
          
          
          <code class="ruby">                    valid_inst:   false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5099">
          
          
          <code class="ruby">                    cur_cfg_name: options[:cfg_name])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5100">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5102">
          <span class="hits">1</span>
          
          <code class="ruby">  def tell_available_vars(cur_cfg_vars_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5103">
          
          
          <code class="ruby">    tell(&quot;{c{Available vars:}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5104">
          
          
          <code class="ruby">    avail_vars(cur_cfg_vars_path).each do |path|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5105">
          
          
          <code class="ruby">      name = path.basename(path.extname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5106">
          
          
          <code class="ruby">      tell(&quot;\t→ {m{#{name}}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5107">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5108">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5109">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5111">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────── Edit ← Depot ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5113">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5114">
          
          
          <code class="ruby"># Fizzy command to edit configuration.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5115">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5116">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::CLI::Edit &lt; Fizzy::CLI::Command</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5117">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5118">
          
          
          <code class="ruby">    super(&quot;Find the files relative to PATTERN and edit them.&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5119">
          
          
          <code class="ruby">          spec: Fizzy::CLI.known_args(:fizzy_dir, :cfg_name).merge(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5120">
          
          
          <code class="ruby">            pattern: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5121">
          
          
          <code class="ruby">              desc: &quot;Pattern to find files to be edited&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5122">
          
          
          <code class="ruby">              abbrev: &quot;P&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5123">
          
          
          <code class="ruby">              required: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5124">
          
          
          <code class="ruby">            }</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5125">
          <span class="hits">2</span>
          
          <code class="ruby">          ))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5126">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5128">
          <span class="hits">1</span>
          
          <code class="ruby">  def run</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5129">
          
          
          <code class="ruby">    # Prepare stuff for editing.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5130">
          
          
          <code class="ruby">    paths = compute_paths</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5131">
          
          
          <code class="ruby">    find_path = (paths.cur_cfg || paths.cfg).join(options[:pattern])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5132">
          
          
          <code class="ruby">    cfg_files = find_cfg_files(find_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5133">
          
          
          <code class="ruby">    cfg_files_arg = build_cfg_files_arg(cfg_files)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5134">
          
          
          <code class="ruby">    status = perform_edit(cfg_files_arg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5135">
          
          
          <code class="ruby">    inform_user(status, cfg_files_arg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5136">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5138">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5140">
          <span class="hits">1</span>
          
          <code class="ruby">  def compute_paths</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5141">
          
          
          <code class="ruby">    prepare_storage(options[:fizzy_dir],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5142">
          
          
          <code class="ruby">                    valid_meta:   false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5143">
          
          
          <code class="ruby">                    valid_inst:   false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5144">
          
          
          <code class="ruby">                    cur_cfg_name: options[:cfg_name])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5145">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5147">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5148">
          
          
          <code class="ruby">  # Find configuration files to be edited.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5149">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5150">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_cfg_files(find_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5151">
          
          
          <code class="ruby">    if find_path.exist?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5152">
          
          
          <code class="ruby">      Array[find_path]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5153">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5154">
          
          
          <code class="ruby">      Pathname.glob(&quot;#{find_path}*&quot;, File::FNM_DOTMATCH).to_a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5155">
          
          
          <code class="ruby">              .select(&amp;:file?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5156">
          
          
          <code class="ruby">              .reject { |path| path.to_s =~ /\.git/ }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5157">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5158">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5160">
          <span class="hits">1</span>
          
          <code class="ruby">  def build_cfg_files_arg(cfg_files)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5161">
          
          
          <code class="ruby">    cfg_files.collect(&amp;:shell_escape) .join(&quot; &quot;) .strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5162">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5164">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5165">
          
          
          <code class="ruby">  # Perform edit.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5166">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5167">
          <span class="hits">1</span>
          
          <code class="ruby">  def perform_edit(cfg_files_arg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5168">
          
          
          <code class="ruby">    if cfg_files_arg.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5169">
          
          
          <code class="ruby">      warning(&quot;No files matching `#{options[:cfg_name]}` have been found.&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5170">
          
          
          <code class="ruby">              ask_continue: false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5171">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5172">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5173">
          
          
          <code class="ruby">      tell(&quot;{c{Editing configuration file(s): `#{cfg_files_arg}`.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5174">
          
          
          <code class="ruby">      system(&quot;#{Fizzy::CFG.editor} #{cfg_files_arg}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5175">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5176">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5177">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5178">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5179">
          
          
          <code class="ruby">  # Inform user about the editing status.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5180">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5181">
          <span class="hits">1</span>
          
          <code class="ruby">  def inform_user(status, cfg_files_arg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5182">
          
          
          <code class="ruby">    case status</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5183">
          
          
          <code class="ruby">    when true  then tell(&quot;{g{Successfully edited: `#{cfg_files_arg}`.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5184">
          
          
          <code class="ruby">    when false then error(&quot;Failed to edit: `#{cfg_files_arg}`.&quot;, :red)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5185">
          
          
          <code class="ruby">    when nil   then warning(&quot;Editing skipped.&quot;, ask_continue: false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5186">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5187">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5188">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5190">
          
          
          <code class="ruby"># ──────────────────────────────────────────────────────── Sync ← Depot ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5191">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5192">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5193">
          
          
          <code class="ruby"># Fizzy command to sync configuration.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5194">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5195">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::CLI::Sync &lt; Fizzy::CLI::Command</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5196">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5197">
          
          
          <code class="ruby">    super(&quot;Synchronize configuration.&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5198">
          
          
          <code class="ruby">          spec: Fizzy::CLI.known_args(:fizzy_dir, :cfg_name,</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5199">
          <span class="hits">2</span>
          
          <code class="ruby">                                      cfg_url: { required: false }))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5200">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5202">
          <span class="hits">1</span>
          
          <code class="ruby">  def run</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5203">
          
          
          <code class="ruby">    paths = compute_paths</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5204">
          
          
          <code class="ruby">    sync_result = perform_sync(paths.cur_cfg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5205">
          
          
          <code class="ruby">    inform_user(sync_result, paths.cur_cfg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5206">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5207">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5208">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5209">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5210">
          <span class="hits">1</span>
          
          <code class="ruby">  def compute_paths</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5211">
          
          
          <code class="ruby">    prepare_storage(options[:fizzy_dir],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5212">
          
          
          <code class="ruby">                    valid_meta:   false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5213">
          
          
          <code class="ruby">                    valid_cfg:    false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5214">
          
          
          <code class="ruby">                    valid_inst:   false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5215">
          
          
          <code class="ruby">                    cur_cfg_name: options[:cfg_name])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5216">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5218">
          <span class="hits">1</span>
          
          <code class="ruby">  def perform_sync(cur_cfg_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5219">
          
          
          <code class="ruby">    Fizzy::Sync.perform(cur_cfg_path, options[:cfg_url])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5220">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5222">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5223">
          
          
          <code class="ruby">  # Inform user about sync status.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5224">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5225">
          <span class="hits">1</span>
          
          <code class="ruby">  def inform_user(sync_result, cur_cfg_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5226">
          
          
          <code class="ruby">    if sync_result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5227">
          
          
          <code class="ruby">      tell(&quot;{g{Synced to: `#{cur_cfg_path}`.}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5228">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5229">
          
          
          <code class="ruby">      error(&quot;Unable to sync.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5230">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5231">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5232">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5233">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5234">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────── Incarnate ← Depot ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5235">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5236">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5237">
          
          
          <code class="ruby"># Fizzy command to incarnate configuration.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5238">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5239">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::CLI::Incarnate &lt; Fizzy::CLI::Command</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5240">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5241">
          
          
          <code class="ruby">    super(&quot;Incarnate configuration (a.k.a. instantiate + install).&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5242">
          
          
          <code class="ruby">          spec: Fizzy::CLI.known_args(:run_mode, :fizzy_dir, :cfg_name,</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5243">
          <span class="hits">2</span>
          
          <code class="ruby">                                      :inst_name, :vars_name, :meta_name))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5244">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5245">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5246">
          <span class="hits">1</span>
          
          <code class="ruby">  def run</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5247">
          
          
          <code class="ruby">    instantiate</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5248">
          
          
          <code class="ruby">    install</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5249">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5250">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5251">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5252">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5253">
          <span class="hits">1</span>
          
          <code class="ruby">  def instantiate</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5254">
          
          
          <code class="ruby">    # Before instantiation.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5255">
          
          
          <code class="ruby">    paths = prepare_storage(options[:fizzy_dir],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5256">
          
          
          <code class="ruby">                            meta_name:     options[:meta_name],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5257">
          
          
          <code class="ruby">                            valid_cfg:     :readonly,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5258">
          
          
          <code class="ruby">                            valid_inst:    false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5259">
          
          
          <code class="ruby">                            cur_cfg_name:  options[:cfg_name],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5260">
          
          
          <code class="ruby">                            cur_inst_name: options[:inst_name])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5261">
          
          
          <code class="ruby">    setup_vars(paths.cur_cfg_vars, options[:vars_name])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5262">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5263">
          
          
          <code class="ruby">    meta = get_meta(paths.cur_cfg_meta, paths.cur_cfg_vars, paths.cur_cfg_elems,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5264">
          
          
          <code class="ruby">                    options[:verbose])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5265">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5266">
          
          
          <code class="ruby">    info(&quot;meta: &quot;, &quot;{g{#{meta[:elems].count}}}/&quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5267">
          
          
          <code class="ruby">                   &quot;#{meta[:all_elems_count]} elem(s) selected.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5268">
          
          
          <code class="ruby">    info(&quot;meta: &quot;, &quot;{r{#{meta[:excluded_files].count}}}/&quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5269">
          
          
          <code class="ruby">                   &quot;#{meta[:all_files_count]} file(s) excluded.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5270">
          
          
          <code class="ruby">    tell</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5271">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5272">
          
          
          <code class="ruby">    # Create a configuration instance.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5273">
          
          
          <code class="ruby">    tell(&quot;{b{Creating a configuration instance named &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5274">
          
          
          <code class="ruby">         &quot;`#{options[:inst_name]}`}} from: `{m{#{paths.cur_cfg}}}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5275">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5276">
          
          
          <code class="ruby">    exclude_pattern = Fizzy::CFG.instantiate_exclude_pattern</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5277">
          
          
          <code class="ruby">    meta[:excluded_files].each do |excluded_file|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5278">
          
          
          <code class="ruby">      exclude_pattern = /#{exclude_pattern}|#{excluded_file}/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5279">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5280">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5281">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5282">
          
          
          <code class="ruby">      directory(paths.cur_cfg, paths.cur_inst, exclude_pattern: exclude_pattern)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5283">
          
          
          <code class="ruby">    rescue SyntaxError</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5284">
          
          
          <code class="ruby">      error(&quot;Error while processing the template: `#{$fizzy_cur_template}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5285">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5286">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5287">
          
          
          <code class="ruby">    # After instantiation.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5288">
          
          
          <code class="ruby">    tell(&quot;{g{Created the configuration instance in: `#{paths.cur_inst}`.}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5289">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5290">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5291">
          <span class="hits">1</span>
          
          <code class="ruby">  def install</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5292">
          
          
          <code class="ruby">    # Prepare stuff for performing install.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5293">
          
          
          <code class="ruby">    @run_mode = options[:run_mode].to_sym</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5294">
          
          
          <code class="ruby">    @verbose  = options[:verbose]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5295">
          
          
          <code class="ruby">    paths = prepare_storage(options[:fizzy_dir],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5296">
          
          
          <code class="ruby">                            valid_cfg:     false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5297">
          
          
          <code class="ruby">                            meta_name:     options[:meta_name],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5298">
          
          
          <code class="ruby">                            cur_inst_name: options[:inst_name])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5299">
          
          
          <code class="ruby">    setup_vars(paths.cur_inst_vars, options[:vars_name])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5300">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5301">
          
          
          <code class="ruby">    meta = get_meta(paths.cur_inst_meta, paths.cur_inst_vars,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5302">
          
          
          <code class="ruby">                    paths.cur_inst_elems, options[:verbose])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5303">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5304">
          
          
          <code class="ruby">    # 1: Install the instance into the system.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5305">
          
          
          <code class="ruby">    tell(&quot;{b{Installing the configuration instance &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5306">
          
          
          <code class="ruby">         &quot;`#{options[:inst_name]}` into the system.}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5307">
          
          
          <code class="ruby">    # 1.1: Install the elements.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5308">
          
          
          <code class="ruby">    meta[:elems].each do |elem|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5309">
          
          
          <code class="ruby">      tell(&quot;{c{Installing element: `#{elem[:name]}`.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5310">
          
          
          <code class="ruby">      elements_appliers.each { |applier| applier.call(elem) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5311">
          
          
          <code class="ruby">      if elem[:notes]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5312">
          
          
          <code class="ruby">        tell(&quot;{y{Notes for `#{elem[:name]}`:}}\n&quot; +</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5313">
          
          
          <code class="ruby">             elem[:notes].split(&quot;\n&quot;).collect { |s| &quot;  #{s}&quot; }.join(&quot;\n&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5314">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5315">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5316">
          
          
          <code class="ruby">    # 1.2: Install the commands.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5317">
          
          
          <code class="ruby">    meta[:commands].each do |command|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5318">
          
          
          <code class="ruby">      tell(&quot;{c{Executing command: `#{command.type}`.}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5319">
          
          
          <code class="ruby">      command.execute</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5320">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5321">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5322">
          
          
          <code class="ruby">    # Inform the user about installation status.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5323">
          
          
          <code class="ruby">    tell(&quot;{g{The configuration instance `#{options[:inst_name]}` has been &quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5324">
          
          
          <code class="ruby">         &quot;installed into the system.}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5325">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5326">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5328">
          
          
          <code class="ruby"># ─────────────────────────────────────────────────────── Usage ← Depot ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5329">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5330">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5331">
          
          
          <code class="ruby"># Fizzy command to show how to use fizzy.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5332">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5333">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::CLI::Usage &lt; Fizzy::CLI::Command</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5334">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5335">
          <span class="hits">2</span>
          
          <code class="ruby">    super(&quot;Show how to use fizzy.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5336">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5337">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5338">
          <span class="hits">1</span>
          
          <code class="ruby">  def run</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5339">
          
          
          <code class="ruby">    url = URI.join(Fizzy::CFG.static_files_base_url, &quot;BIGNAMI.md&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5340">
          
          
          <code class="ruby">    res = Net::HTTP.get_response(url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5341">
          
          
          <code class="ruby">    if res.is_a?(Net::HTTPSuccess)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5342">
          
          
          <code class="ruby">      tell(&quot;\n#{res.body}\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5343">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5344">
          
          
          <code class="ruby">      error(&quot;Network error: cannot retrieve `#{url}`.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5345">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5346">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5347">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5348">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5349">
          
          
          <code class="ruby"># ───────────────────────────────────────────────────── Version ← Depot ← Cli ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5350">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5351">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5352">
          
          
          <code class="ruby"># Fizzy command to show fizzy version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5353">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5354">
          <span class="hits">1</span>
          
          <code class="ruby">class Fizzy::CLI::Version &lt; Fizzy::CLI::Command</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5355">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5356">
          <span class="hits">2</span>
          
          <code class="ruby">    super(&quot;Show fizzy version.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5357">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5358">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5359">
          <span class="hits">1</span>
          
          <code class="ruby">  def run</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5360">
          
          
          <code class="ruby">    info(&quot;fizzy version&quot;, &quot;{m{#{Fizzy::CFG.version}}}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5361">
          
          
          <code class="ruby">    info(&quot;ruby version&quot;, &quot;{m{ruby #{RUBY_VERSION}p#{RUBY_PATCHLEVEL}}}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5362">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5363">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5364">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5365">
          
          
          <code class="ruby"># ────────────────────────────────────────────────────────────────────── Main ──</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5366">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5367">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5368">
          
          
          <code class="ruby"># Entry point.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5369">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5370">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5371">
          <span class="hits">1</span>
          
          <code class="ruby">if $PROGRAM_NAME == __FILE__</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5372">
          
          
          <code class="ruby">  commands = Fizzy::CLI::Command.available.collect(&amp;:new)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5373">
          
          
          <code class="ruby">  commands.each { |command| Fizzy::CLI::Main.instance.add_subcommand(command) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5374">
          
          
          <code class="ruby">  Fizzy::CLI::Main.instance.run if Fizzy::CLI::Main.instance.parse(ARGV)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5375">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  </body>
</html>
